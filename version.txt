PROBE for EPMA XP/Vista/Win7 (32 bit) and Win7 (64 bit) Xtreme Edition Version Software Changes

User names (in parentheses) indicate grateful attribution for the preceding bug report or suggestion. Users "rule"!

04/20/17	Minor bug fixes in Standard (Interf2.bas).

		Add calculation and output of TDI correction (percent correction) maps (von 
		der Handt).

04/15/17	Add code to ask user for subsequent pass acquisitions for TDI scanning conversion 
		of replicate samples to TDI PrbImg files in CalcImage.
		
		Add code to automatically skip missing maps from align and crop code (Ruscitto).

04/14/17	Fix 15th color subset to avoid white in plot wavescan (Goemann and Lowers).

		Modify replicate TDI conversion to also copy analog signal images.
		
		Add instructions for align and crop when subsequent passes do not contain an 
		image (Ruscitto).

04/13/17	Modify column condition loading from PCC files to automatically fill in analytical 
		condition fields in all condition forms. JEOL 8900/8200/8500 skip beam current field.

04/11/17	Work on Thermo Pathfinder new functions for beam deflection.

04/08/17	Clean up some dead code.
v. 11.8.8

04/07/17	Add errors bars to MPB plots (B. Wade).

04/03/17	Fix EDS background issue for EDS elements in GetOpt (Neill).

04/01/17	Add error trapping for TDI correction flags since those flags now expect TDI replicate images to
		be available. Fix minor bug concerning element channel order when TDI and aggregate elements are utilized 
		at the same time (Buse).

03/29/17	Fix missing call to create new (empty) project in CalcImage (Buse).
v. 11.8.7
		Add code to force reregistration of copy protection if Win XP or older operating systems (or Win 8 or Win 10).
		This is because Win 8 reports as Win NT and Win 10 reports as Win XP when a 32 bit asks what the OS is. So
		now the copy protection file is always written to the ProgramData folder.

03/25/17	Add mutex check for Probe Image running.

03/24/17	Add more file checks for loading existing images in CalcImage.
v. 11.8.6

03/23/17	Fix x/y image extents bug in align and crop code in CalcImage (Ruscitto).

03/20/17	Add Copy To Clipboard button to Align and Crop (von der Handt).

03/17/17	Add "last" manual flags for multi-point over-ride flags when loading a sample setup from another run (Goemann)

		Improve using position conditions for automated imaging (Goemann).
		
		This release *requires* JEOL EIKS version 4 or higher for 8230/8530.

03/16/17	Implement new align and crop feature in CalcImage (Ruscitto).
v. 11.8.5	
		Improve EDS/CL control enables/disables in acquisition options.

03/09/17	Add keV rounding flag to matrix corrections for Penepma alpha factors.
v. 11.8.4

03/07/17	Modify default light intensity for JEOL instruments to 110 (Neill and Hanson)

03/03/17	Add display on set condition delays in Combined Condition dialog (von der Handt). Check for faraday cup 
		before set conditions (Carpenter). Fix multi spectro bias scan in Startwin (Carpenter).
		
		Fix combine samples feature in Analyze! window for disabled acq elements (Carpenter).

03/02/17	Add menu to CalcImage log window for "cloning" the current CalcImage project (Ruscitto).

		Modify lower coarse condenser lens limit to 0 (Carpenter).

		Add check for large standard deviations (see code Penepma12MatrixCheckDeviations)

02/28/17	Modify scanning TDI feature to display actual pixel numbers for plot.

02/26/17	First implementation of TDI scanning code in CalcImage.
v.11.8.3

02/25/17	Work on "scanning TDI" code in CalcImage. Note new menu in the CalcImage menu for converting replicate scans
		from Probe Image into _TDI_ files for processing with CalcImage.
		
		Modify code for determining image assignments in CalcImage. Much cleaner now.

02/24/17	Work on "scanning TDI" code in CalcImage. 

02/23/17	Work on "scanning TDI" code in CalcImage. 

02/22/17	Work on "scanning TDI" code in CalcImage. 

02/16/17	Add output of detection limits in oxide weight percents for user specified format output (Neill).
v. 11.8.2

02/15/17	Fix new Thermo PathFinder calls for release beam and deflect beam.

02/14/17	Improve combined conditions dialog.

02/12/17	Improve CL acquisition time estimate for Automate!

02/10/17	Fix CL count time issue. Improve MAN GUI on startup (Roberts). Add call to Thermo TEPortal for drift compensation (Allaz).

02/07/17	Improve row selection code for MAN form load (Roberts). Improve CL acquisition time estimates (Ocean Optics).
v. 11.8.1	

02/01/17	Modify CalcZAF format output from PFE to append multiple samples (Poeml).

		Modify WDS simulation to calculated spectra for assigned standard when peaking on assigned standards from Automate!

01/27/17	Modify CalcZAF format output in PFE to skip duplicate elements if using aggregate mode (Buse).

		Modify start sample and start image code to skip setting light optics for JEOL 8900 (von der Handt/Adams)

01/25/17	Improve secondary boundary fluorescence correction in CalcZAF (Buse).
v. 11.8.0

01/20/17	Modify time estimation for TDI overhead for JEOL instruments (Allaz).

01/17/17	Add output of "raw" electron images from Output menu with overlaid images (Buse).

01/16/17	Add Ar and Xe absorption edges to WDS simulation spectra.

01/13/17	Modify GetElm form and code to allow user to select the sample basis for modifying Elements/Cations 
		parameters for multiple samples (Goemann).
		
		Add beam deflection calls for Thermo EDS interface (only for Thermo PathFinder).
		
		Generate random seed for Penepma EDS simulation.

01/07/17	Modify EDS acquisition so that EDS count time and EDS unknown count factor are specified on a per 
v.11.7.9	sample basis.  This way, each automated sample can utilize a different count time for EDS. Also
		implement sample level flags for CL acquisition.

01/06/17	Implement quantification of Penepma simulated EDS spectra in PFE for teaching EPMA.
v.11.7.8

01/04/17	Fix array issue when adding element in Penepma WDS simulation mode.

01/03/17	Bump version to force updates.
v.11.7.7

01/02/17	Modify Penepma/Penelope code to handle more energy channels.

01/01/17	Improve peaking report to log window code.  Fix error bar output in plot wavescan window.

12/31/16	Work on Penepma WDS simulation. Fix a couple of minor display bugs in Plot! wavescan dialog.
v.11.7.6

12/27/16	Improve Brent's maxima fit. Work on WDS Penepma simulation.
v.11.7.5

12/22/16	Update copyright in sources. Update documentation. Work on WDS simulation wavescans.

12/20/16	Add keV output to wavescan sample output (von der Handt).

12/18/16	Modify update imaging magnification code in Automate! Digitize to not update beam mode (spot vs. scan). Make 
		get beam mode and get mag variables local.
		
		Add 4 sec delay after turning on light for auto-focus for 8900/8200/8500 also (Neill).
		
		Fix multi-standard calibration curve analytical mode to work with aggregate mode (duplicate elements) (Neill).

12/16/16	Modify Analytical Conditions dialogs so Column Condition (PCC) FIle option is selected automatically
v.11.7.4	if user browses a selected PCC file (Buse).

		Insert faraday cup before loading PCC file (Poeml).  Fix defaulting of sample carbon coating parameters in 
		CalcZAF (Colombo).  Fix wavescan labels for raw wavescan counts (von der Handt)

12/09/16	New matrix.mdb file.

12/08/16	Fix missing data error in MAN assignments when loading assignments from file setup (Carpenter).

12/06/16	Add delays for light on (JEOL 8x30 auto-focus) and light off (start EDS, CL and imaging) (Buse, Matthews, Poirier).

12/05/16	Fix eV per channel constant for demo EDS. Add better wait for messages in MiscDelay3. Add
v. 11.7.3	more locked file code for DataVolatile check routines.

12/04/16	Work on WDS simulated spectra feature.

		Finish testing 8230 filament saturation code (Poirier).  That and save/load PCC all working now 
		for 8230 and 8530 (Yu and Buse).

12/02/16	Modify Standard.exe and Penepma.f to allow for more energy channels (for WDS demo simulation).
		
		Add additional controls in Penepma window for min/max energy range and number of energy channels.

12/01/16	Add reflected light on/off for JEOL 8x30 autofocus (Poirier)

11/30/16	Improve code for 8200 warmup filament (Yu).  Add GunAlign and Vacuum to PFE Utilities menu.

11/27/16	Add code to close gun valve is 8530 for filament standby (Buse).
v. 11.7.2

11/22/16	Add check for change from scan mode to spot mode and set image shift to 0, 0 if so (Buse).

11/21/16	Fix 8230/8530 PCC file loading (Poirier).  

		Add code for 8200/8500 set scan rotation (Neill).

11/20/16	Improve demo mode PHA acquisition.

11/17/16	Implement additional column save/load parameters for 8x30 instruments (Buse, Poirier, Allaz, Cathey).
v. 11.7.1	
		Modify button colors per von der Handt suggestions.

11/16/16	Work on 8x30 gun and EOS parameters.

11/13/16	Fix several bugs in MAN fit code when duplicate elements at different operating voltages are 
		present in the same run (Allaz).

11/10/16	Add more column and gun parameters to 8x30 PCC file for saving/loading column conditions.

11/09/16	Modify PictureSnap to handle very large images (Goemann, Carpenter, et al.)
v. 11.6.9
		Add filament standby option in probewin.ini to run an external script after automation completes
		(Poeml). See keywords:
		
		FilamentStandbyType=3
		FilamentStandbyExternalScript=""

11/03/16	Add code to Bruker get net intensity call to return background counts in addition to net counts 
		for detection limit, etc. calculations for EDS elements (Locock).

11/02/16	Add ZAF iteration output (Fournelle).

11/01/16	Modify Feig EPMA-MDT.
v. 11.6.8

10/30/16	Fix graph x axis display for full scan for peaking with reverse motion (Poeml).

10/29/16	Add Instrument?Facility string to Probewin.ini (for Feig EPMA Method Development Tool output).

10/27/16	Fix TDI with alternating off-peaks and MPBs (Jercinovic).

10/22/16	Fix log window buffer issue in CalcImage when numerous standard intensity drift warnings occur (Allaz).

10/21/16	Add automatic output of analog signal images in CalcImage.

10/20/16	Add flags for output of analog signal images to Surfer in CalcImage.  Fix MAN duplicate element display issue (Buse).

10/16/16	Add code to warmup filaments for 8230 instruments.
v. 11.6.7

10/15/16	Add set regulated probe current to JEOL 8x30 set column conditions code (Buse).

10/14/16	Fix biotite file handle output issue (Lowers).

10/12/16	Fix control click event issue for Force Straight Line Fit for last MAN element (Neill).

		Add better labeling to TDI plots.

10/11/16	Fix log-log calculation code for aggregate mode and TDI for both self and alt. on/off acquisition (B. Wade and Allaz).

10/10/16	Improve MPB alt on/off code for TDI assignments.

10/09/16	Add more element atomic number constants where needed in code. 

10/08/16	Modify code to allow TDI correction of alternating on/off peak intensities (B. Wade).

		Replace commonly used element numbers with global constants.

10/06/16	Save fit flag in TDI display dialog (B. Wade). Improve estimated automation time by including
v. 11.6.6	running standard after probe Image from PFE.

		New matrix.mdb k-ratio database for fast Monte Carlo matrix calculations.

10/05/16	Automatically add elements for Formula By Difference feature in CalcZAF and CalcImage.

10/04/16	Add display of JEOL image shift DAC values in Analytical Conditions dialog (Carpenter).

		Fix DataMotor null issue (Seward).

10/02/16	Add display of initial absorbed current value to TDI plot (Seward).
v. 11.6.5

09/30/16	Modify CalcImage dialog CPQ controls to handle increase in number of MAN stds to 36 per element and 
		interferences to 6 per element (Roberts).

09/29/16	Move absorbed current TDI measurement to end of TDI counting cycle (Seward). 

		Reduce overhead in starting On-peak counting for TDI (Seward).

09/27/16	Check for disabled quant in DataCorrectAggregateData (Seward). Small tweak to Stage mosaic code.

09/22/16	Fix automated Calibrate Spectrometers feature in StartWin (Buse).

09/20/16	Add output of absorbed current if acquired in wavescans.

09/19/16	If Do not set beam conditions checkbox is checked, use current mag for imaging
		magnification. Also do not insert cup in AcquireDoConditions (Buse).
		
09/17/16	Increase number of MAN standard assignments to 36. Increase number of interferences per element 
v. 11.6.4	to 6 (Allaz).

		New matrix.mdb.

09/16/16	Add new keywords in probewin.ini for tolerance for initiating stage move (Buse) in microns.
			MoveStageToleranceX=0.1
			MoveStageToleranceY=0.1
			MoveStageToleranceZ=0.1

09/11/16	Add code to handle combined condition arrays for displaying max beam size
		in image window (Poeml).
		
		Fixed bug in MiscIsElementDuplicated2 (would always report an element as duplicated!). 
		Could affect DataCorrectDataAggregate and IntegratedLoadSampleChans, but tested 
		both and the code seems OK.

09/10/16	Add PHA baseline/window graphics to Display PHA plot (Seward).

09/07/16	Increase integrated intensity background array to 50 point per side (Feig).

		Add number of scan points to plot x-axis title.

09/06/16	Add checkbox to reverse order of selected sample combination in Analyze! (Goemann).
v. 11.6.3	
		Add support for different beam sizes in image display (Poeml).

09/01/16	Fix NIST output for raw interpolated off-peak (Meisenkothen).
v. 11.6.2
		New matrix.mdb.

08/25/16	Fix data type in EMS output (Meisenkothen), Add sample type options for auto focus
v. 11.6.1	in Automate! window.

		Disable save to disk option if error when outputting log (MacDonald).

08/19/16	Fix MPB list bug when MPB iterate index is larger than acquire index (Matveev).
v. 11.5.9
		Move call to InitStandards(analysis) from AFactorCalculateKFactors to UpdateAnalyze to avoid 
		overwriting std percents loaded in AfactorStd (already initialized in CalcZAFCalculate).

08/18/16	Enable Bruker beam deflection call for Remote interface. Add code to disable nominal interference
v. 11.5.8	calculations in Standard Assignments and Elements/Cations dialogs if the element is EDS (for now).

08/02/16	Add remaining REE elements to matrix.mdb (347K k-ratios).  Modify integrated intensity background fit
v. 11.5.7	to utilize either off-peaks or scan end points (Goemann).

		Fix Cameca bias scan issue when MCA PHA is selected (Neill).

07/27/16	Improve integrated intensity display dialog. Improve CL acquisition code.

07/26/16	Fix export/import code for element setup database to handle CrLf, tabs and nulls in text..

07/25/16	Fix Plot wavescan bug in smoothing (Knussman).

07/24/16	Fix problem with creating new element setup databases (Seward).

07/21/16	Fix time calculation if integrated intensity initial/minimum step sizes are equal (Feig).
v. 11.5.5

07/15/16	Improve integrated intensity plotting (Roberts).
v. 11.5.4

07/13/16	Rewrite GunAlign code. Update PFE documentation.

07/07/16	Improve enable events in Elements/Cations dialog for EDS/WDS elements (Seward).

07/05/16	Fix issue with adding EDS elements to Elements/Cations dialog (Seward).

07/03/16	Add call to InitStandard(analysis) in AfactorCalculateKFactors code for debug output.
v. 11.5.3

07/01/16	Modify enables for assigned TDI elements if assigned TDI calibration samples have 
		been loaded (von der Handt).

06/24/16	Improve GunAlign code (Neil and von der Handt).
v. 11.5.2
		Remove commented out VB5 components from deployment msi files.

06/21/16	Fix auto-focus update selected position (Buse). Add Clipboard and Export buttons to 
		GunAlign app (von der Handt). 

06/20/16	Tweak GunAlign app for 8900/8200/8500 (Neill).

06/16/16	Add filament saturation window to GunAlign for 8900/8200 instruments.

06/10/16	Modify manual PHA acquisition so it records changes to the current sample (Meier).

06/09/16	Add reflected and transmitted light control to Remote interface.

06/08/16	Minor improvements.

06/07/16	Add Start Peaking button to Peaking Options (von der Handt).

06/06/16	Add Probewin.ini flag for fixed x-axis range for wave and peak scanning (Carpenter).

		Fix integrated intensity display issue (B. Wade).

06/05/16	Prevent No standards assigned error from stopping automation (Chouinard).

06/04/16	Add peaking and scan data output (von der Handt). Fix minor output bug in CalcImage (Roberts).
v. 11.5.1

05/31/16	Add light brightness control to StageMap window.

05/30/16	Add 300 millisec delay after 8x30 stage move calls (EIKS) to avoid "stage already moving" warning 
v. 11.4.9		on JEOL PC-SEM software).

05/28/16	Fix oxygen bug in Elements/Cations (Roberts/Fournelle).

		Expand File Info labels. Fix rounding for keV read for JEOL (Buse).

05/02/16	Add SmpZAF/StdZAF in calcZAF debug output (Carpenter).

		Found and fixed nasty cation/oxygen bug in Elements/Cations code (GetElmSetElmSave).

05/01/16	Add warning for DSMAX parameter if using bilayer input production (Buse).
v. 11.4.8

04/23/16	Modify custom output formats to utilize FreeFile() function for output.

		Vacuum.exe app now working on JEOL 8500 (Neill).

04/22/16	Fix output for samples with insufficient basis for mineral calculations (Cathey).

		Update doc and help files.

04/14/16	Add test utilities to Test Probe menus.
v. 11.4.7

04/11/16	Fix bug for PI automation sample setup number.

		Fix STRATAGem output bug when outputting separate lines (Fournelle).

04/09/16	Add disable of WDS/EDS option in Elements/cations if x-ray is blank.
v. 11.4.6		
		Add 59 binaries to matrix.mdb.
		
		Fix sample setup selection for Probe Image automation.

04/08/16	Add spec pos equations to CalcZAF Calculate Spectrometer positions dialog.  

		Add beam conditions to PFE EDS dialog.
		
04/05/16	Repair problem with Thermo initialization. Turns out the call to TYEVB_GetSpectrum after calling TEVB_Connect *is* 
		absolutely necessary to avoid crashing the TE Portal interface.
		
04/03/16	Modify nominal spectral interference calculation to adjust peak width based on sin theta.

03/30/16	Modify Thermo init code to prompt user if NSS is running even on a remote computer (Severin).

03/27/16	Fix Evaulate app where zero values were not getting plotting because of NullDataValue issue (Neill).

03/23/16	Fix data labels in Evaluate and peak marker flag in Plot! window (Neill).

		Fix mag issue in Imaging! window when UseDoNotSetConditionFlag is set (Seward).

03/22/16	Fix min/max issue in CalcImage atomic percents images.  Modify color for MPB wavescan overlay plot.

03/18/16	Add beam deflection and get/set image shift to Remote Automation COM interface (Ruscitto).
v. 11.4.5

03/17/16	Fix last bug on using quick stds with automated digitized conditions (Poeml).

03/15/16	Fix use digitized conditions issue (Poeml).
v. 11.4.4

03/14/16	Fix minor bugs in Time.bas and New.bas for Cathey and Poeml.

03/11/16	Improve Automate! Plot button to better support multiple samples.

03/10/16	Fix Zoom 0,0 in Evaluate (Poeml). 

03/08/16	Fix Plot button in Automate! (von der Handt). Modify Display Scan Data dialog (Carpenter).
v. 11.4.3

03/04/16	Replace all default command buttons with named command buttons.

03/03/16	Modify Acquire.bas acquire volatile code to acquire assigned TDI elements more efficiently. 
v. 11.4.2
		Fix save assign TDI bug in GetElm.  Improve graphics display for assigned TDI plot.

03/02/16	Fix minor output problem for STRATAGem (Chouinard).

03/01/16	Add new k-ratios to matrix.mdb.  Fix checking of MDB file version number when loading CL spectra.
v. 11.4.1	
		Fix saving/loading of MPB elements in SETUP.MDB.  Fix loading of MPB file setups (Goemann).
		
		Add call to send hysteresis command in SX100SetConditions if beam size was non-zero and is now zero (Poeml).

02/27/16	Add ThermoNSSVersionNUmber keyword to probewin.ini file (Severin)
v. 11.4.0
		Modify MAN code to automatically handle combined condition samples, add KeV column to element grid (von der Handt).
		
		Add check for deleted point in unknown blank and force recalculation of blank sample on next analysis (Severin).
		
		Update PFE user manual.

02/23/16	Add flags to support MPB manual over ride flags even when samples have no data (Goemann and Poeml).
v. 11.3.9

02/22/16	Fix unnecessary output in ScanData (Hanson).
v. 11.3.8
		Prune some dead code out of CalcImage.

02/21/16	Fix null record bug when sample setup has no data in Setup databases save/load methods (Hanson).

02/19/16	Minor mods to CaclZAF/Standard code.
v. 11.3.7

02/18/16	Clean up dead code using VBAnalyzer.  Modify Penepma12AdjustMinimumEnergy to utilize passed filename. 
v. 11.3.6

02/17/16	Fix log weight percent output bug in CalcImage (Roberts).
v. 11.3.5

02/15/16	Improve EDS KLM marker behavior and MPB plot graph wider.

02/13/16	New beam scan calibration plot in CalcImage for evaluating beam scan calibrations.
v. 11.3.4
		Tweak MPB (and Integrated Intensity) plots to maintain selected element (Goemann)

02/12/16	Misc. tweaks for Owen Neil for MAN and histogram plots and Gareth Hatton for MAN vs. off-peak 
		in Acquisition Options.
v. 11.3.3

02/11/16	Improve MPB wavescan overlay code and display behavior.

		Fix detection limit error in CalcImage from negative peak counts. (Roberts)

02/10/16	Fix combined sample bug for combined conditions. (B. Wade)

		Improve plot graphics.

02/09/16	Fix minor display bugs (Cathey and von der Handt). Bump version just in case.
v. 11.3.2	

02/08/16	Fix MCA PHA bug with Cameca instruments (from code re-write for Ben Buse). (Chouinard)
v. 11.3.1

02/07/16	All graphs now converted to Pro Essentials graphics!!!   
v. 11.3.0

02/06/16	Convert CalcZAF plot alphas dialog.  Removed digitized points when starting new sample in Digitize Image (von der Handt)
v. 11.2.9
		Convert Evaluate to new graphics.

02/04/16	Enable Zoom Full button in FormGRAPH and FormGRAPH_WAVE when using expand/contract and shift updown controls.

		Improve speed of MPB update from Elements/Cations dialog (Chouinard).  Fix icon loading for Calibrate.exe

02/02/16	Fix display bug in peaking/PHA dialog (Buse).

02/02/16	Corrections to Proza code per Brian Joy. 
v. 11.2.8

02/01/16	Fix bug in digitize cluster code.

01/31/16	Create "stubs" for remaining GS and PE graphics procedures (FormPOLYGON).

		New Pro Essentials graphics in FormSETPHA and FormSETPHA2.

01/28/16	Modify PHA (re-entrant) code to improve parallel acquisition on multiple spectrometers (Buse).

		New TDI display graphics.

01/26/16	Fix Automate! bug when selecting positions to delete from bottom to top (Chouinard). 
v. 11.2.7		
		New matrix.mdb (over 300K k-ratios)

01/25/16	Fix count time display bug (Chouinard).   Convert Peak Scan dialog to Pro Essentials graphics.

01/24/16	New Pro Essentials graphics for integrated intensity plot dialog. Work on FormAUTOFOCUS code for PE graphics.

01/23/16	New Pro Essentials graphics for MAN plot dialog.

01/21/16	Add relative % deviation to MPB plot dialog.  Work on more GS to PE graphics conversion.
v. 11.2.6

01/18/16	Minor bug fixes for Automate! window (Chouinard). New matrix.mdb.  Updated PFE reference manual.

01/14/16	Improve KLM markers for keV plots.

01/11/16	Fix single element symbol search in FormSETUP. Fix Automate! position bug (Chouinard).

01/10/16	Implement KLM markers for MPB plotting.

01/09/16	Add more plot wavescan options to save/load to/from MDB file.
v. 11.2.5
		Implement PE graphics for MultiPoint dialog.

01/08/16	Fix Load File Setup bug (Goemann).

01/06/16	Fix minor bugs in Automate! window regarding deleting/updating selected lines (Splide).

01/05/16	Remove VB5 Gauge controls.  Replace with progress bar and shape controls.

01/04/16	Remove old VB Data controls for user.mdb and setup.mdb files in Userwin and Probewin.
v. 11.2.4

01/01/16	Remove/replace all grid32.ocx code and deployment. Use MSFlexGrid.ocx instead.
v. 11.2.3

12/29/15	Improve stage reproducibility correction code. Fix FormLOCATE.
v. 11.2.2

12/28/15	Implement stage reproducibility correction code in Automate! window for beam deflection mode (Wark and Ruscitto).
v. 11.2.1

12/27/15	Create new MDB template code for new files, using MS Access 2010 (still need to convert setup*.mdb and user.mdb files
v. 11.1.9	which still depend on the old VB5 data control).

		Update copyright notice for 2016.  Remove spin32.ocx control from deployment. Convert more grid32.ocx controls to MSFlexGrid controls.

12/26/15	Convert Grid32.ocx to MSFlexGrid.ocx controls.  Add check for disable acq flag in Drift.exe (Carpenter).

12/23/15	Implement new graphics for wavescan acquisition and plot windows.

12/21/15	Implement CL spectrum acquisition for Probe for EPMA.
v. 11.1.8

12/20/15	Minor bug fixes to Penepma GUI. Add check for minimum mag for image shift in JEOL code.

12/15/15	Modify TDI plotting in Standard Assignments to display nth points if desired.

12/14/15	Modify JEOL 8900/8200/8500 image shift set/get code to use micron units (Ma).

12/10/15	New unk/std plot graphics for Output menu using Pro Essentials code.
v. 11.1.7

12/08/15	Add index to MPB manual flag table (Poeml).

		Add Display current alpha factors menu for selected sample in Analyze!

12/06/15	New PE graphics for peaking and PHA scanning.  Updated matrix.mdb file with 32 new actinides, 12 REE and Ti-Pt binaries.
v. 11.1.6
	
12/05/15	Work on converting GS plot controls to PE plot controls...

		Improve Imaging beam scan calibration window code (Carpenter).
	
12/03/15	Fix calculation of traverse distance in DigitizeImage and fix file problem in compact database code (Poeml).

		Modify Penepma12CalculateBinaries code to check for missing x-ray lines in binary.
	
12/02/15	Update reference manual.
	
12/01/05	Fix PHA done flag for PHA scans (Goemann).  Add Z stage interpolation for Stage mosaic digitization (Seward).
	
11/30/15	Add Imaging button to Stage Mosaic window (Seward and von der Handt).

11/29/15	Work on FormSCAN graphics conversion.  Add better warning if 2048 imaging selected for Sx100 and not in 
		single channel mode (Seward).
		
		Fix Stage.exe mosaic corner updating for move to buttons (Seward).

11/27/15	Fix minor bug in Standard and StartWin X-Ray menus and CalcZAF x-ray transmission code (Neill).
v. 11.1.5

11/21/15	Fix Xray menu in StartWin.exe.

11/24/15	Move ROM scan structures to module level for JEOL (von der Handt).

11/23/15	Remove nominal beam from load file setup save/restore code.

11/20/15	New code to save and restore miscellaneous Run table parameters when loading a file setup (Seward).
v. 11.1.4
		Start work on implementing Ocean Optics OmniDriver calls.

11/19/15	Work on testCL.exe test app.  Re-work some EDS display code and TestEDS.

11/18/15	Improve plot code for PE conversion.

11/17/15	Add code to check for proper JEOL EIKS ini file values.

		Fix DataGetVirtual file locking error (Poeml).

11/16/15	Enable new detection limits for MAN and Nth point background methods.

		Work on relative line weight code (Goemann).  Work on stage reproducibility correction code.

11/13/15	Work on new stage reproducibility feature (almost there!).
v. 11.1.3
	
11/11/15	Add check for no WDS driver versions and warn user if found.

		Move TestEDS to ProbeForEPMA.msi installer.

11/10/15	Add JEOL EIKS to PFE installer (also needed for PI, NSS and Esprit installers).

	
11/09/15	Improve Cameca sx.mdb import for standard compositions (Seward)

		Add proper signal type when importing PrbImg files.

11/08/15	Add code to automatically move JEOL EIKS files to new app folder if necessary when updating from v. 10.x (Seward).
	
11/06/15	Add button to load PrbImg file for automation digitizing in Digitize Image (Locock).

		Add menu in PictureSnap to only display the currently selected sample in Automate!

11/05/15	Add cancel button to Imaging/Digitize Imaging window when saving image (Neill).
v. 11.1.2

11/04/15	Add option to re-run standards after Probe Image automation completes.
	
11/03/15	Add check for v. 2.0.3 drivers if old app folder not present.

		Add alt key support for small MPB adjustment (Poeml) in Model Backgrounds.

11/02/15	Fix small bug in standard drift correction in CalcImage analysis code.

10/31/15	Many changes to numerous routines to remove RealTimeCounts and RealTimeCountTimes globals.
v. 11.1.1
		Fix update of peaking time in GetTim.bas.
	
10/29/15	Fix user specified output bug when using sample averages.
v. 11.0.9
		Modify detection limit calculations for Nth point acquisitions.
	
10/28/15	Fix CalcZAF emitter absorber MAC pair output (Buse).

		Fix Excel formatting bug (column spacing) when using no sample name, line or number and using average output.

10/27/15	Improve CalcImage behavior for multiple quant runs. Fix init of PI automation from PFE.

10/26/15	Tweak minor tick marks on EDS plots (Seward).

10/24/15	Work on new dynamic loading of KLM marker x-ray text.

10/23/15	Fix raw intensity Surfer label (Carpenter).

		Replace all old Spin controls with new UpDown controls.

10/22/15	Implement shape control for elapsed time gauge (Acquire).
v. 11.0.8
		Add new controls to installer.
	
		Save PFE path to restore after running PI.
	
		Move EDS init code in Calculation Options so it doesn't get called unless one clicks the EDS Quant 
		Method button (Chouinard).

10/21/15	Implement new PE graphics by Seward for EDS and CL data.

10/20/15	Work on Seward's PE graphics code. for EDS display.

10/18/15	Start replacing VB5 legacy controls with Microsoft common controls.

10/16/15	Add Excel tab delimited format for amphibole recalculations (Lowers).  See new AMPHI.DAT file.

		Replace old spin button controls with new MS UpDown controls in Standard and CalcZAF.

10/13/15	Add Print Log and Print Setup menus to the CalcImage log window.
	
		Implement rigorous calculation of pixel acquisition time in CalcImage for
		standard drift correction on a channel by channel basis (in case utilizing multiple mapping sets).
	
		Also implement pixel drift time interpolation for beam drift also in CalcImage.
	
10/12/15	Update Quick Start manual in distribution. 

		Update Getting Started manual (by Karsten Goemann).
	
10/10/15	Work on new MAN precision expressions from Singer.
v. 10.0.7
		Add calculate image statistics menu to CalcImage log window for currently open images.

10/04/15	Add element by stoichiometry and element relative to output .DAT files (Seward).
	
09/30/15	Add new pure element k-ratios to Penepma12 distribution.  Work on new MAN sensitivity expressions from Singer.
	
09/27/15	Change k-ratio error distribution .DAT files (Pouchou, NIST, etc) absorber only from 7 to 13 (additional x-ray lines
		means that 13 is now the absorber only integer flag, not 7).  Add to distribution files.
 
09/26/15	Improve TDI time estimation (Gopon).
	
09/23/15	Enable options in Automate! to allow Probe Image to be launched after the completion of 
		the automated samples in PFE.  Requires v. 1.2.2 of Probe Image.
	
09/22/15	Add "hi/lo" text to Elements/Cations dialog interference output (Poeml).

09/21/15	Improve time estimation for TDI option (von der Handt).

09/20/15	Add XLINE2.TXT and XFLUR2.TXT (all zero) text files for updating additional x-rays files.

		Add Cancel button to ZAFFLU3 negative MAC errors.

09/19/15	Updated XEDGE.DAT file

09/18/15	First release of additional x-ray lines (Ln, Lg, Lv, ll, Mg, Mz) (Gopon).
v. 11.0.6
		Fix CalcZAF "standard" output format.

		New matrix.mdb.
	
		Add new kratio table in standard MDB files for storing measured k-ratios on standards (for future error 
		distribution calculations).
	
09/16/15	New matrix mdb. Improved output for x-ray tables.	
	
09/15/15	Add check for missing or zero byte new x-ray files.
	
09/14/15	Fix wavescan display for additional x-ray lines (Gopon).
	
09/13/15	Fix beam scan calibration interpolation to use log-log relation (Carpenter).

		Add additional absorbers to FFAST2.DAT MAC table (Gopon).
	
09/12/15	Add more debug statements to function RealTimeGetBeamScanCalibration for advanced beam scan calibrations.

09/11/15	More work on additional x-ray lines (Gopon). Make JEOL monitor read statements key on VerboseMode flag (Carpenter).

09/10/15	More work on 8x30 get/set column conditions (Pinard) and additional x-ray lines (Gopon).
v. 11.05

09/04/15	Additional work on 8x30 save/load column condition code (Pinard). Fix minor CalcZAF bug (Poeml).
	
09/01/15	Add check for non-zero pixel dwell times in CalcImage. Add scan rotation command to Sx100 code for image acquisition.
v. 11.04
	
08/31/15	Fix bug in multi-point beam scan calibration code (Carpenter).
	
08/30/15	Modify Output menu and Elements/Cations and Acquisition Options dialogs per Anette von der Handt's designs.
	
08/29/15	Add dialog for selection of Bruker quantification method (Pinard and Goemann).

		Add update code for modified beam scan calibration parameters in Probewin.ini file (Carpenter).
	
		Fix element atomic charge saving in GetElm code (Neill). 
	
		Modify sort order options (Neill).
	
08/27/15	Add code to support PI automation from PFE. Fix NS update (probesoftware) ftp folder issue.

		Change "reading glasses" buttons to normal "Read" buttons in conditions dialogs (Hanson).

08/26/15	Fix stoich. oxygen problem in CalcImage caused by disabled quant fix (Buse).	
v. 11.0.3

08/25/15	Improve file handling for xray databases.  Improve debug output for beam scan calibrations (Carpenter).
	
08/23/15	Small tweak getting ready for additional x-rays lines in ZAFReadLn and ZAFLoadMAC.
v. 11.0.2
	
08/21/15	Move application files to Program Files and config and data files to ProgramData folder.
v. 11.0.1
		Add code to auto-update config and data files from old installation location.

08/16/15	Add checkbox for only display samples with data (von der Handt)
v. 10.9.9
		Start moving config files to ProgramData folder.
	
		Add UseConfirmDuringAcquisitionFlag to INI file (von der Handt)

08/15/15	Add check for DisableQuant flag in CalcImage output to Surfer (von der Handt).

		Add debug statements to beam scan calibration calculation code (Carpenter).

08/10/15	Re-arrange Acquire! buttons. (von der Handt).

		Fix Combine Lines code (von der Handt)

08/09/15	Copy Standard Assignments button to Acquire! (remove ratemeter window) (von der Handt).

		Fix ZAFMip overflow error on epoxy.
	
		Fix standard assignment combo order (Goemann).

08/07/15	Move JTA x-ray files to CITZAF folder. Modify conversion code in CalcZAF to use new path.

07/30/15	Fix problem with scale bar in Imaging if "Do not set Conditions" checkbox is checked (Seward).

		Modify code to improve sample memory allocations (Chouinard, Seward, etc).

07/28/15	New matrix.mdb.

07/23/15	Improve EDS during wavescan acquisitions.
v. 10.9.7

07/22/15	Minor improvements to Reed fluorescence. Utilize VB Replace$ function.

07/20/15	Add new 52.5 degree takeoff binaries to matrix database.
v. 10.9.6

		Minor bugs fixes in EMSA output and Automate! confirm dialog (Carpenter).

07/19/15	Fix .ELM file parsing bug (Roberts).

07/14/15	Minor tweak to add <cr> buttons to description fields.

07/11/15	Add code for CL dark spectrum acquisition. Add intensity display options for EDS and CL spectra.
v. 10.9.5

07/09/15	Fix problem when only one (!) MPB is specified. (Ben Wade)

07/09/15	Update feature for Allaz.

07/08/15	Fix chan index bug in DataMAN (Roberts).

07/7/15		Modify fanal matrix .TXT file format.

06/30/15	Fix fitting problem for APF calculations in FormMODEL (Cathey and Goemann) for wavescans.

06/28/15	Add formula by difference option to CalcZAF (not saved to .DAT file).

06/27/15	Fix minor display bug in ImageDisplay form (Chouinard).
v. 10.9.4
		Finish EDS and CL import to Standard.exe.

06/25/15	Start adding code for importing EDS and CL spectra into standard compositional database.

06/24/15	Fix "out of memory" errors when using integrated intensity acquisitions (Goemann, Steele)
v. 10.9.3
		Begin adding feature to import EDS and CL spectra to standard database.

6/22/15		Fix integrated (APF) intensity calculation bug in Model Backgrounds (Goemann).

		Add additional debug info for SX100SetPHAParameters (Morgan).

6/20/15		Update documentation for new CL INI keywords.  Tweak CL dialog GUI.

6/19/15		Add CL spectrum acquisition to PFE (currently demo mode only). Now let's spec a 
v. 10.9.2	hardware interface such as Ocean Optics, Newport Instruments, etc.

6/17/15		Fix increment import bug (Carpenter).

06/14/15	Finish implementing image math in CalcImage.  Very cool!  Try it out!

06/13/15	Start implementing image math in CalcImage.

		Fix nasty but easy to fix bug in Elements/Cations when unanalyzed oxygen is present (Cathey and Steele).

06/10/15	Add EDS acquisition to wavescan samples also!
v. 10.9.1

06/09/15	Add option for image vs. sample conditions in Run | Display Images dialog.
v. 10.8.9

06/08/15	Fix MPB flag with MAN problem in DataCorrectBackground (Creighton).

06/05/15	Minor fixes for new EDS/WDS array integration. One can now perform interferences corrections 
		between WDS and EDS elements! See PS user forum for more info.

06/04/15 	Combine EDS elements into WDS arrays for all analytical calculations (interferences, 
v. 10.8.8	etc) (Steele and Chouinard). Many changes to many code modules.

5/25/15		Fix sin thickness display for coating correction (Seward).

5/23/15		Improve calibration curve display (from Run menu) code.

5/21/15		Implement new non-linear alpha factor matrix corrections. Note: PFE runs that were previously assigned the 
		calibration curve correction method will now automatically be changed to these new non-linear alpha factors.
		This is a less than ideal consequence of adding another alpha factor method (in addition to the previous one,
		two and three regression coefficients) since this new non-linear method utilizes four (yes four!) regression 
		coefficients! 
	
		So any existing runs using the calibration curve correction method will have to be switched
		manually to the calibration curve method using the Analytical | ZAF, Phi-Rho-Z, Alpha Factor and Calibration 
		Curve menu. I am truly sorry about that but there was no other way to do it in the code...

5/18/15		Fix std assignment bug (Buse).

5/15/15		Updated help and docs
v. 10.8.7

5/13/15		Add formula by difference to alpha factor calculations.

		Start new EDS mods (Steele and Chouinard).

5/12/15		Fix nominal beam measurement in Count Times dialog (Roberts).

5/11/15		Add EDS standard arrays to List Report output.

5/6/15		Improve time estimation for automation. Improve ZAFFLU2 code.

		Fix wavescan file output (Poeml).

5/4/15		Improve automation time estimate.

5/3/15		Prune dead code from projects. Improve Penepma k-ratio matrix scan code to save test .dat files.
v. 10.8.6

4/28/15		Improve ZAFFLU2 code. Minor improvements to output.

4/27/15		Modify aggregate code so sample disable flags are *not* applied to non aggregate std elements (Lowers).

4/25/15		Fix subscript problem in user specified output (Pankhurst).

		Fix end member flag not saved.

4/24/15		Modify TimeUpdateElements control array loading (Steele). Improve EDS output to log window.

4/23/15		Modify Elements/Cations dialog to support editing of "Always Use" and 
		"Never Use" manual flags for all selected samples for MultiPoint Backgrounds (Poeml and Allaz).

4/22/15		Fix pre-peaking issue for subsequent elements on a spectrometer (Santos).

		Fix coating parameters for analysis of standards (Goemann).
	
		Fix MPB positions problem if using different config files for off-line processing (Neill).

04/20/15	Implement new fluorescence by beta line code.
v. 10.8.5

04/18/15	Make not used shape and label controls for elements in Time display invisible (Lowers).

04/16/15	Fix coating correction for when standard is being analyzed as an unknown (Goemann).

04/13/15	Finish "Do not normalize specified elements" feature for particle corrections (Chouinard).
v. 10.8.4

04/12/15	Fix Automated Y position increment behavior for first standard (Goemann).

04/10/15	Add flag for overwriting binary PAR files, if lower precision (less simulation time).

04/09/15	Enable Tip of the Day feature.

		Update matrix.mdb (Penelope fast MC) with 229K binary compositional k-ratios.
	
		Update CalcZAF source.

04/08/15	Add formula by difference feature to PFE.

04/7/15		Modify Combined Sample feature to automatically handle TDI table data (Neill).

04/03/15	Add code to model time for averaging in faraday and absorbed current measurements (Goemann).

04/02/15	Add debug code for AcquireDoTunableWavescanSpecROM.
v. 10.8.3
		Start removing temp file number globals and replace with local variables.

04/01/15	Numerous small tweaks.

03/31/15	Modify StageMap calibration to automatically save to INI file.
v. 10.8.2
		Fix MAN output bug (Carpenter).

03/27/15	Have TDI absorbed current acquisition respect Measure Absorbed Current flag (Goemann).

03/26/15	Add extra error trapping for wavescan acquisitions.

		Fix scan rotation convention in beam calibration code.

03/24/15	Add image rotation homography code to calculate beam scan image rotation in CalcImage.

03/22/15	Add batch code to update demo INI files automatically.
v. 10.8.1
		Update screen shots in PFE Reference manual.

03/21/15	Add CLR (Golden Software color file) conversion to PFE .FC color file (Roberts).

		Improve Grapher/Surfer determine Scripter app code and load from InitINISoftware code.

03/18/15	Fix MPB code for "shared" bgds (Lowers).

		Fix sample setups for EDS specified elements (Steele).

03/16/15	Fix INI read/write issues (Steele/Roberts).  Sorry about that guys!
v. 10.7.9

03/15/15	Fix missing trapping for disable quant and disable acq flags in shared bgd 
		multi-point backgrounds (Lowers).
	
		Fix setup.mdb issue for MPBs.

03/13/15	Work more on RGB window. 24 bit RGB BMP file output now working.

03/11/15	Fix peaking code bug (Hatton and Creighton).  Sorry about that, guys!

03/10/15	Add LUT to FC convert (Roberts). Add no beam blank option for Automate! Go button.

		Add Save To Clipboard in RGB feature. Finish removing wavescan code for FormPLOT.

03/08/15	First release of RGB window in CalcImage.  New pre-peaking code for acquisition in PFE.

		First release of new wavescan Plot! window. See output menu for old std/unk dialog.

03/07/15	Fix graph type control issue (Allaz).

03/06/15	Work on new wavescan plot window (Lowers).

03/05/15	Add all INI file keywords update.

		Add graphic elements for fitted MPB data.

03/04/15	Modify beam mode and image shift code to handle Bruker/Thermo imaging calls (Seward).

		Start adding INI keyword "write backs".

03/03/15	Add output for new beam and absorbed current output.
v. 10.7.7

03/02/15	Fix faraday/absorbed current printout.
v. 10.7.6
		Start formula by difference feature.

02/28/15	Fix absorbed current read for JEOL.

02/27/15	Fix user defined order bug in Acquisition Options (Carpenter).

02/26/15	Fix Calibrate Set Beam Current bug (Lowers and Carpenter).
v. 10.7.5
		Fix bug if using TDI and then switch to Alternating On/Off peaks and second point fails.
	
		Add code for TDI and Alt on/off absorbed current measurements (Fournelle).

02/24/15	Add maxtime label controls to GetOPT dialog.

02/23/15	Improve EDS predicted time estimate from Automate! window (Chouinard).

02/21/15	Utilize error handing in DataOpenDatabase code even in DataGetMDBSample to try and 
v. 10.7.4	eliminate "Could not lock file" errors on some computers (Kelly and Seward).
	
		Fix Acquire codes to handle dual faraday and absorbed current measurements.
	
		Modify Nth point element flags (Buse)
	
		Add warning to CalcZAF.ERR if Penepma binary not found in matrix.mdb.

02/20/15	Fix broken customizable scripts and post instructions to user forum (Hatton). Sorry about that folks!
v. 10.7.3

02/19/15	Add lots of little tweaks. Add CalcImage Surfer template flags and options to MDB file.
v. 10.7.2

02/18/15	Add plots per page and page delay menus to CalcImage (Roberts).
v. 10.7.1
		Fix minor time calculation issues with decontamination time.

02/17/15	A number of small fixes applied during AMAS 2015 (Goemann).

02/04/15	Fix EDS only bug in TimecalculateChangeTime (Chouinard).

		Comment out second faraday cup code measurement in AcquireDoTunable and AcquireDoTunable2 for now for
		combined condition samples (Neill).

02/03/15	Adjust beta line fluorescence code using Pouchou2.dat. Enable beta fluorescence flag again.

02/02/15	Fix pre/post scan (Fournelle)

01/31/15	Fix disabled control for ROM scanning option in Peaking (Fournelle).

01/29/15	Add before and after faraday and absorbed current measurements (Fournelle).
v. 10.6.9

01/28/15	Final testing of v. 10.6.8 complete (Neill and Seward).

		Additional k-ratios for matrix.mdb. Currently 200K k-ratios.

01/26/15	Add beam and sample current output to TDI format (Fournelle).

		Fix CalcImage raw intensity title (Buse)
	
		Fix faraday cup issue (Neill)

01/25/15	New "2nd generation" acquisition code is finally ready for beta testing.
v. 10.6.8

01/22/15	Add ConditionNumber element variable for eventual implementation.
v. 10.6.7

01/20/15	Fix aggregate intensity bug in CalcImage when some elements do not have images assigned (Buse).

01/15/15	Work on new combined conditions code.  Tweak Penepma (Penfluor/Fanal) material batch code.
v. 10.6.6

01/11/15	Work on new combined conditions code.
v. 10.6.5
		Add absorbed current to user specified output (Hanson).

01/06/15	Fix file/path error in PenepmaCreateMaterialBatch.
v. 10.6.3

01/05/15	Fix intensity display issue in TypeNewCounts.

		Add EDS form to CalcImage.

01/03/15	Add custom templates to TRAVXY in PFE and right click auto traverse and ternary 
		menus to Analyze!  Update .msi.

01/02/15	Finish auto traverse presentation output using Grapher scripting in PFE.

		Finish CalcImage output currently displayed images.

12/31/14	Work on GS/PE code in Standard for future conversion of graph control (von der Handt/Mulcahy).
v. 10.6.2
		Add PE v8 controls to deployment. Remove Penepma 2006 code and form.

12/30/14	Begin adding v 7 ProEssentials graphing controls to Standard and CalcZAF.
v. 10.6.1

12/27/14	Fix index bug in crystal list in CalcZAF.
v. 10.5.9
		Modify Penepma12 GUI code and create separate Graphics Server and Pro Essentials graphing procedures
		for eventual conversion to Pro Essentials graphing control. Same for CalcZAF alpha factor plotting code.
	
		Update makcalczaf.bat for new source files.

12/26/14	Improve handling of formula calculation errors during quant in CalcImage. Work on XYTRAV 
		Grapher presentation output code.
	
		Fix StageMap stage limits control code.

12/25/14	Implement "aggregate" feature for CalcImage (McFadden and von der Handt).

12/23/14	Fix bug in Plot Digitized Positions in Imaging/Digitize Image window (Chouinard).

12/22/14	Fix StageMap invalid property errors (Cathey).

12/21/14	Fix geological sort bug for averages, standard deviation in user specified output (Buse).

		Work on aggregate code for CalcImage (McFadden and von der Handt)
	
		Work of auto traverse presentation output.

12/20/14	Update PFE Reference manual. Work on auto traverse output.

12/19/14	Add code for asking user for approximate EDS deadtime before automated acquisition with EDS.

12/17/14	Minor improvements to CalcImage. Work on new XYTrav code.
v. 10.5.8
		Add some error trapping for Thermo interface for get net intensity call during EDS 
		acquisition (Chouinard).
	
		Fix labels in FormGETOPT for EDS max energy and pulse width if Thermo (Severin).
	
		Check for Thermo NSS version before calling  TEVB_ProjectExplorerDisplay and TEVB_SetBaseName 
		functions (Steele).

12/14/14	Fix List button in CalcImage.

		Fix .ACQ file for Demo3_Cameca BMP file.

12/12/14	Add scan rotation field to image structure and .ACQ file output.
v.10.5.7
		Work on converting .Line, .Circle, .Text graphics calls to Shape controls.

12/11/14	Add [ColumnConditions] section to ACQ file for saving keV and mag for CalcImage 
		calibrate beam scan calibration procedure.
	
		Add List button to BeamCalibrate form.
	
		Add automation pause if realtime during updates.

12/10/14	Important update to fix right click update of on-peak position in Run | Display
v. 10.5.6	PHA, Peaking dialog (Chouinard).
	
		Fix for rare problem that can cause files in the C:\Userdata folder (but not sub folders) to 
		get deleted (Lowers).
	
		New features for beam scan calibration window in CalcImage.  Additional error trapping in 
		AcquireDoSampleTunable.

12/9/14		Add additional error trapping for divide by zero counttime in AcquireDoSampleTunable (Lowers).

		New matrix.mdb.

12/8/14		Bump version. Add pause for k-ratio calculations in Standard.exe
v. 10.5.5

12/7/14		Preliminary release of CalcImage beam scan calibration feature.

12/6/14		Work more on CalcImage beam scan calibration feature.

		Add default RGB parameters to probewin.ini file.

12/5/14		Add version keyword in probewin.ini for StrataGEM $END output flag. V. 6 and higher of StrataGEM
		need this flag, earlier versions must *not* have this flag in the import file! New keyword is
		StrataGEMVersion=6 is the default in the [software] section.
	
		See documentation update in Help file.
	
		Work more on beam scan calibration code... getting close!

12/3/14		Add code to check for DefaultAperture (MiscIsInstrumentStage function not initialized (Severin).

		Disable electron fraction flag (will implement in future "rigorous" analytical matrix corrections. 
	
		Add relative offset for interferences (Poeml).

12/2/14		Fix duplicate element/disable quant issue in ZAFSTD (Poeml).
v. 10.5.4
		Modify Help | Update code (remove ZIP updates).
	
		Fix MAN vs. off-peak menu to force analysis reload
		
		Add Import PrbImg file to PictureSnap (Severin).

11/28/2014	Add checkbox for plotting currently displayed digitized points on Acquire! | Imaging window.

11/27/14	Modify Penepma extraction code to automatically handle low z emitters below 1 keV.

11/23/14	Fix StrataGEM import file format due to changes by JFT (Fournelle).

		Add JEOL 100 mm and Cameca 180 mm options to CalcZAF for spectrometer position calculation (Allaz).

11/22/14	Add refractive index fields to CalcZAF calculate Spectrometer Positions window.
v. 10.5.3

11/21/14	Add new spectrometer position calculation window to CalcZAF.

11/20/14	Fix clipboard errors in Edit | Copy menu (all apps).

		Move hysteresis command to before set beam current in SX100SetConditions code (Poeml).
	
		Handle cancel on start Thermo connection better.
	
		Re-write acquisition order dialog (Steele).
	
		Update matrix.mdb with some light element binaries.

11/18/14	Modify log window output to handle all EDS elements (no WDS) better and cleaner.
v. 10.5.2

11/17/14	Fix mineral end member calculations for elements by EDS (Steele).

		Fix polygon 3 per page script code (Chouinard).

11/14/14	Add Penepma update menu to CalcZAF, remove Penepma source files from CalcZAF distribution (Llovet).
v. 10.5.1
		Fix mineral end member check for handling elements by EDS (Goemann and Steele).
	
		Work on beam calibrate window in CalcImage... and conversion of .Line and .Circle calls to shape controls.

11/11/14	Add check for .in file (if it exists) before Fanal k-ratio extraction.

11/10/14	Add .in copies for each .par file.
v. 10.4.9

11/09/14	Tweak Penfluor code to generate <file>.in files.

11/08/14	Add code to automatically save Penfluor.in file with .PAR filename.

		Finish Thermo pulse processing function calls. Work more on beam scan calibration.

11/06/14	Add automatic adjustment of penfluor minimum electron/photon energy to ensure properly
		calculated .PAR files.
	
		Work on auto beam calibration code.

11/03/14	Tweak DCD input format to support three fiducials (Geomann).

11/01/14	Add calls for setting EDS MCS input labels for WDS pulses (Thermo only at the moment).
		New Probewin.ini keyword: EDSMCSInputsPresent=0. Set non-zero to enable.

		Add call to ask user to open Thermo project before get net intensity call (Seward).

10/30/14	Move SX100/SXFive hysteresis call to before set beam current to save time (Poeml).

		Also new Probewin.ini keyword for getting/setting max energy and pulse throughput: 
		EDSMaxEnergyThroughput=0. Set non-zero to enable (Pinard).
	
		Write import filter for .DCD stage digitizing position files (Goemann). Move both import
		*.LEP and *.DCD from PFE and Stage Output menus to Automate! window buttons.

10/28/14	Add Karsten's "How to do quant mapping..." tutorial as pdf to 
v. 10.4.8	CalcImage Help menu.

		Fix free CalcZAF download from epmalab.uoregon.edu (server appears to be case sensitive now).
	
		Add EDS detector insert/retract calls (Pinard). New keyword in Probewin.ini [hardware] section:
		EDSInsertRetractPresent=0       ; indicate EDS detector insert/retract hardware

10/25/14	Update PFE documentation and CalcImage context sensitive help.

		Remove alpha tables from boundary.mdb and add secondary index.

10/24/14	Fix "overlap" issue in auto mosaic.

		Modify Fiducial Select form (Seward and Goemann).
	
		Remove Matrix.mdb alpha factor and coefficient tables (faster).

10/14/14	Fix PHA scan display for count normalization (Chouinard). Repair test apps (TestProbe.msi).

10/13/14	Fix problem with folders on open file error (Steele and Goemann).
v. 10.4.7
		Add better debug errors for Penepma path not consistent with UserData path.

10/11/14	Fix broken code in Secondary.bas (SF correction in CalcZAF).                                  

10/10/14	Improve mosaic imaging. Modify automated image acquisition in PFE to
		use kilovolts and magnification from position sample.

10/09/14	Fix Mosaic feature to handle two or three calibration points in 
		arbitrary positions (Goemann).
	
		Improve calibration display in PictureSnap.

10/07/14	Fix image file browse (Carpenter).

		Improve deployment code to remove duplication (Donovan and Gaynor).

10/05/14	Add FANAL.TXT output file for parameters (instead of parsing folder name). 

		Fix loading of Fanal couples in CalcZAF. Add better error message to PositionDeleteSample (Chouinard)
	
10/04/14	Add light on/off to fiducial confirm dialog (Chouinard, Barkman)

		Fix SF correction bug in CalcZAF (underscore characters in Couple sub folder name).
	
		Start a TipOfTheDay.txt feature. When we get enough tips we'll show it!

10/03/14	Improve mosaic code. Clean up globals for off-peak strings.
v. 10.4.6
		Remove hlp files and obsolete joystick control from msi distribution.
		
09/30/14	Tweak mosaic imaging code (von der Handt).

09/24/14	Add BMP and ACQ output with GRD files for mosaic mapping.

09/23/14	Add demo1.bmp and demo4.bmp back into distribution (needed for demo image acquisition)
	
		Add Z position to mosaic feature (not used for output yet)

09/22/14	Modify PictureSnap image load to show all image files.
	
		Tweak mosaic feature in Stage.

09/21/14	Modify demo image filenames to show stage type (JEOL vs. Cameca).
v. 10.4.5
		Improve Mosaic image load.

09/18/14	Tweak mosaic feature to allow user specified images.

09/17/14	The new Mosaic feature in Stage.exe is quite usable now!  Try it, you'll like it!

09/16/14	Fix code for saving slope coefficients (Walshaw).

		Work on Mosaic feature (Stage.exe)

09/15/14	Modify JEOL image shift code to set and return in um units (Carpenter).

09/14/14	Fix image shift scaling for JEOLs (Pinard).

		Add disables for non-scan beam modes (image shift) (Pinard).

09/13/14	Add yellow box to show stage limits on stage maps.

09/12/14	Work mosaic area code in Stage.exe.

09/09/14	Fix Fanal input bug for takeoff angle.

		Add takeoff to Fanal output folder name. Modify CalcZAF SF correction for this change.

09/04/14	Improve "shared" bgds feature. Fix Penepma batch folder display issue.

08/29/14	Work on mosaic acquisition in Stage.exe (Topa).

08/28/14	Slight tweak to Update CalculateUpdateStandard to always load standard concentrations
		in all standard elements, even if disabled quant in unknown (Buse).
	
		Fix Pene4pma GUI to load detector geometry based on PDANGL parameters.

08/27/14	Add code to create pure element bulk standard input files in Penepma GUI. Add
		detector geometry options (annular and N,E,S,W).

08/24/14	Add additional Report output for Excel table (von der Handt).

08/20/14	Fix update MPB option bug in Plot! wavescan graph dialog (M. Williams).
	
		Fix TDI assignment bug for manual samples (M. Williams).

08/18/14	Improve Penepma GUI.

08/15/14	Modify Multi-point bgd display code to differentiate between normal MPB and "shared" MPB.

08/14/14	Implement buttons for "shared" off-peak backgrounds (load into MPB arrays). Idea from Goemann and Jercinovic.

08/13/14	Add customizable templates for Surfer scripting in CalcImage.
v. 10.4.4

07/28/14	Fix minor issue with Penfluor k-ratio extractions from .dat file.

07/25/14	Add Directory.bas to CalcZAF source distribution.                                  

07/25/14	Add option for date/time sorted list in Penepma batch mode window. Fix pure element 
v. 10.4.3	weight/atom string material filename issue in Penepma weight/atom string entry.

07/22/14	Fix wavescan menu (Goemann).  Add weight string entry button for Penepma window.

07/18/14	Modify calibration curve display to keep same element.

		Fix Goemann-Carpenter wavescan output. Allow user to browse for standard database if standard
		number is not found in default database (Goemann).
	
		Disable MACs button if calibration curve.

07/17/14	Improve Penepma alpha factors. Fix Standard Filter feature.

07/16/2014	Improve Extract K-Ratios code in Standard.exe.
v. 10.4.2
		Add new Filter Standards feature to Standard.exe Options | Find window.

07/14/14	Fix acquisition time bug for standards (related to fix for Meier).

		Add code to automatically extract k-ratios from Penepma batch runs.
	
		New Penepma binary k-ratios for high speed Monte-Carlo calculations.

07/11/14	New wavescan output format for Goemann-Carpenter.

		Fix replicate issue in Automate time calculation (Meier).

07/09/14	Allow TDI and Alternating On and Off peak Acquisition flags on same sample as long 
		as the 1 pass elements (TDI), are all MAN (not off-peak or MPB) (Chouinard).
	
		Improve TDI and Alt On/Off display in TDI dialog.
	
		Add interactive Help buttons to Calculation Options.
	
		Fix problem in modification of MPB parameters (Jercinovic).

07/04/14	Fix plot title positioning in CalcImage output when 1 plot per page is specified (Carpenter).
v. 10.4.1
		Minor mods to ZAFFlu for beta lines. Add beta line fluorescence flag to Probewin.ini file.

07/03/14	Fix interpolated background intensity in Model Background dialog when exponential
		fix is selected for multi-point backgrounds (Poeml).

07/02/14	Compile new Penepma k-ratios for Matrix.mdb (now 155K k-ratios).

		Work on GunAlign.

06/29/14	More work on GunAlign for better click response.

06/27/14	Work on GunAlign support for 8200/8500 (Neill).

06/26/14	Modify GunAlign to support turning HV on and off for JEOL instruments (Wang).
v. 10.3.9
		Add CaF2 particle test data to CalcZAF distribution (Carpenter).
	
		Modify right click Analyze! output code to disable unneeded controls.
	
		Add editable sample name to CalcImage dialog (Carpenter).

06/23/14	Modify Browse Input File (Penepma08.bas) to copy over all necessary files if not Penepma
		folder.
                                  
06/20/14	Add additional "interactive help" buttons to PFE dialogs.

06/16/14	Fix double output lines in PrintZAFSmp and misplaced label control for MPB (Neill).

06/13/14	Fix particle modeling bug in ZAFStd (remove ZAFInit call) (Carpenter).

06/12/14	Minor tweaks to Penepma GUI.

06/10/14	Slight tweak to improve log scale display in Standard. Add 20 more alpha binaries
		from Penfluor/Fanal.

06/09/14	Modify Penepma extraction code to deal with low Z elements without a K L3 
		transition (Vicenzi). Also disable all Penepma controls during calculation.

06/08/14	Fix graph mouse data cursor when in log10 scale for Fanal calculations in Standard.

06/07/14	Add relative line number output to user specified output (von der Handt)
v. 10.3.8
		Modify User Specified Output dialog to be wider and less tall for laptops.
	
		Update documentation and help file.
	
		Enable more "interactive help" buttons to user forum.
	
06/02/14	Modify Penepma binary extraction form to utilize several overvoltages.

05/29/14	Add data bar option to image display and output (Morgan).
v. 10.3.7
		Make StrataGEM output window modeless.
	
		Add raw intensity output (on-peak) to Surfer output menu.
	
		Fix minor issue in standard name update in DataStandard for standard coating parameter table names.

05/26/14	Add call to MonitorUpdate in RealTimeInit to fix problem for older JEOL instruments
		from out of bounds check on startup (Neill).

05/23/14	Minor tweaks. Update PFE documentation and Help file.

05/20/14	Add output of excess oxygen and element by difference to classify output in CalcImage (Seward).

		Add check for spectros in range (Carpenter) and warn user on startup.
	
		Force update analysis flag if unknown coating changed in Calculation Options.
	
		Modify Penepma batch code to display all parameters in main window as each input file is processed.
	
		Fix check for geometry file in PenepmaBrowseGeometryFile and PenepmaSaveInput.

05/16/14	Implement Kerrick at al. (1973) Amer. Min. coating correction per John Armstrong.
v. 10.3.6

05/13/14	Fix minor bug in time calculation when Use Alternating On and Off Peak option is combined 
		with MAN elements (Chouinard).

05/12/14	Improve coating absorption correction.

05/11/14	Modify DataLoadAllMAN code to skip deleted samples when loading MAN default assignments (Seward).

05/08/14	Modify default multi-point backgrounds to spread over a wider range.

		Adjust MPB acquisition time estimate.
	
		Add button to Peak/Scan Options to set wavescan range to multi-point bgd range.

05/02/14	Make MPB wavescan form "always on top".

		Fix Plot! (PlotGetSelectedData) for plotting z stage positions (Severin and Neill).
	
		Add linear beam drift correction to CalcImage quantification.
	
		Improve CalcZAF ZAFSMP output (ZAF4.bas).

05/01/14	Fix save of modified standard compositions in CalcImage. Fix assignment of multi-points 
		in GetElmAll if multi-point data not acquired (Carpenter).
                                  
04/30/14	Fix geological sort order for Mo (Carpenter).

04/29/14	Tweak CalcZAF debug output in ZAFStd.

04/28/14	Fix missing file error message in Penepma code. Modify CalcZAF output to use 
		MiscAutoFormat for better readability.

04/21/14	Modify total cation output and add total atom output to User Specified (Carpenter).
v. 10.3.5

04/16/14	Add new binaries to Matrix.mdb for fast Monte-Carlo calculations. See latest Calculated Alpha 
		Binaries.txt file for all binary pairs.

04/15/14	Significant modifications to improve calculation of standard k-factors when multiple duplicate elements
		are present (non aggregated and/or EDS). Changes to ZAFStd and UpdateCalculateUpdateStandard code (Kuehn).
	
		Fix default sample name in New Sample dialog (Roberts) if no samples.

04/12/14	Fix close EDS server client interface if only off-line processing (Thermo and Bruker).
v. 10.3.4
		Add code to skip MAN stds missing for disable quant elements.
	
		Fix problem in UpdateCalculateUpdateStandard when duplicate elements with EDS with disable quant 
		flag interactions (Kuehn).

04/11/14	Add trap for zero counts in TypeAnomalousData code (Goemann).

04/10/14	Add off-peak adjustment when adjusting on-peak in ScanData code (Poeml).

		Modify AcquireDoFaraday and AcquireDoSampleTunable and AcquireDoSampleTunable2 to
		fix TDI latency for combined condition samples (Goemann/Sherrin). No changes to 
		AcquireDoFaraday2 (for wavescans).
	
		Also fix AcquireStartVolatile and AcquireDoVolatileElements for assigned TDI samples when
		using combined conditions.
	
		Modify Penepma12Matrix code to read binary k-ratios faster (new indices).

04/08/14	Minor adjustments to Cameca MCA PHA to allow 256 point acquisitions (Goemann).

		Slight tweak to MANFitData.bas.

04/05/14	Modify Re-standardization error trapping from Automate! window (von der Handt).

		Fix geological sorting issue when duplicate elements are present (von der Handt). 

04/02/14	Add PHA keywords for MCA PHA (Cameca Sx100/SXFive only) (Seward and Goemann).
v.10.3.3
		Modify email error text (von der Handt)

03/31/14	Modify Cameca MCA PHA code (Chouinard).

03/27/14	Fix remaining monitor stopped issue (von der Handt).

		Fix SX MCA PHA subscript issue (Chouinard).

03/26/14	Make JEOL 8x30 "same command executed" error silent.

		Use 0 to 5 volts for Cameca MCA PHA range (older PeakSight erroneously displays 0.5 to 5.5) (Seward).

03/25/14	Improve Cameca MCA PHA. Work on JEOL 8900/8200/8500 monitor stopped issue.

03/24/14	Tweak JEOL error codes to allow for normal monitor stop events (von der Handt).

		Fix code that checks for internal and externally stored standard compositions (Goemann) in DataStandard.

03/21/14	Implement new double exponential fit for TDI extrapolations.
v. 10.3.2

03/19/14	Add new demo TDI code for more accurate simulations.

03/18/14	Slight mod for add element bug. Add extra output for JEOLGetCount errors (Severin).

03/17/14	Add code to automatically fix missing standard compositions in PFE database (Chouinard)

		Add slight delay after unloading form GETELM to allow form to be re-loaded for default standard 
		assignments. Previously the form changes were sometimes getting erased (Goemann).

03/13/14	Add extra error trap for JEOL micro-code error trap.
v. 10.3.1
		Remove obsolete XYSCAN.* files from distribution.
	
		Add separate error codes for JEOL 8x30 in some cases.

03/07/14	Add ImageShiftPresent and ImageShiftType keywords to INI file.

03/06/14	Finish implementing new code for PHA MCA acquisition (SX100/SXFive only!). Also requires a new Cameca
v. 10.2.9	driver update to v. 1.9.x.

		Modify DataStandard to handle the situation where the standard name was modified in the standard database. basically,
		allow the user the option to update the internally stored standard name when the probe data base is opened.

03/01/14	Add code for PHA MCA (Seward).
v. 10.2.8

02/27/14	Modify plot code to improve stage plotting. Add save polygon boundary for Digitize Image code.

02/17/14	Perform code "analysis", remove dead variables, etc.

02/25/14	Update CalcImage and ProbeForEPMA documentation.

02/24/14	Fix digitized point size code for image digitizing.

		Change BitBlit to normal redraw for wavescan and PHA scan plots to avoid Win8 problem (Seward).

02/22/14	Add StartWin to TestProbe installer (JEOL Japan).
v. 10.2.7
		Begin coding new PHA MCA acquisition code for Sx100/SXFive (and demo). (re-define PHAHardwareType INI keyword)
	
		Fix minor bug in automatic standard assignments in Elements/Cations from Acquire! window.
	
		Modify TDI printout for samples.

02/21/14	Add standard output new keywords to INI documentation.

02/20/14	Modify TestProbe WIX script to clean up installer.

02/19/14	Modify Evaluate.exe to handle calculations using alpha-factors.

02/18/14	Modify User specified output to also include standard published, % variance and algebraic 
v. 10.2.6	difference output.

02/17/14	Have range window load density automatically if from database.

02/13/14	Implement interference correction for elements that utilize virtual standard intensities (Poeml and Wright).

02/11/14	Modify SETELM and SETSTD forms for laptops (Allaz).
                                  
02/10/14	Authenticode sign all executable files also. Add "Do not overwrite" to xline.dat also in WIX code
		for CalcZAF.msi.

02/08/14	Add ImageShiftMinimumMag keyword for Probewin.ini to allow warning to user (SX100/SXFive only) 
v. 10.2.5	if mag is too low for image shift.  Update captions in Analytical Conditions dialogs on the fly.

02/07/14	Modify Load File Setup code to also load EDS spectrum intensities when loading standard samples 
		with EDS spectrum data (Kuehn).

02/03/14	Add 200 msec delay before reading scan status structure in SX100SetImageShift to prevent spurious error (Seward).

02/01/14	Fix Bruker GetNetIntensity call (Kuehn).

		Move some extraneous code (Command, MakeXray) to separate folders. Change name of Test_SX100 to TestSX100.

		Add JEOL code to check for too large image shift (Pinard).

01/29/14	Minor improvements to CalcZAF.

01/28/14	Add additional options for viewing instrument config tables.

		Modify standard composition handling on opening old file.

01/26/14	Add additional code to handle if local standard.mdb does not contain standards for the run. Warn user
		and create a temporary standard database for this session.
	
		Add dialog to allow user to select the instrument configuration files to export from the probe database.
                                

01/24/14	Remove Remote and Matrix update ZIPs.  Just use Matrix and Remote msi files for updates now.
v. 10.2.4
		Add tables to store all PFE config files in each MDB file. This will allow export of the config files for various
		purposes.
                                                               
01/23/14	Modify acquisition code to utilize UseCurrentConditionsAlways flag more intelligently (Hanson).
v. 10.2.3
		Re-scan Fanal matrix files for new matrix.mdb (now over 100K binary k-ratios stored).

01/21/14	Minor tweak to Bruker and Thermo EDS get net intensity code. Fix EDS k-ratio precision issue (Severin).

01/18/14	Add line, spectro and crystal to other output types if intensity data.

		Modify web site and links to web site for off-line browsing from all apps.

01/17/14	Add support for DVD local browsing from DVD media for labs that cannot have Internet 
		connections (subscription based browsing and updates).
	
		Modify Init1.bas code to more accurately report bad INI keywords.

01/15/14	Modify MAN custom output to include line, spectro and crystal. Modify UpdateMANStandards
		code to respect disable quant flag (Carpenter).

01/12/14	Modify open/save file dialogs to utilize original parent window handle to prevent Modeless 
v. 10.2.2	file open/save dialogs.

01/09/14	Modify ROM wavescans to store modified dwell time per point when speed is out of range.

		Improve ROM scan demo intensities for multiple scans.

01/07/14	Minor tweaks for pre/post scan labels (Cathey/Fournelle).


01/05/14	Re-scan matrix.mdb (Fe-Pt, etc. binaries)

01/04/14	Fix duplicate element problem for alpha factor calculations.

		Add warning output to TypeWarnings that specifies duplicate elements and x-ray lines.

01/02/14	Fix bug if CalcZAF dat file sample name contains a comma. See SiIr1.dat

12/31/13	A plethora of small tweaks for PFE and CI after spending the weekend with John Fournelle and 
v. 10.2.1	Gareth Seward- thank-you guys!

		Happy New Year!
	
		Fix Pre/Post ROM wavescan bug (Fournelle).

12/23/13	Update DHZ.MDB to include densities and page references (by Barkman).

12/22/13	Add Chemical age output (for calculated Pb) in PPM (Allaz) in CalcImage.

12/21/13	Add additional FOV fields to some conditions dialogs. Add beam scan calibrations to DataRun so they will stay
		with the MDB file. Update reference manual. Update all copyright notices.

		Modify CalcImage output to support all quant types for polygon, slice and strip operations.

12/20/1013	Modify beam scan calibration Probewin.ini parameters into arrays to calibrate beam scan images based
v. 10.1.9	on current keV and mag to produce interpolated X and Y scan size and rotation (up to 32 calibrations).

12/18/13	Fix MAN search for elements with Bragg orders greater than 1 (Hanson).

		Skip off-peak warning during peaking if MAN (Carpenter).
	
		Fix labels on U-Th-Pb x-ray output maps to Surfer (Allaz).

12/16/13	Add check for too large image shift for given analytical mag (Cameca only).

		Fix title too long bug in Standard for fanal plot.
	
		Fix CalcImage Base64Reader bug for 1 pixel Cameca input.

12/14/13	Fix bug in CalcImage mineral end-member calculation. Fix image loading in CalcZAF Correction secondary fluorescence.

12/05/13	Modify resize code to handle all aspect ratio circumstances in CalcImage.

		Modify GRIDXY.BAS script to handle short or tall x-ray maps for output to Surfer.

12/04/13	Fix image resize for wide or tall images (Ma and Hatton).

12/03/13	Fix CalcImage GRD bug when outputting Surfer scripts and PFE elements and CI images are in different order (Ma).

12/02/13	Minor tweak to amphibole and biotite code for negative concentrations!

12/01/13	Fix minor issue when saving ACQ file from Classify operation (save existing PictureSnap filename).

		Fix ghosting of "gunsight" cursor in PictureSnap after using some Save As methods  (Carpenter).

11/30/13	Minor tweaks to loading BMP Cameca files when in JEOL mode in PictureSnap.

		Add check for edge energies below default penfluor modeling energy and warn user.
	
		Add some 500 eV files to Penepma12 distribution (Wade).
	
		Change "Meas. Wt.%" to "CalcZAF wt.%" in Penepma/Fanal plots and add ZAF mode to label.

11/29/13	Minor changes to TestEDS and Bruker code. Bruker spectrum acquisition is again working with latest 
		Bruker RTIfcClient.dll file. QuantifySpectrum (for net intensities) is also working but the ShowSpectrum
		function still always returns -1.
	
		Fix Cameca vs. JEOL conversions in Classify and PictureSnap. Whew again!
	
		Add x-ray line to TDI plots.
	
		Force reload of standard intensity arrays if TDI assignment changed on standard.

11/26/13	Fix bug when peaking on combined conditions sample and using assigned standards for peaking (Barkman).

		Fix bug in Report from Analyze! window for some combined condition samples (Barkman).
	
		Add EDS interface type to TestEDS.exe main window.
	
		Modify Penepma08 Batch form for bigger label fields.

11/22/13	Modify FormScandata to allow user to change on-peak position for current sample by right clicking graph.(von der Handt)

		Add display of last loaded POS file in FormAUTOMATE.
	
		Modify caption of Decontamination Time checkbox in Acquisition Options to include "Incubation Time".
	
		Modify TDI plot labels to include keV, nA, um and TDI interval time.
	
		Fix problem with using digitized conditions from Automate! window with combined condition samples (Barkman).

11/18/13	Fix PenepmaExtractMatrix code to zero undervoltage arrays.

		Modify "large matrix correction" criteria in Penepma matrix scan MDB file code.

11/16/13	Modify TDI display code to properly plot TDI intervals at 1/2 interval time (Hanson).
		The TDI quant analysis was being calculated correctly. This change will propagate to all output modes.

11/15/13	Add Excel output option to Plot! window if Send Data To ASCII File option is selected. (Poeml)

		Fix Plot! window when both Average Only *and* Minimum Total are used together with multiple samples (Poeml).

11/14/13	Fix geological sort function for some parameters that are only real-time. (Feig)
v. 10.1.8
		Add warning to CalcZAF range calculations if edge is greater or equal to keV.
	
		Fix Cameca config loading JEOL files in CalcImage.

11/12/13	Fix minor CalcImage CPQ bugs for quant.

		Improve stage unit output for CalcImage Polygon.

11/09/13	Modify loading and saving of BMP files when converting from Cameca to JEOL or JEOL to Cameca.

11/08/13	Fix loading problem in GridCheckGRDInfo (not finding ACQ file and not returning "g" defaults when creating 
		new GRDInfo.ini) (Carpenter).
	
		Make sure all icancelauto flags are initialized properly.
	
		Add additional "Interactive Help" buttons.
	
		New Matrix.mdb file with 104K binaries.

11/04/13	Go back to old code for closing DigitizeImage, because of possible problems with 8900 image acquisition.
		Instead set scan mode after image acquisition in JEOL and Cameca) HAL code. For Lowers and Carpenter.

11/03/13		Add automatic output of ACQ files when outputting BMP images from CalcImage Classify menu (so they can be 
		loaded stage calibrated into PictureSnap).
	
		Finally completely fix saving and loading of PictureSnap images when loading images 
		from different stage systems.

11/01/13	Fix Bruker GetNetIntesities (and GetQuantificationMethods) call (Rossek).

		Tweak CalcImage pixel indexing for normal and "hyper-cursor". Works on both Cameca and JEOL orientations.
	
		Add automatic output of TXT and ACQ files when outputting BMP images from PFE Output menu (so they can be 
		loaded stage calibrated into PictureSnap), Barkman/Chouinard.
	
		Add feature to allow user to automatically select elements based on their spectrometer order numbers in
		the Peaking Options dialog. This could have a number useful applications, but I added it so I can easily
		select the next set of elements for automating WDS mapping acquisitions in Probe Image when more than 5 
		elements need to be acquired in Probe Image for complete characterization.

10/31/13	Fix hyper-cursor z data indexing in CalcImageUpdateXYZ

10/29/13	Add oxide mole percent calculations to user specified output (Hanson).
v. 10.1.7
		Fix minor bug in CalcImage Surfer output.

10/26/13	Minor tweaks to CalcImage for better saving of std assignments.

10/25/13	Modify calls in FormIMAGE QueryUnload event to set beam deflection center before setting beam mode (Carpenter).

10/22/13 	Fix Penepma input file issue when data line runs into comments.

		Add empirical MAC and APF menus to CalcImage.
	
		Modify CalcImage to set pixel dimension square if image is only one pixel wide or tall (was always forced to 1 um previously).

10/18/13	Add image extents in stage units to pop up help in CalcImage MDI windows and map extents 
		in Classify window in um.
	
		Add EDS interface types to GUI in PFE.
	
		Add image extents in stage units to CalcImage Surfer export scripts (Poeml).
	
		First Hyper-Imaging code release in CalcImage. See Processing | Classify Image menu.
	
		Fix time and beam display in log window for EDS elements.
	
		Updated matrix.mdb file (Ruscitto).

10/14/13	Modify Fanal overvoltage check code in Penepma12ExtractMatrix.

10/11/13	Work on CalcImage Hyper-Imaging feature.
v. 10.1.6

10/9/13		Remove Probewin.cor file code (not needed any longer) (Feig).

		Disable Beam and Stage buttons in Digitize Image form (Andersen).

		Reset channel number to zero in VolatileData.bas (for opening new run data).

10/8/13		Fix TDI Display Run menu load. Make sample channel "sticky". (Barkman)

10/7/13		Fix bug for saving current peak positions in GetElmAll.

		Fix oxygen equiv. of halogen subtraction from oxide analyses (Andersen).

10/5/13		Fix time estimate during acquisition if using peaking on unknowns.

		Prevent update on real time sample parameters in GetElmAll if sample has no data but is being acquired.

10/4/13		Add relative cursor for wavescan plots (Andersen).

		Fix TDI display bug if no TDI data in last sample selected and plot fit is clicked.
	
		Do not update off-peaks if current sample is being acquired (and no data yet).

9/28/13		Add "Interactive Help" buttons to Digitize Image and Polygon Grid dialogs to connect to 
		appropriate user forum topics.

9/26/13		Make Help buttons blue.

9/25/13		Bump version to force updates
v. 10.1.5
		Add Help button to MAN dialog.

9/24/13		Add more Help menus to CalcImage and add Help button to CalcZAF SF correction window.
	
9/23/13		Default minimum mag on JEOLs to 12x (Carpenter).

		Copy some exe and other files from CalcZAF.msi to ProbeForEPMA.msi so they get updated just with PFE.

9/22/13		Fixed standard database import/export density bug. (Pinard).

9/21/13		Add Help links to Penepma GUI windows. Improve error handling in CalcImage and ZAFSmp code.

		Start work on Hyper-Imaging feature.

9/20/13		Modify ZAFSmp to handle negative k-ratios better (Spilde).

		Make several improvements to the Penepma GUI in Standard. Now it can read existing input files among
		other changes.
	
		Fix display if one side multi-points and display peak intensities checked. (Wade).
	
		Add min/max magnification to Probewin.ini [hardware] section (Severin), so user can customize it.

9/18/13		Add bilayer_100nm.geo file to Penepma folder for default thin film calculations.

		Fix labeling issue for thin film MC Penepma window.

9/17/13		Modify EDS init and close functions to better support dual interfaces.
v. 10.1.4
		Add Elements/Cations forms and code and Standard Assignments forms and code to CalcImage.

		Fix CalcImage CalcImageCorrectData "subscript out of range" bug (Hatton).
	
		Fix PFE TimeCalculate "subscript out of range" (Wade).
	
		Modify SETELM form for multipoint controls (to match Plot! Model Background form).

9/16/13		Modify Penepma MC window to improve instructions and tool help.

		Add statistics output to convert routines (CalcImage).

9/14/13		Automatically load density when user selects alternative match to composition in CalcImage modal window.
                                  
9/13/13		Modify 8530 analog signal selection to match PI (Gaynor).

		Fix composition match when no match is found in CalcImage.

9/12/13		Fix Chem Age flag behavior in Options.bas.

		Fix detection limit and analytical sensitivity calculations in CalcImage if specified sample setup has no valid data.

9/11/13 	Fix excess oxygen printout in match window.

        	Add force faraday insert for Read Conditions buttons in forms (Cathey).
        
        	Fix end-member calculations in CalcImage

9/09/13		Add export menus to CalcImage.

		Add delay after image source selection for 8530. (Ruscitto)

9/08/13		Make missing data pixels gray in CalcImage analytical sensitivity output to Surfer (Barkman).

		Fix Log wt% output in CalcImage.
	
		Center beam deflection when closing Imaging window.

9/07/13		Fix issue with reading GRDInfo.INI files (CIP,GRD,DAT versus ACQ)

		Start implementation of beam deflection read from instrument for PCSEM deflection and PFE acquisition (Pinard).

9/06/13		Implement element by difference image in CalcImage.
v. 10.1.3
		Implement detection limit and analytical sensitivity image output in CalcImage.
	
		Improve 8530 beam modes code.(Pinard).

9/02/13		Tweak code for 8530 beam modes, al la Pinard.

8/28/13		Add call to save new file to INI recently opened file list.

8/27/13		Add code in CalcImage to handle single pixel line scans.

		Add check for crystal flipping flags for flip position in InitScalers. (Carpenter)

8/26/13 	Fix one pixel dimension output bug in CalcImage.

8/24/13		Modify large bias voltage change warning to only apply to Cameca instruments (Carpenter).

		Update Matrix.mdb.

8/23/13		Trap situation where user specifies "quick stds" and sample setups, which
		conflicted by overloading the last unknown count times for the quick stds. (Goemann).

		Fix loading of Remote help file from Help menu.
	
		Modify PictureSnap to save stage polarity and units to .ACQ files, so JEOL and 
		Cameca stage coordinate systems are automatically handled.
	
		Modify PictureSnap calibration dialog to show Z stage positions when using 3 point calibration 
		for Z tilt correction. (Seward)

8/20/13		Update Matrix.mdb for newly calculated Penepma Monte Carlo derived k-ratios
v. 10.1.2	for polynomial alpha factors.

		Add Np and Pu emission line energies and fluorescence yield values (Poeml).
		From Hubbell, et al. Xline.dat and Xflur.dat.
		
		Save standard table automatically after adding/removing standards and update recently
		opened file list after opening file. (Barkman)

8/17/13		Reverse sort version.txt (this file). Post to forum as "sticky"

		Update INI file comments.

8/16/13		Fix PictureSnap analysis position display bug on rotated images.

8/15/13		Fix 8530 beam deflection bug.  (Severin).	

		Add code for 8530 beam modes, al la Pinard.

8/12/13		Improve error checking and enables for beam deflection controls.
	
		Fix bug when no WDS elements are selected and using EDS acquisition in demo mode (for Penepma material file input).
	
8/11/13		Allow beam deflection when using column conditions. Print warning. (Poeml)
	
		Allow beam deflection on stds (add controls to FormAUTOMATE). Tested in demo mode, so it should be good to go. (Poeml)
	
		Change 8200/8500 and 8230/8530 fine condenser iteration increment to (only) 2 times 8900 increment.
	
		Modify analytical/column conditions dialogs (Wright).

		Add Penepma12.zip to CalcZAF distribution (ZIP and MSI). Now unzips Penepma12.zip automatically when necessary.

8/10/13		Add Connect To Probe Software user forum menu to the in CalcZAF and PFE Help menus.
v. 10.1.1
		Modify Thermo init routine to search for NSSMachineSettings.ini properly.

8/2/13		Modify light on/off behavior for JEOL auto-focus (move above HAL). (Severin)
	
		Fix negative log in PAP routines for x-ray quant mapping (Fournelle).

7/31/13		Add output of MinimumFaradayCurrent in low beam current warning (Severin).

		Add spectro and stage position returned if error returned from instrument in JEOLGetMotorPosition.

7/24/13		Add probe scan on/off to 8530 beam mode (if not digital spot) (Adams and Carpenter).

7/23/13		Modify JEOL beam current limits for condenser lens values (Carpenter).	
	
		Also missing Probewin.chm and CalcImage.chm files.	

7/22/13		Add TestEDS.exe to ProbeForEPMA.msi installer (Carpenter).

		Modify CalcImage to auto load convert quant images (end-members). Add end-member images to open quant images.
	
		Remove some obsolete fixed spectrometer code.

7/19/13		Add output of mineral end members to user specified output (Carpenter).
v. 10.0.7

7/16/13		Fix Matrix and Remote CHM paths.
v. 10.0.6
		Add calculation options (end-members, chem age and log wt%) for quant images in CalcImage.
	
		Modify Run | Display TDI menu dialog to not indicate elements that are not TDI or alternating on/off. (Barkman)
	
		Increase MAXSTDS from 80 to 128 per run. (Goemann)

7/13/13		Add check for matching Bragg order in Update.bas load std, std interf and MAN stds code. (Seward)
v. 10.0.5
		Increase MAXSTDS from 64 to 80 per run.

7/9/13		Modify classification iteration tolerance range.	

		Add CHM help to apps.
	
		Modify InitScalers to print spectro number for bad data.

7/3/13		Modify VolatileDataLoadSampleChans code to list TDI channels, even if turned off (Barkman).
v. 10.0.4

7/2/13		Fix typo in User Specified Output preventing proper loading of sample description flag.
	
		Modify user specified output to use form options for standard and unknown output selection (Carpenter).
	
		Add updated help file.

7/1/13		Add spectro number to RealTimeSetPHAParameters invalid parameter error message.	
	
		Add CHM help files to distribution- not implemented yet.

6/29/13		Remove fixed spectrometer code and parameters.
v. 10.0.3
		Modify Output menu again.
	
		Save wavescan stage step increment automatically when using X/Y spin buttons.	

6/26/13		Increase maximum analytical mag to 800K (Seward).
10.0.2

6/24/13		Remove CalcImage examples from Source.	

		Reference manual updated.
	
		Only JEOL 8900/8200/8500/8x30 and SX100/SXFive and Axioscope interfaces still supported!!!

6/22/12		End of support for some instrument interfaces including AM (1), Sesame (3), Tracor (4), SX50/51 (6), 
v. 10.0.1	Thermo TN (7), JEOL 6300/6400 (9). 
		
		Fix loading of sample name for automated image acquisition (Whan).
	
		Fix geological sort bug in User Specified output (Carpenter).
	
		Fix software stage backlash when using beam deflection (Poeml).

6/20/13		Fix MAN disable quant flag stuff (Carpenter).
v. 9.5.5
		Update Reference manual and help.
	
		Fix FormLOCATE for MAXROW=500.
	
		Modify Output menu.

6/17/13		Modify case of msi download files.
v. 9.5.4

6/14/13		Add geological order sorting in User Specified Output (Lowers- you owe me two beers!).

6/13/13		Add delays for load column condition (Poeml).  Adjust using ColumnConditionChangeDelay keyword.
v. 9.5.3
		Modify ProbFormLoadDemoCounts to allow EDS spectra to be calculated even if no WDS elements.
	
		Modify Update batch files to exit on completion of msi install.
	
		Add call to Call RealTimeGetAllPositions(Int(1)) when unloading FormCONFIRM (Barkman).

06/12/13	Modify IOStatusAuto to write status strings to log window if debugmode (Poeml).
	
		Add unit conversion to CalcImage BMP Save and PictureSnap BMP load.

06/11/13	Modify Help Update form to allow ZIP update if ExtendedMenu in [software] section is true

		Modify tiling aspect calculations in CalcImage (Poeml).

06/09/13	Add PictureSnap cursor update to Classify and MDI forms.
v. 9.5.2
		Add PictureSnap to CalcImage.
	
		Turn off hyper cursor in CalcImage if on and Classify window is closed.
	
		Fix title of Temperature calculation dialog in CalcZAF.
	
		Disable ZIP (quick) update option.

6/08/13		Update PFE FAQ document.

		Add menu for loading stage calibrated BMP file into CalcImage (unfinished).
	
		Add code to re-send PHA in Return To On Peak button in the Peaking dialog in case crystal flip caused a re-set
		of the PHA parameters (SX100/SXFive only?) (Seward).
		
5/30/13		Add code to check that all GRD output files are available for Surfer script (Spilde).

5/29/13		Modify user specified description field to convert crlf to comma for proper input into Excel.
	
		Add check for numberoftunable specs in DataMotor if RealTimeMode (in case config does not match).

5/28/13		Add sample description to user specified output (Lowers).
v. 9.5.1

5/27/13		New msi and doc files.
v. 9.4.9
		Add check for disable acq flag in DataMANLoadAll (Carpenter).
	
		Add sample specific flag for chemical age calculations (Allaz). Global flag in Analysis Options is still there 
		for toggling on/off and for backward compatibility.
		
		Fix CalcImage modal output for Surfer to display classify map in JEOL orientation.
	
		Fix Plot! button in Automate! window to display JEOL coordinates with anti-cartesian orientation.

5/24/13		Comment out line in BrukerEDSSpectraGet to get live display of Bruker EDS intensities.
v. 9.4.8

5/22/13		Fix CalcImage Close Off-Peak Images menu code to handle windows loaded out of order.	
	
		Show EDS display if Bruker EDS acquisition (Bruker client may not be visible and does not display data by other clients).

5/21/13		Modify code and add SX100 (SXFive) delays for spectro scans (Goemann).
v. 9.4.7
		SX100ScanSpectroMilliSecDelayAfter=200
		SX100ScanSpectroMilliSecDelayBefore=200
	
		SX100MoveStageMilliSecDelayAfter=10
		SX100MoveStageMilliSecDelayBefore=100
		
		SX100MoveSpectroMilliSecDelayAfter=10
		SX100MoveSpectroMilliSecDelayBefore=100


5/20/13		Change SX100Velocity Z axis speed limits to 1 to 200 (SXFive = 1 to 10, SX100 10 to 200) (Goemann).

		Fix Run | Type Standard Compositions to print "n.a." for elements not in standard (Carpenter).
	
		Add new delay flags for Sx100 (Poeml and Seward instruments only):

		SX100MoveStageMilliSecDelayBefore=100
		SX100MoveSpectroMilliSecDelayBefore=100
	
		Add all output data types (NetInt, BgdInt, Kratio, Quant, Atomic, Oxide and Formula Basis) to CalcImage "Polygon" 
		and Strip output menus.
	
		Fix default GEO browse folder (change to Penepma_Root folder).
	
		Make hyper-cursor not visible if outside stage extents.

5/19/13		Fix column labels for all data types in classification DAT file.
	
		Add all output data types (NetInt, BgdInt, Kratio, Quant, Atomic, Oxide and Formula Basis) to CalcImage "Slice" output menu.

5/18/13		Add call to ElementGetData in CalcImage for loading oxide symbols for output.	
v. 9.46		coordinate system and writing to the original (e.g., JEOL vs. Cameca). See new GridCheckGRDInfo code in CalcImageOutputDataAll.
	
5/3/13		Darn!  Had to do a quick tweak to handle situations when re-calculating quant data obtained from one instrument 

5/2/13		Add hyper cursor menu in CalcImage.	
v. 9.45

v. 9.44		Modify Matrix and Remote to *not* check for registration!

		Add Getting Started and Advanced Topics menus to PFE ZIP.  Add GS and AT menus to Help in PFE.

4/28/13		Add Getting Started and Advanced Topics pdfs to distribution msi files.
v. 9.43	
		New installation msi files.
	
		Add SX100MoveMilliSecDelayBefore=100 keyword for Sx100 instruments using software backlash (Poeml and Seward).

4/27/13		Modify InitUserDataDirectory to test for all folders and print out more info if error (Mace).
	
		Modify CalcImage to output classification (multi-column) DAT files for all output types (Carpenter).

4/26/13		Add mag and beam mode controls to FormCOND2 for combined condition samples (Vigoroux)
v. 9.42

4/25/13		Fix off-peak time control disable bug in GetTimSetTimLoad if MAN.

4/23/13		Add call to read positions during FormCONFIRM even if stage map is not visible to service driver.

		Increase minimum overvoltage for Fanal binary extractions.

4/22/13		Fix rounding error in SX100MoveMotor. 

4/20/13		Add debug statement if skipping motor move (SX100/SXFive) because target and current position are the same.


4/19/13		Add code to SX100 HAL (in SX100MoveMotor and Sx100GetMotorStatus) to check current position and if the same as target, 
v. 9.41		just exit (Poeml).


4/18/13		Add code in SX100GetMotorStatus to allow automation to proceed if target = position even if motion compete 
		status is not returned (Poeml).	
	
		Add oxide formula to CalcImage oxide output.
	
		Fix Penepma12 k-ratio calculations code.

4/17/13		Add Excess Oxygen examples to CalcImage.zip.	

		Modify Surfer scripts to output axis invert flag for JEOL images (Carpenter).
	
		Add better error trapping in Penepma12CalculateKratios.

4/14/13		Add fix for Sx100 count status.
	
		Add check for counting time out (count time complete but no completion status).	
	
		CalcZAF alpha factors now support SF boundary correction.
	
		Add "hyper-imaging" cursor to CalcImage.

4/12/13		Fix menu disable during quant in CalcImage.	

		Skip material calculations in Penepma12CalculateKratios if skip flag is set and PAR exists.

4/9/13		Show log window from CalcImage if double clicking on match.
	
		Add density field to Standard table in PFE.
	
		Fix CalcImage bug when canceling project and disable Project menus when running quant calculations.

4/7/13		Add density load for CalcImage modal match (Barkman).
v. 9.3.9

4/6/13		Add net intensity, bgd intensity, kratio, atomic, oxide and formula calculation and output to CalcImage.

4/5/13		Start adding output options to CalcImage for atomic, oxide, formula and excess and bgd and kratio intensities.
v. 9.3.8	
		Modify CalcZAFBinary to print problematic binaries after all binary calculations.
	
		Fix Standard Penepma12 batch mode dialog issue (Gopon).

4/3/13		Fix TestEDS (Carpenter).

4/2/13		Modify error trapping and file close statements.
	
		Add code to check for missing Penepma folders.

4/1/13		Fix Penepma12MatrixScanMDB to handle txt files with 52.5 degrees takeoff angle.
	
		Add error trapping to Penepma08 code (Gopon).
	
		Work on PFE SF code (almost finished).

3/29/13		Add pixel dwell (count) time to CalcImage dialogs for information purposes (not used since intensities are already in cps).
v. 9.3.7
		Fix normalize code in FormulaWeightToSample.

03/27/13	Fix minor bug in Standard in Penepma12Save for saving default x-ray line.
	
		Fix minor Penepma/Penfluor alpha factor bug when one binary (or the binary pair) wasn't found in the matrix.mdb file.

v. 9.3.6	New SF boundary code.

v. 9.3.5	New SF boundary code.

		New distribution of CalcZAF and PFE
	
		Add Pouchou2.dat (more complete k-ratio database from Pinard).
	
		If using default beam blank = false, use timed msgbox to confirm beam unblank (Goemann).
	
		Fix duplicate element display for standard published values in Analyze! average grid.

3/22/13		Add warning to Acquire code if user tries to change analytical conditions or perform peak centering
		on standard or wavescan samples. (Meier)
	
3/20/13		Add support for alpha factors calculations in CalcZAF binary k-ratio calculations.

3/16/13		Work on saving and reading k-ratio files for secondary fluorescence boundary corrections.  Almost working!
v. 9.3.5
		Add size zero default after automation (Barkman).
	
		Add Z data cursor to FormANALOG.

3/15/13		Work on PFE SF database tables

		Fix default focus- call after MoveReturnToPeaks.

3/14/13		Fix loading of default palette- call first during init.
	
		Add CalcImage PDF to Help menu.
	
		Add new global to force beam size to zero when finished with acquisition (Wykes).	

3/13/13		Fix cluster color display bug (Wykes).

		Work on secondary fluorescence boundary correction code for PFE.  This is a lot of work- I sure hope 
		someone uses it!
	
3/8/13		Modify InitFiles to check for decimal and thousands separator (Lowers).	

		Add more correction factors to user specified output (Kuehn).
	
		Make additional changes in reading/writing probewin.cor for language issues. (Lowers)

3/7/13		Modify Probewin.elm file to use tabs between values (does not affect Probe Image).

3/6/13		Fix CalcImage classify bug where non default features selections were not saved. (Carpenter).	
	
		Modify window size/position InitWindow code to not save if window is 
		not visible (Carpenter).
		
		Fix tool tip help in Acquisition Options.

3/5/13		Fix aspect ratio calculation in CalcImage (Pinard).
	
		Finish user specified average parameter output (Poeml).
	
		Add Move Selected elements to on-peak in Peaking Options (for PI).
	
		Add image number field to position database for drift correction feature (Wark).
	
		Disable "Do not output deviations" checkbox in Modal form if deviation fields are not 
		available (Goemann).
		
		Add output of OPTF (on-peak time fraction) parameter (Jercinovic).

3/1/13		Fix bug in CalcImageLoadSample (Carpenter).
v. 9.3.2	
		Fix EMSA spectra output confirm message.
	
		Fix minor issues in CalcImage with using MAN for off-peak elements.

2/28/13		Update CalcImage context ID help (Goemann).

2/25/13		Fix random fraction output and BMP mask output (Goemann).

		Start work on sample average output for user specified output (Poeml).
	
		Improve Penepma (08 and 12) cancel code to automatically kill Penepma background task.
	
		Fix EDS time calculation in TIME.BAS.
	
2/23/13		Add code to terminate Penepma if user clicks cancel.
	
		Fix EDS initialization and demo mode motion timeout check code.
	
		Add minimum electron energy field for Penepma binary extractions (FormPENEPMA12Random).

2/22/13		Fix splash screen on 30" monitors (Carpenter).	
	
		Fix oscillator defaults in Penepma08 (and 06) code.

2/21/13		Modify Digitize Image form (FormIMAGE) to load modeless.


2/19/13		Add call to ImageLoadPalette in CalcImageReadProbeDataFile (Goemann).
v. 9.2.9	Add EDS unknown count factor to acquisition options to allow different count time for unknowns and standards.

		Fix project palette issue in CalcImage (Goemann).

2/16/13		Fix InitLine bug in Standard (Fournelle).	
v.9.2.8
	
		Fix material file default Browse path.

2/14/13		Fix Penepma default oscillator parameters in PenepmaCreateMaterialINP (Llovet).
v. 9.2.7
		Add fix for TC card (Kuehn).

2/13/13		Modify Penepma EDS demo code.

2/12/13		Change Penepma solid angle in Demo interface to match Bruker SDD on JEOL 8530 (Pinard).
	
		Add Bragg Order to GetElmSetStd nominal interference section.
	
		Add menus to CalcImage.

2/11/13		Add fix for DataEDSElementsAdd is blank symbols passed (Kuehn).	Add output of elapsed time if negative TCReadTimerCounter.

2/10/13		Add code for specify by unknown and blank correction to CalcImage (probably no one will ever use, but it's there).

		Fix CalcImage to properly handle import of PrbImg files between different systems and files.

2/8/13		Modify init files slightly.
	
		New msi files.
	
		Improve demo counting code to use actual elapsed time.
			
2/6/13		Add new INI parameter EDSSpectraNetIntensityInterfaceType% in [hardware]. This is so the user can define the EDS net intensity
v. 9.2.3	calculation type for off-line work. This will allow acquisition with an OEM but net intensity calculations using another method,
		for example an internal peak stripping method. This internal peak stripping method will be available once the new peak stripping code is ready.

v. 9.2.2	Work on "look" of GUI.	
	
		Include EDS count time in time calculations.
	
		Increase offsets for LDEs over 100 angstroms.
	
		Fix EDS element issue (Kuehn).
	
2/4/13		Add re-sizable window for EDS spectra display in Calculation Options.

		Add "specified" EDS counttime to database fields.
	
		Add EDS display in demo mode to PFE using Penepma MC.

2/3/13		Add TOPO fix for 8530 if no AUX is present (Pinard).
v. 9.2.1	
		Announcing the new Probe for EPMA XTREME edition!  New looks and new features!
	
		EDSSpectraInterfaceType=0
		[hardware]

		for a 500 eV lower limit.  Also be sure the EDSSpectraInterfaceType is in demo mode, e.g.,
	
		PenepmaMinimumElectronEnergy=0.5
		[software] 
		
		Implement Penepma12 MC code for EDS spectra "acquisition" in demo mode. Uses actual standard compositions and random
		compositions for unknowns. Uses Convolg.exe for spectrum convolution. User can set minimum energy of calculated spectrum
		in Probewin.ini, e.g.,

		Remove Elionix interface.	
	
		Work on new demo EDS spectra acquisition using Penepma12.

2/1/13		Skip warning (GetElmCheckStdAssigns) on interfering element if present in interference standard at 
v. 9.1.9	zero concentration.

1/29/13		Fix icons for form, task bar and taskswitching.
v. 9.1.8

1/28/13		Start adding new icons for PFE apps.
v. 9.1.7
	
		Add user specified output to right click menu in Analyze! (Goemann).

		Fix Penepma processing code to handle hydrogen and helium in matrix.	
1/27/13	
	
		Beam deflection polarity fixed for 8230/8530 (Pinard).

1/26/13		Finish testing 8230/8530 for beam current set. To utilize make sure the JeolCoarseCondenserCalibrationDelay in the
v. 9.1.6	Probewin.ini file is set to 1 sec (Pinard). Requires driver 1.6.1 and the JEOLEIKSVersionNumber should be set to 5.
	
		Add new INI keywords for Surfer script output (Carpenter).
	
		New rainbow false color palette- do you like it or hate it?
	
		Add special treatment for condenser iteration for set beam current code (Pinard).
	
1/25/13		Add Excel output to CalcImage Points window.
v. 9.1.5
		Slight modification to CPQ section of the CalcImage CIP file.  If you haven't used the "correlated pixel
		quantification" (CPQ) feature, just ignore this.  If you have used it (Pinard) you will have to re-create the
		CIP file.
	
		Fix CalcImage Processing window control enables.
	
		Fix CalcZAF File menu enables.
	
		Modify open/save file dialog to use system to avoid Win 7 bug with long file names.

1/24/13		Add extract range for CalcImage based on total sum column (Carpenter).	
v. 9.1.4
		Modify CalcImage classify display.
	
		Modify Surfer BAS scripts.

1/23/13		Add debug statements to JEOL beam deflection code (8230/8530).
v. 9.1.3	
		Fix alignment of BAS output plots.

1/22/13		Fix cluster color for blanked GRD files.
v. 9.1.2	
		Fix set beam current code for 8530 (Pinard) in JeolSetBeamCurrentMDA.	

		Modify batch files.
	
		Modify version string.

1/21/13		Add automatic BAS script execution from PFE and CalcImage.	
	
		Fix aspect ratio for non-square maps in slice script and polygon extraction scripts.
	
		Add flag to CalcImage modal Surfer script BAS output to not output Dev.%" columns.
	
		Modify Recalb code to handle write locking with fail-safe code.
	
		Fix filename bug in PFE Surfer BAS output (Poeml).

1/18/13		Add debug output for JEOL set/get condenser lenses (Pinard).
v. 9.11
	
1/17/13		Work on quantmeter.

		Modify PictureSnap to save to GRD as gray scale (if not too large!).

1/16/13		Work on CalcImage.
v. 9.09
		Modify Surfer scripts to use 2048 pixel width for JPG export.
	
		Add support for "humimeters".

1/12/13		Add palette and remaining time code to CalcImage. Fix window sizing issues.
v. 9.08	
		Fix JPG export aspect ratio issues from Surfer scripter.

1/8/13		Work on CPQ MAN code.
v. 9.07

1/7/13		Complete initial testing of CPQ feature (primary and MAN std images) for (Richter).
v.9.06	
		Auto-save of palette number.

1/6/13		Add auto-saving and loading of quant images.

1/5/13		Complete work on new GRD orientation mechanism. See GRDInfo.INI file in folders containing GRD files.
v. 9.05

1/2/13		Work on new GRD orientation mechanism.

		Work on CPQ standard image intensity feature.
	
		Add CalcImage_Quant_Classify.pdf to CalcImage Help menu.

12/30/12	Add check for valid beam currents on all images in CalcImageStartAnalysis.	
	
		Add image extents to FormANALOG.

12/29/12	Work on CPQ interface in CalcImage (Pinard and Richter).
v. 9.04

12/28/12	Modify CalcImage to use absolute paths internally for image files so files from different projects 
		can be loaded at the same time.

12/26/12	Work on CalcImage CPQ feature for Pinard and Richter.

		Improve CalcImage analog signal loading and unloading.Modify New Project Wizard to automatically convert and copy analog
		signal file (_VS1 or _COMP).
		
		New help and pdfs.
	
12/22/12	Add auto store and reload classification parameters and classify results from previous classification
		in CalcImage.
	
		Add Barkman to "special users".
	
		Add SX100 error 66 (axis disabled).
	
		Work on new Hyper-Imaging feature.
	
		Edit copyright 1995-2013.


12/21/12	Modify column labels for CalcImage classify input from PFE.
v. 9.03
		Modify MoveLoadElementButtons to skip loading from ELM file if crystal is missing.

12/19/12	Add % deviation of calculated centroids to classify feature TXT output.
	
		Add automatic pre-load of on and off-peaks in CalcImage if present (and not specified as MAN in MDB file).
	
12/16/12	Start working on CalcImage modification for using correlated pixel quantification (CPQ) for
		analysis of carbon in Fe and other alloys (Richter, Pinard). This is to allow user to specify x-ray maps for 
		the standard intensities rather than the MDB file. The MDB file will still be used for define the element 
		setup.
	
12/15/12	Add code in InitWindow to check if saved window position is outside visible screen area.

		Fix XYMODAL.BAS and MODALXY.BAS for aspect ratio issues.	
	
		Fix some minor bugs in CalcImage create new project wizard. Add save analog image to GRD during PrbImg conversion.
	
		Modify polygon extraction and slice scripts for Surfer output to allow user to easily edit the GRD file to use
		for digitizing (Carpenter).
	
		Improve AvgText output in XYPOLY.BAS for Surfer output.
	
		Add #cluster/precision variation output for TXT files also (Barkman).

12/14/12	Tweak Surfer BAS code for modal presentation output.
v. 9.02

12/13/12	Add auto match and surfer plot output to CalcImage.

12/11/12	Add match capability to CalcImage Modal window.		


12/10/12	Minor bug fixes to CalcImage.
	
		Add new keywords to Probewin.ini, UserImagesDirectory, SurferPlotsPerPage in [software] section.

12/9/12 	Add PrbImg direct import to CalcImage Create New Project Wizard menu.
	
12/8/12		Add base64 decoding to CalcImage.

	
		Work on editing density and match fields in FormMODAL2 (CalcImage).
	
		Update help and pdfs.
	
		Add Penepma references to Analyze! Report button.
	
		Add automatic Save Report to TXT file.
	
		Improve MsgBoxDoEvents activate event handling of timer enable.
	
		Add option for saving cluster/tolerance variations to GRD and BMP (Barkman).

12/7/12		Improvements to CalcImage GUI.
v. 9.01		
		Add new output menu to PFE for exporting quant data for cluster classification in CalcImage (Classify Points).

12/4/12		Add "_Quant_Image_Classify" string to CalcImageOutputDataAll DAT filename.
	
		Work on Drag and drop VB6 IDE issues in CalcImage.
	
12/1/12		Continue work on modal abundance calculations in CalcImage (Carpenter).


11/31/12	Finally fix modal/modeless issue in IOMsgBox.
	
		Modify Thermo start code to handle v3 NSS.
	
		Work on arbitrary point classify feature for data from PFE (or other source).
	
		Add ability to input polygon extraction data for classify feature (Carpenter).

11/30/12	Improve CalcImage strip BAS output.

11/26/12	Fix problem with TDI and combined condition samples not initializing VolatileSelfFaradayCupOutNow.

11/25/12	Add % area and default density columns to TXT output in CalcImage in prep for modal calculations (Carpenter).
	
		Add centroid quant mask output to CalcImage.	

11/24/12	Add drag and drop capability to CalcImage for opening GRD files.	
	
		Add code to disable Acquire controls during Window menu Set Analytical Conditions.
	
		Improve faraday out time delay for AcquireDoVolatileElement (assigned TDI).
	
		Modify faraday cup out code in AcquireStartsample and AcquireStartVolatile to not remove faraday if combined conditions 
		samples. This will improve TDI correction for combined condition samples (Cathey).
	
		Work on CalcImage classify code more.
	
		Fix CalcZAF ExportAll cancel issue.
	
		Update PFE reference manual, pdfs and help.
			
		Modify CalcImage to use "NK" for cluster number column label. Add code to check on input.
	
		Modify JeolStringWriteRead2 to display string command which caused the error (Allaz).
	
11/23/12	Modify Penfluor code (Penepma12CreatePenfluorInput) to utilize PenepmaMinimumElectronEnergy (Gainsforth), 
		to automatically edit the Penfluor.in file for lower energy calculations.

		Fix Penepma12 skip P-Pr code for compounds.
	
		Fix multipoint zero issue again (force to small number) (Goemann).

11/20/12	Fix crystal flip issue for subsequent elements (caused by mod for reducing cup out time) (Kremser).

		Update PFWBETA.BAT and PFE MSI build solution.
	
		Add sample data file for classify operations.

11/18/12	Work on cluster mask output in CalcImage Classify feature.

		Update probesoftware.com web site.
	
		Work on CalcImage phase clustering code.
	
		Add code to skip matrix.mdb and boundary.mdb scan code when overvoltage is less than specified minimum (currently 1.02).

11/17/12	Add "timeout" command in update batch files to delay ZIP extraction to give applications time to unload.

		Work on Kmeans cluster code in CalcImage.

11/16/12	Fix AMB code to handle crystal flip completion check (Kremser).
	
		Add time for hysteresis set (SX100/SXFIVE only).
	
		Fix column label bug in CalcImage quant output array.

11/15/12	Add x and y stage values to quant array output in CalcImage.	
	
		Add code to preselect sample setup(s), if selected from Automate! window.
	
		Modify error trapping to allow non-pure element standard for secondary boundary fluorescence.

11/12/12	Fix stage coordinate output in PFE (CalcZAF output).
	
		Add Matrix and Remote .cnt files to msi installers.
	
		Add x and y min and max and zero place holder for kmeans cluster number in CalcImage.

		Add button to create material file from last analyzed sample in FormANALYZE.
	
		Update documentation including Matrix and Remote COM servers.
	
		HysteresisPresent=1
	
11/9/12		Add HysteresisPresent keyword to INI (SX100/SXFIVE only at the moment). Note: this
		flag is defaulted to be "false", so if SX100/SXFIVE users want the hysteresis sent after
		the beam size is set, please add the following keyword to the [hardware] section
		of your PROBEWIN.INI file:

		Add automatic ASCII output from CalcImage for all calculated quant data.
	
		Fix realtime error when modal dialog loads on modal dialog (Fournelle).	
	
		Fix tab order in FormGetCmp.
	
		Add density output to Standard log window.
	
		Fix skip TXT file option in binary extraction code.
	
		Fix Penepma minimum electron energy in help file to remove double quotes (Carpenter).
	
		Add Ca-Ge to list of problematic binaries for Penfluor.

11/7/12		Add density load to Penepma08 form when user clicks standard in list.
	
		Add more error trapping in ImportExport.bas.
	
		Add new procedure for loading stored 2 point boundary to FormSECONDARY controls. See 
		Secondary.bas.
	
		Add new secondary boundary fluorescence table to MDB file. Add DataBoundary.bas.
	
		Changes to GetElmAll.bas to allow TDI assignments to be skipped with a warning if TDI data 
		is missing.	
	
		Add Julien Allaz to technical Support page in PFE documentation.
	
		Modify Test3D.exe and Plan3D.bas to utilize subset Legendre surface fitting for secondary 
		boundary fluorescence correction calculations from Boundary.mdb file.
		
		Add "density" column label to Standard.exe single line export format.


11/2/12		Change pe-inten-01.dat to pe-intens-01.dat in Penepma08 code (for Penepma08 or Penepma12)	
v. 8.98		to match changed Penepma 2012 FORTRAN output.
	
		Add Angus Netting to SXFIVE beta testers in About dialog.
	
		Modify multi-point code to just log zero intensities to log window.
	
		Add cancel code for automation time calculation.
	
		Fix Stage Map problem if data file is closed.
	
		Fix Penepma 12 Penepma08SaveMaterial call for density update for Formula.
	
		New CalcImage help file (Goemann). Add .CNT files for PFE and CI help contents. Add to 
		CalcZAF and PFE updates and msi installers.
	
10/26/12	Update PFE Reference manual.
v. 8.97
		Fix SEI issue for 8200/8500 (Kremser).

10/22/12	Allow zero intensities for multipoint bgds when running automation (Goemann).
	
		Fix bug in change to AcquireSpecTunable and AcquireSpecTunable2 for Cathey (Goemann).
	
		Add new element variables to GetElmSave.

10/21/12	Fix Excel version check code if a version of Excel is already running (Carpenter).	
	
		Add Use Boundary Correction flag to globals and save to Run table and also add sample specific 
		flags and parameters.
	
		Add code to reduce delay with asynchronous mode for TDI (Cathey).
	
10/19/12	Modify boundary.mdb to NOT store fit coefficients (need to calculate "on the fly" 
v. 8.96		using hyperbolic subset fit- see Test3d).

10/14/12	Work on import/export.	

10/13/12	Work on import/export.	
	
		Add Bruker ShowSpectrum call.
	
		Work on import/export.

10/12/12	Fix problem with disable quant in alpha factor codes.	
	
		Add additional output for alpha factor calculations.
	
		Modify SX50 write string error messages (Fournelle).

10/10/12	Modify Standard Penepma code to avoid problematic elements until FORTRAN resolved.
v. 8.95
	
		Update documentation and help.

10/7/12		Fix 8230/8530 auto focus code issues for pre/post code.

		Add calls for 8230/8530 auto-focus EIKS routines.
	
		Add calls for read/set coarse and fine condenser lenses for 8230/8530 set bean current.

		Start work on sample import/export (Allaz).
	
		Create new updated Matrix.mdb.
	
		Modify TimeCalculate to calculate time for average of multiple analyses (FormGETTIM) or specific 
		analysis (Acquire! display) when Nth point features are utilized.
	
		Finish implementing fraction on-peak count time for Nth point acquisition (normal background and 
		multi-point) (Jercinovic and Allaz).
	
		Add additional error trapping std_int zero intensities (e.g., ca Ka in Sc) in Extract Matrix code.
	
		Fix issue with CurrentUpdateSample created by adding code for updating quickscan limits.

10/5/12		Trap zero std intensity in Penepma12Extractmatrix code (NaNs with Ca Ka in Sc).
v. 8.94	
		Add current record indicator to FormSETUP datacontrol reposition event.
	
		Add units to MAN and Evaluate plots (Poeml).
	
		Fix context ID in CalcImage save As BMP (Goemann).
	
		Modify CurrentUpdateSample to adjust quickscan ranges if out of range.

10/01/12	Fix missing line of code in SX100GetError (accidentally deleted).
v. 8.93	
		Work on implementing secondary fluorescence correction in PFE.
	
		Fix JEOL set OM light calls to use default volume if zero (Eckert).
	
		Update context IDs in PFE reference manual and CalcImage section of Probehlp.ini (Goemann).
	
		Fix TDI output menu issue if not all samples are TDI (Cathey).

9/28/12		Fix Pt La/Ma at 5 keV disable quant problem (Fournelle).
v. 8.92	
		Fix problem with loading zero "Cameca" deadtimes for SX50 (Fournelle).
	
		Fix Type Current Alphas problem.
	
9/26/12		Fix DefaultZAF loading from INI file- needed to comment out sub ZAF flag code in InitData (Fournelle).
	
		Fix double click in Analyze! data grid if user clicks on bad line or no data.
	
		Modify FormMODEL to allow Enter or <esc> to close dialog (Karen Wright).
	
		Add new PenepmaMinimumElectronEnergy="1.0" keyword to Probewin.ini file (Buse).	

9/18/12		Fix Plot! window list string issue and loading of default ZAF from INI file (Fournelle).
v. 8.91	

9/16/12		Modify Penepma12.bas in Standard to allow modeling of electron energies below 1 keV (if PAR files were generated using MSIMPA
		values below 1000 eV). (Buse)
	
		Update PFE Reference manual Help and pdf.
	
		Update Matrix.mdb file for more binary pairs.
	
		Add Karsten and Gareth to About box.
	
		Modify CalcImage to not automatically load analog signal images when using Create new Project Wizard.

9/15/12		Update scripts to confirm output and check for missing BLN file (slice scripts).
v. 8.89	
		New msi distribution files.
	
		Make browse buttons in Standard penepma more easily seen.
	
		Add reflected and transmitted light functions on 8x30 JEOL probes.
	
		Modify EIKSVersionNumber checking so tested functions are enabled with v 4 and functions to be tested are enabled
		with v 5 (edit in Probewin.ini).
	
		Fix Userwin to import without creating new user.mdb.
	
		Fix null "atime" in MiscConvertTimeToClockTime (when importing old version user.dat database fields).
	
		Gray out threshold fields if not one of ROM methods using them.
	
		Modify Standard multi-line import to handle if density field is missing from old versions.	
	
		Fix image calibration ReLoad INI to update Cal Mag display too.
	
		Change SEI channel from 2 to 1 for JEOL instruments because it doesn't work on 8230/8530 instruments.

9/14/12		Fix zaf.bks initialization in ZAFBKS for FRAME backscatter correction!
v. 8.88

9/13/12		Add Samples6 folder to MakCalcImage.bat.

9/9/12		Update CalcImage help and pdf.

		Add code to check that user assigned all on-peak images to analyzed elements in CalcImage before output. Not all analyzed elements 
		have to	be assigned to an on-peak image, but all on-peak images need to be assigned to an analyzed element.

9/7/12		"Double up" sleep delay and monitor update on check crystal flip code in RealTimeGetCrystalStatus (Perry-Carpenter).
v. 8.87

9/5/12		Fix copy GRD bug in CalcImage Create New Project Wizard code.  Fix spurious "No MAN Stds" warning in Type Sample Parameters.
	
		New msi installer (fixes issue with DAO350.dll).	

		Modify CalcImage menu order and automatically load beam current from PrbImg file (in case different from MDB).

9/4/12		Modify Sx100 hysteresis command to run after set beam size.
v. 8.86

9/1/12		Add Dim astring as String statements to Surfer scripts (version check code) (Carpenter).
v. 8.85
		Add polyxy.bas, stripxy1.bas and stripxy2.bas to update ZIPs and MSI distributions.
	
		Fix zero peak error handling for CurrentUpdateMultiPoint (Fournelle).
	
		Put Sx100 hysteresis command so it only is called if the beam size changes (Poeml).
	
		Add new polygon and strip script files to update and msi files.

8/31/12		Add Create Project Wizard menu in CalcImage.
v. 8.84

8/29/12		Add strip script generation to CalcImage. See CalcImage.zip for examples.

8/28/12		Integrate new polygon extraction scripts into CalcImage.	
	
		Allow zero integer deadtimes for Sx50 (Fournelle).
	
		RealTimeStartIntegratedCounts (Goemann).

		Add wait for motion complete for starting integrated intensity acquisition in
	
		Add Sx100 hysteresis command (v. 1.7.0 of Sx100 driver required). (Poeml)
	
		Modify IOAutomationPause and code to handle MSGBOXDOEVENTS3 and MSGBOXDOEVENTS4 forms to handle bad interface initialization 
		better (Carpenter).
		
8/23/12		Increase delay (from 40 to 500 msec) in RealTimeGetCrystalStatus before checking for new 
v. 8.83		crystal position (Perry	and Carpenter). Also add calls to refresh monitor packet for JEOL
		instruments.
	
		Fix tool tip help on FormUpdate.

8/20/12		Fix minor issues with CalcImage.

8/19/12		Move to VB6 version. Update new updates.
v. 8.82		
		Add support for JEOL driver errors codes (20 to 24). Driver version. 1.6.0.
	
		Force Add/Remove Standards to reload standard compositions in case they were edited.
	
		Allow standard samples to utilize "blank" correction (GETELM.BAS).
	
		Add VB6 update code for msi files (full update).

		Make FormREGISTER "always on top".
		
		Update makzip.bat comment to note running under admin command prompt for Win7.

8/19/12		Add new "full" update option using msi files. Add new update batch files to update ZIPs.
v. 8.81	
		Remove Setup stuff from UpdateSetup.exe. Only update VBP version.

8/15/12		Remove remaining VB Wizard stuff- using .msi files now!
	
		Remove Vista specific distributions.

8/14/12		Remove TestTyp32-e.zip from distribution. Fix typo in CalcZAFBeta.bat (modeal.dat).
	
		Modify CalcZAF alpha factor plot code for Penepma k-ratios.
	
		Add Bruker beam deflection code for beam position in BrukerImageBeamDeflection2 (Kuehn and Pinard).
	
		Modify getZAFAll form to allow user to utilize new Penepma k-ratio limit options.
	
		Add new globals UsePenepmaKratiosLimitFlag, PenepmaKratiosLimitValue and JEOLEIKSVersionNumber to Probewin.INI.
	
		Update FormSETUP for label background colors (change to Button face).
	
		Modify CalcZAF correct secondary fluorescence to load JEOL or Cameca demo image as necessary.
		
		Update sample scripts for CalcImage.ZIP.
	
		Add Sleep(200) statements to slice scripts XYSLICE2.BAS and XYSLICE.BAS.	

		Add check for 32 vs 64 bit systems and modify Surfer script output for Directory$ statement.
	
		Fix AnalyzeUpdateList to handle list getting updated (called from SetupLoadStandardIntensityFromDatabase)
	
		Increase MAXROW to 500 data lines (Poeml).

8/11/12		Add sleep call after load clipboard in ExcelSendFileToExcelSheet to avoid issue with clipboard in Win7.
v. 8.79	
		Slight change to CalcZAF | Analytical menu text.
	
8/5/12		Small tweak to Penepma12CalculateMatrix code to properly call GetElmSaveSampleOnly sort code after all elements
		have been checked for absorber only issues.
		
		Modify Windows version code in MiscSystem and BAS script creation codes in PFE and CalcImage.

7/25/12		Fix minor issues in Surfer scripts for CalcImage. Update CalcImage.ZIP samples files.

7/23/12		Fix MoveDoMotorCrystal subscript issue.

7/22/12		Work on multiple crystal flip issue (Carpenter).

		Add fit routine for boundary k-ratios.

7/21/12		Add more error message details in RealTimeGetCrystalStatus for "bad flip".
	
		Add more debug statements for Thermo TE portal init. (Perry)
	
		Add stage increment spin buttons to FormGRID for rectangular grids (Poeml).	

7/17/12		Fix "Automation Completed" timer code for processing driver TCP/IP stack. (Poeml).

7/15/12		Work on boundary MDB code and read call.

		FORTRAN scientific notation with missing "E", e.g., "1.0824-101".

		Deal with low overvoltage situations and add DVal function to handle
	
		Add code to check for reasonable k-ratios in Penepma12MatrixScanMDB.

7/12/12		Modify Standard binary extraction to allow skipping of existing .TXT files.
	
		Edit labels in Standard SF window and add copy to clipboard for CalcZAF SF image.

7/10/12		Add double check for all necessary shell transitions in Penepma extract matrix and boundary code.
	
		Add JEOL and Cameca specific demo3 files for update and distribution.

7/8/12		Minor tweak to SF GUI.
	
		Update documentation and help file.

7/7/12		CalcZAF SF correction is now working.
v. 8.78

7/6/12		Fix browse problem in CalcZAF SF code.

7/4/12		Work on secondary fluorescence GUI in CalcZAF.

		Add debug code for ROM peaking (Carpenter).

7/3/12		Work on secondary fluorescence.

7/2/12		Update makzip.bat to copy penepma files. Create new updatepenepma batch to update all.

7/2/12		New Penepma source and exe files from Llovet to fix complex composition issues, e.g., monazite (Jercinovic)).	
	
		Work on secondary fluorescence correction in CalcZAF. Add boundary correction to alpha factor method.
	
		Add debug statement for security code printout in JEOLInitInterface (Adams).

7/1/12		Modify ratemeter code to use monitor packet for JEOL 8900/8200/8500 (Perry).

6/30/12		Work on CalcZAF secondary fluorescence testing code.	
	
		Add demo3.bmp and acq to update and distribution for secondary fluorescence demo.
	
		Fix range of extraction (matrix) code to use both binary elements as emitter.

06/29/12	Work on k-ratio fitting for SF corrections.

06/26/12	Modify TestRegistration and remove catalyst smtp and email controls- not needed.	
	
		Finish CalcZAF CalculateExportAll code (Carpenter).
	
		Modify Formula and Weight dialogs to warn user about decimal points (Jercinovic).  Also retain last string 
		entered and normalize weight percents to 100% if over 110% (entering weight percent strings such as
		Fe742 Mg2980 Si1907 O4360).
	
		CalcZAF format (in PFE) to separate files for each sample.
	
		Add stage coordinates to CalcZAF export format in PFE and import format in CalcZAF.  Add option to export 
	
		Make command prompt batch files for JEOL EDS "hidden" (Carpenter) except for get spectrum and get net
		intensities which are not implemented.
	
		Work on secondary fluorescence in CalcZAF.

6/25/12		Add new file import/export options to CalcZAF for processing all data points (Carpenter).
		
		New CalcZAF and PFE distribution files.

6/23/12		Add null character to pParams structure for Bruker EDS.
	
		Start work on new routine for grid and traverse Surfer/Grapher script output of selected samples 
		from Analyze!
	
		Add doevents statements in IOUpdate.bas for log window output.
	
		Fix problem in >>Excel button where counts were not output. Add faraday units to output strings.
	
		Fix user specified bug for unassigned standard (Perry).

6/20/12		Add separate function for getting Excel version to Excel.bas. Use in OutputSaveCustomUserSpecified
v. 8.77		to only warn if using older Excel version and more than 256 columns.
		
		Work Penepma12 boundary database code.
	
		Add alpha factor calculation to K-Raws button if binary standard.
		
		Add check in TypeNewCounts if sample is a standard and standard deviation is excessive (Carpenter).
	
		Remove code Penepma12RunFanalMatrix (call was commented out in Penepma12RunFanalOutput, so was 
		not used apparently). "Measured concentration" calculations are done in Penepma12OutputKratios3.

6/16/12		Fix Penepma12ExtractBoundary code to handle "swapped" elements for binary PAR files. Yeah!
	
		Remove TestTelnet, TestJEOLTelnet, and TestJEOLRlogin apps.
	
		Disable 2nd plot option in FormPenepma08 if using Penepma12 or later.

6/15/12		Fix problem in StartWin with renamed LabelProgressBeamDeflection.
	
		Change Penepma default time to 100,000 secs. Default voltage to 15 keV. Need to edit Cu_Cha.in file.
	
		Modify IOMsgBox to use MsgBoxDoevents modal to process driver events if realtime errors.
	
		Add note to warning message about single standard for calibration curve to add zero point (Carpenter).
	
		Add units for drift intensities output.
	
		Add explanation to APF dialog.
	
6/13/12		Fix line in InitFilesUserData to handle line properly.
		
		If FileLen(PENDBASE_Path$ & "\pdfiles\pdgph29.p12") > 0 Then

		Add button to only send EDS spectra to OEM system (do not calculate net intensities).	
	
		Improve warning messages for bad x-ray lines in Penepma calculations (Penepma12RunFanal).
	
		Fix matrix calculations in Penepma12 code to load current takeoff and keV for modeling "measured 
		concentrations" in Penepma12GetParFileComposition.
	
		Increase number of boundary points to 2000.
	
		Fix CalcImage menu for msgboxes.
	
		Add boundary.mdb to distributions (and updates for now).
	
		Remove TestFid distribution (use Probewin from now on).

06/10/12	Work on adding material B densities to boundary database, etc.
	
		Add spectro acq flag for synchronous motion to Acquire window (Fournelle).
	
		Make error 1003 (JEOL) Mechanical ID a warning- not error (Adams).

06/07/12	Add binary density calculator for pure element normalized densities to FormPenepma12Binary.
	
		Add SysWOW64 folders to Remote and Matrix ZIP update files.

06/06/12	Fix issue with XLSX file save in IOGetFilename.
	
		Add debug statements to BrukerEDSSpectraGetNetIntensities.

06/05/12	Fix Copy to clipboard and Plot Output issues with Penepma12 code.
	
		Update CalcZAF source distribution.
	
		Work on mass distance and density boundary code.
	
		Update CalcImage and PFE documentation and help.
	
		Modify code to automatically detect Excel 11 versus 12 for .XLS versus .XLSX.
	
		Fix problem where Analyze list was not updated automatically after combining samples into a new 
		sample (Poeml).
	
		Fix TDI%: display issue when all counts are negative.
	
		Add flag and value for Nth Point on-peak acquisition time fraction (Jercinovic). Acquisition code
		not yet implemented.

06/02/12	Update "specialusers" holiday greeting list.

06/01/12	Modify PFWBETA.BAT and CALCZAFBETA.BAT to not include Penepma source files.
	
		Modify Probewin and CalcZAF SWT files to remove MQ and Penepma source codes. Those are now distributed
		with the PFE and Penepma source ZIPs.
	
		Add display of material A and B densities to Penepma12 plot.
	
		Turn off email notification flag once automation has finished to prevent extra messages (AcquireStop).
	
		New code checking for files in InitFilesUserData.
	
		New mass distance and density parameters for boundary intensity extraction calculations.

5/31/12		New penepma/penfluor source and executables.
v. 8.75	
		Add code to check if Penfluor.exe crashes at the beginning of its execution in Penepma12RunPenfluor by
		checking some .dat files.
		
		Update everything. Wait... NOM=600 works OK. No, something is broken in Xavier's latest Material.f

5/28/12		Change Penelope.f NOM=1000 statement back to NOM=400 because it causes problems for Material.exe. 
		Penfluor.f code.  Going back to old executables.
	
		Add display of sample parameters after bgd over-ride in CalcImage (CalcImageCorrectData).
	
		Add new Material.exe Penepma file for complex compositions (change NOM=400 to NOM=1000) in 
		Penelope.f.
	
		Add cross section scripting to CalcImage (Barkman). Add example XYSLICE.BAS to distributions.
	
		Work on secondary fluorescence boundary database code to include mass distance and other proper fields.
	
		Fix goldarn "assigned" TDI correction because someone just had to try it (Seward). Seriously,
		it works now and now includes a beam drift correction also.

05/26/12	Fix display of Email Report Interval time in AutomateConfirmSelected.	
	
		Add boundary distance fields to Boundary.mdb and other supporting code.
	
		Add messagebox for calculation of binary alphafactors.
	
05/25/12	Add call to re-calculate a-factors if necessary in AFactorListCurrentAFactors.	

		Remove doevents statements from Formula, Weight and StdComp dialogs (causes issue in Win7?) (Seward).
	
		Add display of all, empirical and Penepma 2012 calculated alpha factors to CalcZAF and PFE (Run menu).
	
		Add more error messages to Penepma08LoadPenepmaDAT file issues.
	
		Add target and actual motor position info to time-out error in SX100GetMotorStatus (Grant).
	
		Add icancelauto = False statements to calculation routines in case user canceled previous calculation.
	
		Fix extract matrix k-ratio range option for Penepma12.
	
		Penepma12: Clear graph after choosing new PAR file.
	
		Add check for read only for BIM file when writing image data in DataImageSaveImageData.
	
		Update GRIDCC.BAS to use new version check code for Surfer app (Poeml).
	
		Fix display issue for count time in TypeWaveCounts.
	
05/23/12	Add text to "State was running" error text to indicate the error may also be caused by too 
		many clients trying to connect to Bruker EDS server.
	
		Update XYSCAN and XYSCAN2 .BAS files for using CurDir$() & "\" and also new version check 
		code (XYSCAN2.BAS only). 
	
		Modify RealtimeGetMotorPositions to warn user of out of range even if demo or JEOL interface (Carpenter).
	
		Add kratio difference and relative% error to binary plot output for Penepma12 boundary calculations.
	
		Improve Penepma12 graph options.
	
		Change ZAF Selections menu to ZAF, Phi-Rho-Z, Alpha Factor and Calibration Curve Selections.

		Add check for readonly data file for opening various databases. (Eckert).

05/18/11	Modify DataEDSElementsLoadSample to use non exclusive access for reading.
v. 8.71	
		Work on secondary fluorescence boundary code.
	
		Add more status output for first time PHA delay.
	
		Add UseFilamentStandbyFlag = False to InitData call for opening new runs.
	
		Modify Penfluor simulation overhead from 65 to 75 seconds per voltage.
	
		Fix demo mode for Remote.RemoteGetMotorStatus call.
	
		Add SelectStandardDatabase menu to CalcImage to allow users to specify a non default standard database. For
		example, the standard database that comes with the samples in the CalcImage.zip file.
	
		Add "CurDir$()" function to .BAS output for PFE and CalcImage Surfer script output. This allows the scripts to run from any folder
		that the script finds itself in.
	
		Add extra error reporting and HFW fields for DataImageGetImage and ImageDisplayImageParameters (Wark).

05/05/12	Add Samples3 example quant maps to CalcImage.ZIP.
		
		Implement flag for Penepma binary calculations in Afactor code.	 Add matrix.mdb to update and dist.
	
		Work on secondary fluorescence code.
	
		Add spectro number for JeolGetCounts function to help diagnose "Maximum unit error" on 8530.
	
		Add confirmation dialog for batch binary for Penepma modeling.
	
		Add "hot" colors to anomalous data output if element is assigned as primary standard for this sample.
		
		Update password on "alternative ftp".
		
		Elements/cations dialog, have multi-point bgds "Set To Defaults" button ask "are you sure?" (Jercinovic)
		and only re-set multi-point for the specific hi/lo set in GetElmSetElmMultiPointSetDefault.
	
		Fix bug in ImageDrawRuler when double-clicking to move stage.

4/28/12		Add sample conditions to volatile (TDI) file output.	
	
		Edit Pre-install documents (split into Cameca/JEOL and JEOL 8230/8530)
	
		Update PFE and CalcImage help files.
		
		Add CalcImage files to PFE distributions.
	
		Ask user if grid file to be imported in PictureSnap is in stage units (from PFE) or mm (PI).
	
		Add IOStatus message to CalcImage when opening project file.
	
		Add distance calculator for DigitizeImage traverse feature.
	
		Add message about using Help menu to update PFE if old version.
	
		Add formatting for File Description output.
	
		Add extra time for confirm delay "overhead".
	
		Add Select button to Model (backgrounds) dialog to select all samples.

4/21/12		New Fanal source from Llovet (minor differences in calculated intensities).
	
		New distributions for CalcZAF and PFE.

		DemoImagesDirectory="C:\UserData\DemoImages"
		SurferDataDirectory="C:\UserData\SurferData"
	
		Add new folders for sample data and demo images to [software] section of PROBEWIN.INI.
	
		New user data folders for Surfer files and demo images.
	
		Fix Surfer version check in GRIDCC.BAS (Poeml).

4/19/12		Add Surfer scripting capability to CalcImage for output of quantitative x-ray maps.

4/18/12		Fix extra open dialog for creating new standard database (Kuehn).

		Add some debug statements for beam deflection to track down Poeml's issue on SX100R.
	
		Found that faraday cup insert code had been commented out in RealTimeSetConditions (not sure why). Uncommented
		it so cup is always in if setting conditions (for read beam current). (Carpenter)
	
		Remove extra insert faraday during Alignment Peak Center procedures (Carpenter).
	
		Add additional debug statements to fix problem reported by Carpenter in StartWin ROM peaking though it
		uses the same code as Probewin.
	
		Add read/set stage type/mode menus to Calibrate.exe.
		
		Fix "Skip Duplicate Points" in FormIMAGEDISPLAY when using "All Positions" option.

4/14/12		Fix CalcImage for specified elements duplicated by analyzed element for element by difference, etc.
	
		Update doc and help.
	
		Add Select All button to LOCATE form.
	
		Add Copy To Clipboard to CalcZAF histogram plot (Marinenko).
	
		Decrease time for software overhead for JEOL (Carpenter).
	
		Add check for image interface present if Axioscope interface.
	
		Add filename to error in Penepma12GetParFileComposition.  Initialize output variables for composition in same.
	
		Modify check on beam size for standard acquisition (Carpenter).
	
		Fix PeakMoveToPeaks (Seward) to first element not disabled for acquisition.
	
		Fix problem with MiscGetFileNameNoExtension when multiple "dots" are present in file name.  Doh!
	
		Add messages for update process to log window.

04/12/12	Modify GRIDCC.BAS for surfer version greater than 9 (Poeml).	
v. 8.69
		Fix Userwin to not allow creating a new USER.MDB (need to download from ftp site instead).
	
04/06/12	Fix missing line in Sx100SetConditions that forced a set beam current on every beam current different from
		initialized beam current.
	
		Add CalcImage.ZIP to upload sites. CalcImage will however be updated through the PFE update menu automatically.
	
04/05/12	Modify CalcImage for better performance, add pause feature, modify log window output, etc.
	
		Tweak CalcImage for better parameter saving.

04/04/12	Fix InitFilesUserData2 (Adams).
	
		Modify InitFilesUserdata.
	
		Modify CalcImage to fix minor bugs.

04/03/12	Add "min" buttons to Penepma windows.

		Fix PictureSnap full view window to maintain actual aspect ratio of image (Vicenzi).
	
		Update context sensitive menu help (F1 key) for Output menu.
	
		Add count time limit to JEOL 8900/8200/8500 of 2147 seconds. (Davis/Vicenzi).

03/31/12	Add manual alpha calculator to Penepm12Binary form.
	
		Add "pe-gen-bremss.dat" file copy for Penepma batch mode.
	
03/29/12	Add double check for crystal flip position in Both AcquireDoCrystalPHA and 
		MoveDoCrystalMotor (Fournelle).

03/28/12	Fix Penepma12 k-ratio extraction code (Batch dialog).


03/27/12	Work on secondary fluorescence boundary extraction code.		

		Add flag for eventually loading Penepma binary k-ratios.
	
		Add code to check for having to set the faraday current too often and warn user if so (Cameca and JEOL only).
		
		Improve behavior of Digitize grain number (now depends on state of default beam blank parameter in INI or
		Acquire | Acquisition Options).
	
03/25/12	Modify combined condition sample code for display calculation. It now handles almost all situations.
v. 8.68		except the most pathological. However, it will warn the user if the acquisition setup is not feasible before 
		actually starting the sample acquisition.

03/21/12	Fix count time display for combined conditions samples (finally!)
		
		Update reference manual for Penepma secondary fluorescence calculations and make new help and distribution
		ZIPs for FTP password change.

03/18/12	Work on secondary boundary fluorescence code.
	
		Modify Penepma08AdjustEABS code to set minimum electron energy to equal minimum photon energy since Penepma
		makes them equal anyway.
	
		Try new Time.bas calculate code for combined conditions.
	
		Increase overhead for time calculations.
	
		Add code for "de-contamination" time for carbon analyses (Richter).
	
		Add draw ruler code for FormImageDisplay and micron distance calculation (change stage move to double-click).
	
		Add code for debug of motor timeout.
	
		Add check for flag AutomateConfirmFlag for time estimation code.
	
		Add beam conditions to volatile TDI plot in Run menu.
	
		Modify TDI (volatile) output to also output log intensity.

03/17/12	Fix problem with binary Penfluor/Fanal calculations from compounds.
v. 8.67	
		Modify backup batch files for source code.

03/11/12	Minor tweak to Penepma08/12 code (note bug in Penepma12 regarding reading of MSIMPA EABS values).
	
		Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Implement homogeneity output (Carpenter).
	
		Re-compile help.

03/10/12	Tweak Load File setup code to display progress.
	
		Continue work on Penepma12 secondary fluorescence and matrix work.

		Add liquid and solid density table DENSITY2.DAT for calculation of approx. densities for compounds.	
	
		Fix AutoGetNextSample to skip multiple setups if not actually acquiring data.
	
		Fix .ELM file output so instrument deadtime is output if SX50 or Sx100 instrument (Gaynor).
	
		Fix image shift control disable if data present in FormGETCOND.
	
		Add slight more delay in SX100SetImageShift before setting image shift if turning on scan.

03/03/12	Add motor to procedure name in SX100MOveMotor errors.
	
		Improve Penepma08/12 GUI and add thin film model geometry.

2/28/12		Disable PictureSnap calibration if bad calibration (Carpenter)			

2/27/12		Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Use Penepma atomic weights (pdcompos.p08) for Penepma calculations for self consistency.

2/25/12		Do not move to start acquisition position in FormPEAK if element is disabled for acquisition (Seward).
	
		Improve Penepma08/12 batch file methods for binary compositions.

		Skip InitWavescanGraph call if disable acquire in AcquireDoWavescan.
	
2/22/12		Fix problem with multi-point backgrounds and disable acquire flag (Seward).
	
		Modify off-peak warning (Carpenter).
	
		Add Penepma12Binary form to CalcZAF source zip.

2/18/12		Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Add tooltip help for TDI controls in SETSTD form.
	
		Fix Penepma08/12 code for better operation of Penepma simulations.

2/15/12		Add call to AcquireLoadBeamDeflection in MoveReturnToPeak after	setting 1st pass conditions.
	
		Fix problem with UserAggregateIntensity and DIFF: printout.

02/14/12	Fix problem with setting beamsize to zero in Cond2Save and GetElmSave.

02/10/12	Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Fix call to RealTimeGetStageMotors in MoveStageMapUpdate for SX50/51 (Gunning).

02/08/12	Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Continue work on Penepma12 secondary fluorescence and matrix work.
	
		Modify rectangular grid code to be more accurate and self-consistent on the number of estimated points.

02/06/12	Increase number of points to grid and output (Holler).	
	
		Change multi-point background counting time default to 1/2 of normal background counting time.
	
02/04/12	Modify FormulaSaveFormula and FormulaSaveWeight to leave set number as zero to avoid extra output
		in CalcZAF and Standard.

		Continue work on Penepma12 secondary fluorescence and matrix work.
		
		Modify StageMap to check current stage positions.
		
		Fix bug in Standard.exe when closing and re-opening database.
	
		Modify how default multipoint background counting times are calculated to just use normal Hi and Lo count times (Allaz). Update
		documentation.

02/03/12	Add call to MoveReturnToPeak in Acquire start routines in case current sample is using a different 
v. 8.65		sample setup (Allaz). This means that the acquisition now always starts at the on-peak positions for the current sample.

02/01/12	Fix alpha factor calculation bug!  (in ZAFAFactor caused by consolidation of binary concentration arrays with Penepma)

01/31/12	Continue work on Penepma12 secondary fluorescence and matrix work (also added Copy to Clipboard button).

01/30/12	Continue work on Penepma12 secondary fluorescence and matrix work.

		Continue work on Penepma12 secondary fluorescence and matrix work.
	
01/28/12	Add CalcZAF update menu.

01/22/12	Continue work on secondary fluorescence codes.

01/21/12	Continue work on secondary fluorescence codes.
	
		Add flexible open for DataGetMDBLine and DataVolatileGetData routines (Seward).
	
		Put "always on top flag" in activate event for FormSELECT for manual peaking (Carpenter).

01/20/12	Happy birthday to me!

01/16/12	Work on secondary fluorescence code.

		Modify Fanal.f for exponential distance grid calculations.

01/15/12	Work on secondary fluorescence code, create PenPFE.exe to run random fluorescence calculations.
	
		Work on secondary fluorescence code.
	
01/14/12	Add new version of Penfluor and Fitall to distributions and updates.
	
		Work on secondary fluorescence code.

01/10/12	Tweak coating correction (Weaver).
	
		Work on secondary fluorescence code (Standard.exe).
	
		Modify ZIP files to store more complete files and sub-folders.
	
01/08/12	Modify InitFilesUserData to update Fanal modified FORTRAN files for Penepma12.
	
		Modify sample .POS files for TestFid.exe.
	
		Update copyright notices and documentation.

01/07/12	Modify Fanal.f to output all parameters for boundary fluorescence calculations.
v. 8.64
		Create new timed MsgBox form with OK "only".
	
		Fix JEOL condenser beam current value check for reading PROBEWIN.INI (Rowe)

01/03/12	Fix ChemAge output bugs for normal output (Allaz).
	
		Add warning to log window if driver logging level is greater than zero (Allaz).
	
		Work on allowing zero multi-point backgrounds on one side of peak (Allaz).
	
		Fix minor bugs in Penepma12 GUI.

12/31/11	Fix ChemAge error trapping if calculating file output (Allaz).
	
12/30/11		Work on Penepma12 GUI. Add calculate and extract k-ratio codes for matrix and boundary fluorescence
		calculations.
	
		New CalcZAF distributions.
	
		Add warning for large image shift for JEOL (Carpenter).
		
		Make max mag for Sx100 and JEOL to 800Kx.
		
12/26/11	Make default sample density in PFE to 5.	

		Fix Evaluate program for fast quant changes.

12/19/11	Fix coarse condenser lens ranges for 8500 (Rowe and Hellebrand).
	
		Add sample density field to name/description dialog.
	
		Modify Confirm form to update StageMap form if visible.
	
		Modify condenser lens calibration code to save INI file comments and add "last modified" time and date (Carpenter).
	
		Work on secondary fluorescence k-ratio extract code.
	
		Fix display issue for count times for standards if using UnknownCountTimeForInterferenceStandardFlag.

12/17/11	Fix average Z output for Standard (Carpenter).
v. 8.63	
		Fix Remote FormMAIN UnLoad event to save window position and size (Carpenter).
	
		Fix zero mag warning for Sx50.
	
		Fix Penepma12 binary code to indicate current simulation number.
	
12/13/11	Fix fine condenser check for condenser beam current calibration (Carpenter). Add code to
		handle selected aperture even if it is not saved.
	
		Tweak Penepma12 GUI code for binary elements.

		See Window | Analytical Conditions menu and new Calibrate Set Beam Current button.
12/12/11	Add button to perform condenser lens calibration for JEOL instruments and automatically update the INI file.
		
		Modify RealTimeFaraday code to allow for blank/unblank without faraday delay, for moving the
		stage for example without extra delays (Adams).

12/10/11	Work on Penepma12 fluorescence code more.

12/7/11		Tweak Fanal execute string for spaces in FanalInputFile string. (Severin)
	
		Fix InstrumentAcknowledgementString in sample INI files.

12/6/11		Fix Penepma codes to run properly even if user data folder is on a different drive (Severin).

		Add mass thickness output to Penepma12 Penfluor/Fanal output files.
	
		Add keyword "InstrumentAcknowledgementString" to INI file [general] section for Report button.

12/03/11	Add check for beam deflection acquisition and probe column conditions to Acquire Start Sample.

12/01/11	Fix PenepmaBrowseParameterFile copy code.
	
		Fix JEOL get image shift code (Carpenter).

11/29/11	Work on Penepma12 fluorescence interface.	

11/27/11	Work on Penepma12 fluorescence interface.	
	
		Make new CalcZAF and Probe for EPMA distributions.  (and new PENEPMA12.ZIP)
	
		Fix Penfluor "apparent" concentration calculation and add output to Excel and graph zoom and mouse cursor.
11/17/11	
	
11/26/11	First implementation of Penfluor secondary boundary fluorescence code (Llovet and Salvat). See
		Standard.exe Analytical menu.
	
		Update tooltip help for User Specified Output dialog.

11/16/11	Fix display issue for count times in TypeSampleSetup if UseUnknownCountTimeForInterferenceStandardFlag is
v. 8.62		used for data acquisition. Add sample level flag for storing state of flag.

11/13/11	Finish user specified output code.	
	
		Update documentation and help file.
	
		Add right click menu to FormAutomate to edit position sample name.
	
		Add a number of output options to "user specified" output including average atomic number (zbar). (Carpenter)

		Add output to Standard.exe for standard numbers, names and zbars. (Carpenter)
	
		Fix standard "PUBL:" display issue with duplicate elements and disable quant flag.

11/12/11	Modify ProbFormOpenOldFile to only display warning if over 500 samples and realtime. (Carpenter)
v. 8.61		hi and lo off-peak interference calculations without closing dialog first (Carpenter).

		Fix problem with adding analyzed element after a non-analyzed element and the element order changed and using
	
		Print out of range mag values in RealTimeGetMagnification (for troubleshooting v. 1.4.x JEOL driver).
	
		Prevent user from editing PHA parameters if current sample has data even though the code will properly handle
		it by only updating the Current table in GetPHASave (less confusing that way).
	
11/06/11	Add constant for JEOL spectro low limit jog. Check user editing of spectro position in GetElmSetElmSave
		and for wavescan also (PlotDoGraph). And also in GetPeakSetPeakSave. (Carpenter and Wark)

10/31/11	Add verbose mode output for monitor magnification for possible 8900 mag issue. (Bullock).
	
		Fix stage/sepc software backlash. Add in time estimate for stage/spec software backlash. (Goemann)

		Make y get image shift polarity equivalent to set image shift polarity.	
	
		Fix Do Not Set Conditions During Acquisition to include mag, image shift and beam modes. (Goemann)
	
		Remove JEOL 7000 interface code.
		
		Fix Automate! disable control bug when moving stage and position sample option is changed. Fix FormPOSITION
		issue with position not being saved properly.
	
		Change image shift variables to float for sub micron precision on SX100. (Goemann) New float data fields
		will be created when a new probe data file is created. The existing POSITION.MDB file should be exported,
		deleted and a new file created when restarting the program to create the new float data fields. (Goemann)

10/29/11	Add output of averages only to text file and Excel for "Use All Matrix Corrections".
v. 8.59
	
		Add grid reload after Locate and Position Go commands.

10/24/11	Sorry! Fixed Fast Quant bug introduced in v. 8.58.
	
		Fix "hours" field in Count Times.
	
		Fix auto analyze issues (only unknown samples were being "auto analyzed" during automation) (Goemann).
	
		Fix Position window position grid reload on "Go".
	
		Modify AutomateUpdateForm to set enables for checkbox items. (Weaver)

		Modify UpdateAnalyze code to recalculate all std kfacs if using fast quant for "Use All Matrix Corrections" 
		option in Probewin. (Carpenter)
	
10/21/11	Fix problem with empty crystal string in SCALERS.DAT. Add warning and trap in GetElmSetElmSave. (Carpenter)

10/17/11	Update 00INDEX.TXT file (with distribution files)

10/6/11		Fix output of combined conditions arrays if printing analyzed and specified elements on same line.

		Fix missing crystal info in defaults CRYSTALS.DAT file.
	
		Add check for file found in MiscGetFileVersionData 9for driver DLL version).
	
		Add check for proper signal selection bits from IDMR command (8230/8530) to deal with JEOL "comparison mode".

10/3/11		Tweak JeolRset code. 

		Add debug display for 8230/8530 image mask bits from IDMR command.

10/2/11		Add reset for "Current" table update flag when closing probe file.
	
		Update EIKS .reg file.
	
		Modify and update Remote, Matrix and CalcZAF install scripts.
	
		Fix typo in UserSpecifiedOutputPercentError in InitINISoftware (Carpenter).
	
		Update help file to for aggregate and beam current averaging (Carpenter).
	
9/29/11		Modify FileInfoGetVersion to provide more information (Carpenter).
	
		Modify scan coefficient to utilize isize * 15 calculation in JeolImageGetIMBM function.
	
		Change FormKIOSK to NOT use transparent background color for form. Comment out call to KioskSetTransparent
		in FormMAIN menu. Modify FormKIOSK for beam conditions.
	
		J8K_SetClCoarse function or the direction TCP/IP (or a high level EIKS set beam current function).

		Disable set beam current code in JEOLSetConditions for 8230/8530 until JEOL provides a fix for the EIKS based

9/20/11		Add DAO350.DLL to PFE distribution for data control compatibility.
v. 8.57
		Fix error in ConvertSigmaIntensityKratio2 when "aggregate intensity" feature is used for
		error bar plots (Carpenter). Modify function PlotGetErrorData to check for duplicate elements.
	
		Increase Sx100 time estimate.

9/19/11		Work on Kiosk display.
	
		Fix Y shift in FormGRAPH (Carpenter).

9/12/11		Fix redraw grid issue in Specified Concentrations.

9/7/11		Fix bug in JEOL imaging (JeolImageGetScan) introduced when dealing with ImageYBeamPolarity.

9/6/11		Remove check for ImageYBeamPolarity in JeolInitInterface. Force .JEOLSecurityNumber to zero if
		not 8230/8530.
	
		Add CalcZAF source ZIP to MAKZIP.BAT.
	
		Modify email notification code.
	
		Completion of 8230/8530 imaging (Probe for EPMA) and x-ray mapping (Probe Image).
	
		Fix problem with saving previously acquired image. Use new procedure DigitizeImageSaveImagePrevious.
		(Carpenter).

9/02/11		Fix problem with "fast Quant" if standard is not assigned to any element.
v. 8.56
		Fix tooltip help in Integrated Intensities dialog.
	
		Add plotting of background fit for integrated intensities in Run menu (sorry, but this is really cool!).
	
		Fix tooltip help for empirical APFs in Analysis Options.
	
		Assume 50% factor for integrated intensity time estimates.
	
		Set enable for UseOnlyDigitizedStandardPositionsFlag in GetOptSave for Automate! window.
	
		Update help file and documentation.	

8/26/11		Add new parameters for APF renormalization and save to probe data files.
v. 8.55
		Add calculated Michel-Levy bi-refringence chart to Coat.exe.
	
		Change JEOL driver warning to only check for 1.3.1 if not 8230/8530.
	
		Fix Startwin stage traverse feature. (Carpenter).
	
		Fix StartWin acquire PHA to avoid calling RealTimeGetCounts after it has received count data (move Doevents
		statement) (Carpenter).
	
		Improve UpdateChangedSample function code to use sample structure instead of explicit static variables.
	
		Modify integrated intensity initial and minimum step sizes out of range warnings. (Carpenter)
	
		Disable Standard Points To Acquire field in Auto mate! if UseOnlyDigitizedStandardPositionsFlag is true.

		Update FAQ.

8/20/11		Fix minor bugs in Drift.exe (Carpenter).
v. 8.54	
		Adjust controls in Elements/Cations dialog.
	
		Add debug statements to Automate! "Number of Standard Points to Acquire" feature.
		
		Add debug statements to aggregate intensity code DataCorrectDataAggregate (Carpenter).
	
		Fix ROM scan issue with new 1.4.0 JEOl driver for 8230/8530 instruments (Ryerson).
	
		Make SX50/100 hardware time slightly longer.

8/13/11		Modify PFE UseAllMatrixCorrections code so it can also be used by CalcZAF. Add calculate all matrix corrections
		feature to CalcZAF (Armstrong).
	
		Modify JeolGetError to handle maximum unit errors without stopping run.
	
		Move some taskstep counters closer to call RealTimeGetCounts in Acquire.bas.
	
		Modify RealTimeGetCounts to avoid calling J8K_ReadCounter function after completion.
	
		Fix display issue for detection limits (t-test) when using aggregate intensities (Carpenter).

8/3/11		Modify Standard.exe to support drag and drop of standard database.
	
8/1/11		Fix display issue bug in VolatileDataPlotData and VolatileCalculateFit/Self/Self2.
		
		Add JEOL driver version check to JeolInitInterface and JeolROMWaitScan.

7/30/11		Update remote automation Excel macro sample spreadsheets. Improve comments and error trapping.
	
		Save virtual standards after they are loaded.	
	
		Disable formula options if not checked in Calculation Options.
	
		Modify PC format (Carpenter).
		
		Add disable quant and disable acq flag check to UpdateChangedSample.
	
		Moved DoEvents statements in RealTimeGetPHADistibution2 and RealTimeGetPHADistibution2 to before call to
		RealTimeGetCounts to avoid re-entrant problems calling J8K_ReadCounter for the 8230/8530.

7/29/11		Significant work on 8230/8530 interface.
v. 8.52
		Add Do Not Use Fast Quant" option in Analytical | Analysis Options menu (just in case!).

7/20/11		Fix fast quant problem with specified oxygen and also formula calculations involving oxygen. (Rowe)
v. 8.51	
		Work on auto focus using ILOD command for 8x30 instruments.
	
		Fix issue with demo ROM peaking alignment on coarse and 2nd fine scans.
	
		Fix AnalyzeSingle to save analysis structure from blank calculation for re-use in quant routines (needed because
		arrays are only re-calculated when sample setup changes).
	
7/18/11		Implement a method for setting spot mode for the 8230/850 by simply setting magnification very high (for spot) 
		and restoring it to the last mag (other than the spot mag) for scan mode. Just a temp fix. until JEOL provides 
		updated EIKS.
	
		Work more on 8230/8530 imaging code.
	
7/16/11		Modify subroutine UpdateAnalyze to only re-calculate std k-factors if the sample setup changes. This dramatically
v. 8.50		speeds up the analysis of subsequent data points but could theoretically cause a bad analysis if 
		the UpdateChangedSample() function doesn't catch a critical changed sample parameter (Goodwin).
	
		Add doevents code to help VB Data control refresh under Windows 7 (SetupAddToDatabase and SetupDeleteRecord 
		subroutines)	
	
		Fix database open issue for DataVolatileSendData if file is locked.
	
		Work on 8530 imaging code and column condition structures.
	
		Add check for SX100 set image shift and skip if already set. Also increase delay to 0.3 sec after change to scan mode.

7/14/11		Fix Proza 91 matrix correction code (Carpenter)
	
		Work on UpdateSetup.exe to update version number and VB5 compile batch file (PFE_Compile.bat in C:\Program Files\
		DevStudio\VB folder).
	
		Add DAO 3.5 support files to distribution SWT files (needed for some systems for VB Data control).
	
		Add code for ROM scanning and imaging for 8230/8530.

7/9/11		Add code for coarse and fine condenser lens calls for 8230/8530. Implement for JeolSetBeamCurrentMDA.
v. 8.49	
		Move "n.a." string over. Add Cameca error 117 to Sx100GetErrorText.
	
		Add scanning/imaging prototypes.
	
7/6/11		Disable JEOLGetConditions (J8K_ReadSize function) for now. Implement J8K_Command8X30 function for setting
		the beam size.

		Modify CalcZAF temperature calculation so diamond thermal conductivity is OK.
	
		Do not warn if scan mode and analytical mag is 50,000x or greater.
	
		Print assigned standard %VAR and DIFF in "()" if the element is the assigned element for this standard.
	
		Print "---" for %VAR and DIFF: if standard percent is "not analyzed".
	
		Use blue font on TypeNewCounts average and std dev.
	
		Update documentation and help files.
	
		Add "present" flag for reflected/transmitted light hardware. Add enables for light optics and auto brightness/contrast
		to StageMap window.

7/3/11		Add code for 8530 specific issues. Add code for setting driver logging level menu from INI file.	
	
		Add warning about trying to set image shift below 1095x on Sx100.
	
		Modify RealTimeCheckBacklash to improve performance (Poeml).

6/20/11		Modify SX100SetImageShift to use pure image shift.  Modify SX100SetColumnConditions code also (Goemann and Poeml).
	
		Add volatile intensity errors bars to Std Assignments TDI display (Fournelle).
	
		Add additional set beam conditions base time.
	
		Add delay in SX100SetImageShift to add short delay before reading beam mode (to prevent rare fix mode error).
		
6/18/11		Modify AnalyzeCombinedSamples (move check datarows code to AnalyzeCombined2).	
	
		Add warning if old Sx100 driver.

6/15/11		Move image shift set to after set analytical mag.	
	
		Add module level variable for Do Not Plot Analyzed Element checkbox in FormGRAPH for wavescans.
	
		Add rotation (and better mag read) for Sx100GetColumnParameters function.
	
		Add test for SX100 driver DLL version before calling set image shift function.
	
		Modify SX100SetColumnConditions to use either beam deflection or image shift.
	
		Modify SX100SeiImageShift to use beam deflection if spot mode.

6/14/11		Modify Sx100ImageBeamDeflection to check for spot mode if setting digital mode.
	
		Add preliminary code for SX100 set image shift (commented out for now).
	
		Fix size/shape of LabelDescription field in FormANALYZE2.
	
		Add STDS: output line for oxide results.

6/13/11		Add code for reading SX100 image shift using Center_X and center_Y values from scan status structure and
		saving to PCC file.

		Add a "Do not plot currently selected analyzed element" checkbox for the Plot Graph window for wavescans.
	
		Add flag for "Do not scale KLM markers" in INI file.
	
		Add check for saving image before starting new image acquisition.
	
		Add additional suggestions for spurious spectrometer not in crystal change position warning.
	
		Fix AGGR: printout.
	
		Add scroll bars to Load File setup dialog name and description text fields.
	
		Fix missing " WT%" string in HW output for oxides.

6/12/11		Add color (dark blue) to average, published log window intensity and wt% results.	
	
		If automated acquisition, make warning on different backgrounds for standards and unknown a timed message box (Seward).
	
		Modify NewUpdateSample to not zero out TDI flags if running automated samples and using sample setups. This
		means that TDI assignments can be automated using sample setups (H. Wright).
	
		Add printout of sample parameters after updating off-peaks in Plot! if sample is unknown and has no data.

6/8/11		Add std or unk number to List Anomalous Data menu. Add "Do Not Output to Log Window" checkbox in Analyze!
	
		Add font highlight and shorten time interval in PictureSnap calibration (Carpenter).
	
		Add new menu in Run menu for printing out standard or unknown intensities that are greater than 4 sigma from the average.
	
		Fix problem where 2nd point of automated acquisition gets set to analog scan. Caused by Imaging window getting
		left open.
	
		Add right click menu to Automate! to toggle digitized auto focus flag on selected positions (Spratt).

6/4/11		Fix code for when loading standard intensities using Load File Setup and standard contains TDI intensities.	
	
		Fix Combine the Selected Samples into a New Sample button if they contain different conditions (Seward).
		
		Make Stage.exe re-sizable, add some color to Digitize buttons.
	
		If user restores beam then set UseFilamentStandbyFlag global to false.
	
		Add std assignment printout to TypeSampleSetup.
		
		Fix enables on acquisition order and EDS if combined condition samples in Acquisition Options dialog.
	
6/2/11		Fix GetElmSetElmSave when integrated intensity is out of range (modify text field values
		appropriately using 1.01 and 0.99 scaling factors to avoid rounding errors).
	
		Fix demo bug when using TDI correction and peaking/PHA spectrometers.
	
		Modify default folder for viewing PCC files.
	
		Modify GRIDCC.BAS so that Surfer 8 and above utilize new app folder for color scale files.
	
5/30/11		Create default empty setup and user MDB databases for distribution ZIP files. These are required because
		the DAO 3.6 databases cannot be read by the default VB5 data control. This will be fixed when using the
		new DAO 3.6 in VB6 for Windows 7. Edited SWT files for Probewin and CalcZAF. Make new distribution ZIPs.
	
		Tweak 8900 hardware overhead (Adams).

5/6/11		Make integrated min and max values global constants in GetElmSetElm and CurrentCheckRealTime (Carpenter).
	
		Improve wavescan efficiency by removing extra exit sub statements for faraday cup acquisition (Carpenter). Modify 
		software overhead calculation slightly.
	
		Add debug call for motion completed.
	
		Fix debug call in JeolMoveMotor for dpos printout (Carpenter).
	
		Make calls to RealTimeGetVelocity and RealTimeOperatingMode conditional on InterfaceType.

5/4/11		Add module level variable for maintaining Beam Deflection/Move Stage button default in Imaging window (Weber).
	
		Tweak wavescan hardware overhead for 8900 (Adams)
	
		Add check for instrument on exit and if beam deflection is zero then do not set beam deflection to 
		zero (Carpenter). See new procedure RealTimeBeamCenterCheck.
	
		Add background intensity data graphics to Display Integrated Intensities dialog.
	
05/02/11	Add printout of hi and lo off-peak intensity data for integrated intensity measurements since
		that is utilized for background correction.
	
		Modify Display Integrated Intensity dialog (Run menu) to display integrated peak and integrated bgd intensities.
	
		Intensities menu and Analytical | Analysis Options menu).

		Add Savitsky-Golay smoothing option to Integrated Intensity calculations (see Run | Display Integrated 
	
		Make default pre and post acquire strings for JEOL 8900 loaded from PROBEWIN.INI to be nullstrings since
		PB OFF and OPB ON can cause a shift in beam current on some JEOL 8900 instruments (Adams).
	
4/30/11		Modify call to JeolGetSGSPMode to pass desired SGSP mode for 8900 which can only sense SGSP ON/OFF versus
v. 8.48		the 8200/8500 which can return SGSP SCAN/SPOT/SGSP.

4/29/11		Modify JEOL hardware overhead time estimate based on measurement by Carpenter.
		
		Fix bug in CurrentUpdateSample where multi-point bgd was getting set by default for wavescans accidently.
	
4/26/11		Fix premature status bug in Cameca firmware by ignoring ROM scan completions until at least 80% of scan is complete
		in SX100ROMWaitScan procedure. Only a problem for SX100 instruments scanning from high to low.

4/24/11		Add separate calculation for confirm "only" time when performing automated acquisitions.
	
		Add additional debug statements to Sx100 SetConditions code.
	
4/23/11		Modify Combine Selected Samples in Analyze! to add unanalyzed elements as specified elements if all selected 
		samples are the same standard number. This is slightly cool if I do say so myself.
	
		Modify GRIDCC.BAS to handle new folder location for colorscale files in Surfer 10 and higher.

4/22/11		Modify labels for y axis in TDI plots to reflect proper units (Poeml).

		Improve Search.exe for better output. Replace "True" parameters with dbReadOnly in Opendatabase statements
		to improve speed. Wow!
	
4/18/11		Fix problem in PROBEWIN.INI if UserDataDirectory keyword is a null string (""). Modify sample IBNI files 
		to not have a null string for UserDataDirectory.
	
		Fix command line argument code to handle not only MDB file double click but also drag and drop of MDB file.
	
		Change nonexclusive database writes using dbOpenTable flag to dbOpenSnapshot to improve speed.
	
		Adjust current sample type printout in Acquire! based on integrated intensity and ROM flag.

4/17/11		Fix typo in documentation on MACFileType keyword in [software] section.
	
		Add default PositionPCCFileDirectory and CalcZAFDATDirectory in INI files and set default to 
		C:\UserData\PositionPCCData and CalcZAFDATData folders.
	
4/16/11		Fix bug that was displaying a wavescan window for integrated intensity acquisition even if using ROM 
		scan acquisition.
	
		Update Matrix and Remote manuals and help files.
	
		Fix problem in DataEDS where version 6.08 is too old for reading EDS element table.
	
4/13/11		Make CalcZAF data folder for sample calcZAF files (Carpenter). Fix binary calculation std
		assignment bug (need to force std number to MAXINTEGER so k-rat gets loaded properly).
	
		Add wavescan display for integrated intensity acquisition (non ROM scan).	

		Rename Jeol to JEOL in user output strings.

4/9/11		Add additional tweaks to integrated intensity scan code (RealTimeIntegrated.bas).
	
		Add check that crystal flipped properly in RealTimeGetCrystalStatus.
	
		Make displayed elapsed time go negative if past estimated time in Automate! window.
	
		Update Reference Manual for calculating APF ratios.

4/5/11		Add call to IOStatusAuto to show "Column: Ready" and Beep after setting analytical or column conditions.
	
		Add atomic percent output for "Use All Matrix Corrections" option if specified.

4/1/11		Modify Excel code to utilize common basis filename for saving spreadsheets.

3/30/11		Modify Model background code to use on-peak position for peak intensity calculation and no
		peak fitting and to use	fitted centroid position for peak intensity if using peak fitting.
	
		Save imaging mag to empty sample if beam is manually deflected before starting acquisition.
	
		Fix bug in AcquireUpdateSampleprogressStart (Fournelle) if first spectrometer is not used.
	
		Close windows that save position from activate event before calling IOCleanWindowPositionFile.

3/29/11		Add "Click File | New or Open..." message to ProbFormCloseFile procedure.
	
		Update FFAST table based on new calculations by Nicholas Ritchie (NIST).

3/26/11		Modify Acquire! beam display to correctly display conditions when using column conditions. Also 
		required changes to RealTimeSetConditions code to update globals.
	
		Enable image shift controls for TestType (and PFE) if SX100.
	
		Add checkbox in FormGRAPH to not re-scale KLM markers when rescaling graph (Carpenter).
	
		Tweak time estimate code again.

3/22/11		Add image shift capability to SX100 (using beam deflection parameters).
	
3/20/11		Removed Penepma08 (MakPenepma.bat) ZIP call from batch file MakZIP.bat (to save time as it isn't 
		usually updated all the time). Move MakPenepma.bat to C:\Penepma08 folder.
	
		Add calls to RealTimeCenterBeam when using beam deflection after acquisition and starting 
		automation. Also when closing program Probe for EPMA.
	
		Fix bug in FormSETUP when saving setups to SETUP2.MDB and SETUP3.MDB.
	
		Make sure all dbSnapshot database calls are non-exclusive and read-only (to improve speed).
	
		Improve demo motion simulation and ROM scanning for improved accuracy.
	
		Work time estimate code.

3/19/11		Update About dialog.

3/17/11		Adjust time estimate code (don't even think about sayin' it...)

		Modify code check for negative interference to use raw k-ratio instead of raw counts (Carpenter).
	
		Adjust time estimate code.

3/16/11		Add parameters for MAN parameter printout.
v. 8.47	
		Add Move to Beam Center button in Position window.
		
		Add new "fudge factor" parameter to [hardware] section of PROBEWIN.INI to allow user to tweak
		the time estimation to their desire (Fournelle).
	
		Add calls to re-center beam if using beam deflection in AcquireStop and StagFormStop. Add call
		to re-center beam in FormMAIN QueryUnLoad events.

3/15/11		Work on time estimation code.

3/14/11		Fix beam deflection confirm for Stage.exe.	
		
		Fix output for count time in TypeCounts.
	
		Adjust Sx100 hardware overhead factor from 1.3 to 1.5. Wavescans and sample time estimates 
		are accurate to less then 5%. Modify Time.bas to include PHA bias delay for Return to OnPeak
		time. In AutomateConfirmSelected2, track keV and add in time for setting keV if using Multiple
		Condition samples.

3/12/11		Fix problems in AcquireDoAutomateNext and AutomateUpdatePositionSample for UseBeamDeflection 
		flag. Code now performs	actual beam deflection using ComfirmAllPositionsInSample flag 
		during the position confirm actions.

3/8/11		Modify AutomateImportPositions so BeamCenter is updated with each point for all samples.
	
		Modify strings for messagebox in AnalyzeCombined2.
	
		Tweak SX50 and Sx100 hardware overhead values which matters for samples with many points using
		short count times (e.g., 300 wavescan points at 1.5 secs each) in TimeCalculate. 

3/4/11		Add automation overhead parameter in automation time estimate (AutomateConfirmSelected2)
	
		Add button to combine selected sample and write them to the probe database (Poeml).
	
		Adjust time estimate for wavescans (Allaz).
	
		Fix Pb from Th/U column label typos. Change "Chemical Age" to "EPMA Age" (Allaz). Add check for
		U, Th and Pb channels for disable quant flag (in AnalyzeTypeChemAgeDataString).

3/3/11		Fix exclusive database errors in SetupGetTotalRecords and UserFormcalculateUsage due to new 
		DAO 3.60 Access 2000 engine.
	
		Update documentation and make new distributions.
	
		Modify StandardImportCameca to use default Cameca sx.mdb standard database automatically 
		since DAO 3.6 supports Access 2000 database format. Also Stage for Cameca standard
		import from PeakSight.

		Add support for DAO 3.6 Access 2000 libraries to all apps. Note these new DAO 3.6
		apps will run fine using old installations. There is no need to re-install anything.

2/23/11		Add ROM scan support for integrated intensity acquisition (Goemann).
	
		Work on JEOL 8230/8530 code.
	
		Tweak estimated time calculation for automation again (Carpenter). Add "confirm time" to
		estimated time calculation.
	
2/19/11		Add ForceSetPHAParameters keyword to [software] section to force setting of PHA 
		parameters (Severin).
	
		Document new specify concentrations options including new specify by text file option 
		(Lowers).
	
		Document U, Th, Pb age calculations (Allaz).
	
		Add code for JEOL 8230/8530 interface.

2/12/11		Increase Sx100 hardware overhead for time estimation.	
	
		Fix display issue for large offsets in FormGetPeak (GetPeakLoadList).
	
		Add zoom capability to MAN plots (Fournelle).

		Fix estimated time calculation for MAN samples.

2/8/11		Fix bug in U, Th, Pb Excel output (Missing tab).	
	
		Work on specified concentration input from Excel (Lowers).
	
		Work on U, Pb, Th Excel output (Allaz and Jercinovic).
	
		Fix Drift.exe SQLQ bug (Wark).
	
		Reduce hardware overhead for Sx100.
	
		Only print base count times for unknowns in TypeSampleSetup.
		
		Fix calculation of count time if UpdateStdInterferencesBadIntfElement flag is set and TDI is used
		for standards in AcquireDoSampleTunable and AcquireDoSampleTunable2.
	
		Fix fiducial select dialog frame.
	
		Fix TypeWarning bug if Pb, Th or U missing (Fournelle).

		Add printout of invalid interfering element in UpdateStdInterferences

2/5/11		Add spectro number and crystal name for standard assignment dialog if element and x-ray duplicated.

		Modify automation time estimate for standards (Carpenter).
		
		Rough out code for export of U, Th, Pb age calculations to Excel.
	
		Add UseChemicalAgeCalculationFlag to DataRun.
	
		Widen Fiducial dialog (Seward).

2/2/11		Move P/B checkbox to other frame (Carpenter).
v. 8.46
		Work on ChemAge code (Allaz).
	
		Fix problem in Standard.exe with Standard | Modify menu (Carpenter).

2/1/11		Fix problem with new PROBEWIN.INI keyword initialization.
	
		Add ability to use PictureSnap to digitize right clicked position to position database (if the
		PictureSnap Misc | Use Right Mouse Click To Digitize Position menu is checked) (Creighton)

1/30/11		Fix output of images to BMP files from Output menu if FormIMAGEDISPLAY was not already loaded.	
	
		FormSELECT already uses "AlwaysOnTop" flag.
	
		Skip calculation for std kfacs on startup (ProbFormOpenOlfFile).
	
		Fix tool tip help on CountOverwrite form.
	
		Recompile CalcZAF for bug standard number fix.
	
		Remove TypeCounts call after close Standard Assignments dialog.
		
		Add multi-point and MAN/Nth Point and Off-peak white paper pdfs to distribution and update
		ZIP files. Add sample MDB file for testing MAN vs. Off-peaks.
		
		Add UseCurrentBeamBlankStateOnStartUpAndTermination and ShowAllPeakingOptions keywords 
		to PROBEWIN.INI to change default beam blank behavior on startup and termination 
		and display of peaking options if JEOL or Sx100 interface. Update documentation
		and help file.

1/29/11		The following suggestions came from Carpenter, Kremser and Fournelle. 
	
		Fix CalcZAF when loading mode = 0 data file (calculate intensities).
	
		Don't show MOVE form on startup if no tunable spectrometers and stage motors.
	
		Add VerboseMode menu to StartWin.exe
	
		Add "blank" and "aggregate" paper reference to Report button.

01/27/11	Fix problem with counting for AM interface (RealTimeStartCounts).
	
		Fix window size position for UserWin.
		
		Adjust error message for missing interference intensity in UpdateGetStandards.
	
		Adjust wavescan time estimate. Separate LimitToLimit parameters for spec and stage.

01/18/11	Fix problem loading file setups from old runs with EDS elements.
	
		Allow loading of file setups with EDS elements only (Severin).		

01/12/11	Fix (re-write code for) estimated time calculation for sample acquisition.	
	
		Add button to refresh beam/stage position in Digitize Image window/dialog (Carpenter).

01/09/11	Add additional fit and correction parameters for TDI file output (Kuehn).
	
		Complete MultiPoint alternating on/off intensity data display (Allaz).
	
		For Cameca (SX50/SX100) use calculated spectrometer position instead of read position for
		integrated intensity scan because when step size is less than one, then duplicate positions 
		can result (Goemann). Also fix problem with duplicate x-axis points in old data.
	
		Fix problem if bgd counts are zero in AcquireDoPeakInterval and AcquireDoPeakParabolic 
		and AcquireDoPeakManual and AcquireDoPeakROM (Severin).
	
		Add Move buttons to fiducial selection and fiducial confirm dialogs (Severin).
	
		Add status for "return to on-peak" actions (Carpenter).
	
		Document MAN and several other missing output items in help file (Carpenter).
	
		Add check for same background types for duplicate elements if aggregating intensities.

01/08/11	Increase Sx100 time estimate, decrease JEOL time estimate.
	
		Fix overflow problem in ZAFSMP due to loading line numbers larger than 32K (Carpenter).
	
		Increase time estimate for SX100 automation.

		Update copyright notices in code and PFE splash screen.
	
		Fix MAN dialog if using aggregate elements with duplicate elements.
	
01/02/11	Fix code in UpdateStdMANBackgrounds to allow for use of aggregate intensities with
		mAN background channels.

		Add new field for saving/getting multi-point alternating on/off intensity data. Had to bump version
		for new data field.

12/26/10	Modify formatting of %REL (% relative deviation) for Allaz.
v. 8.45
	
		Increase size of sample setup field in Automate! window (Allaz).
	
		Add %RSD output to utilize Use Automatic Formatting checkbox in Analysis Options (Allaz).
	
		Remove delay in StartWin for PHA loop (unless demo mode) (Carpenter).
	
		Add check for unknown count factor zero in GetTimSetTimSave (Allaz).

		Highlight grid for large offsets in Peak/Scan Options.

12/21/10	Tweak Update (MSGBOXDOEVENTS form) to add check for RealTimeMode (Goemann).
	
		Add extra reporting for out of bounds coordinate import (Severin).
	
		Use MSGBOXDOEVENTS for Update Complete dialog (Goemann)
	
		Tweak EMSA EDS output format (Ritchie).
	
		Add error 110 for Sx100 (no P-10 gas).

12/19/10	Add source files for Standard and CalMAC to CalcZAF Source ZIP.
	
		Add extra trapping code for Sx100 Video image acquisition for IxIy pixel ratio. (Seward).
		
		Add additional option for FilamentStandbyType (0 = reduce heat only, 1 = reduce heat and keV, 
		2 = reduce keV only) (Seward)
	
12/03/10	Add code to perform TDI acquisition for MultiPoint samples. Also add code to save alternating
v. 8.44		on/off peak intensities. Not done yet is ability to display alternating on/off intensities for multipoint 
		background acquisitions. (Allaz)
	
		Modify SX100GetMotorPosition and SX100GetMagnification to just write zero return data as warning
		message in log window.

11/2710		Modify idle loop and use MSGBOXDOEVENTS dialog for Automation Completed message box also (Poeml).
	
		Adjust SX50 time estimate slightly (Fournelle).

11/23/10	Add code to properly set last visible row in Digitize window and DigitizePolygon codes
		regardless of monitor resolution or DPI (Poeml).
	
		Add warning to User Specified Output if over 256 columns of data (Carpenter)
	
		Tweak JEOL time estimates (Carpenter).

		See documentation for details.

			UserSpecifiedOutputFormula=0
			JEOLSecurityNumber=0
			MonitorFontSize=10
	
		Add three new parameters to INI file [software] section:

11/18/10	Add formula output for User Specified Output (Carpenter).
v. 8.43	
		Decrease Sx50 estimated time.
	
		Add report table format output for Report button (Analyze! window) (Severin).

11/13/10	Fix image shift column parameters when using digitized conditions from Automate! window (Carpenter).

10/25/10	Add code to skip calls to stage jog and shared monitor packet if starting from TestType.
	
			WDS_ServicePort = 22200, WDS_ServicePort2 = 2785
			JeolEOSInterfaceType = 3, ThermalFieldEmissionPresent = 1  	8530
			JeolEOSInterfaceType = 3, ThermalFieldEmissionPresent = 0  	8230
		
			WDS_ServicePort = 2785, WDS_ServicePort2 = 2785
			JeolEOSInterfaceType = 2 					8900 (Thermal flag not applicable)
		
			WDS_ServicePort = 2785, WDS_ServicePort2 = 22200
			JeolEOSInterfaceType = 1, ThermalFieldEmissionPresent = 1 		8500
			JeolEOSInterfaceType = 1, ThermalFieldEmissionPresent = 0	 	8200
	
		Summary of JEOL parameter settings (InterfaceType=2):
	
10/22/10	Modify service port numbers allowed for 8230 and 8530 (opposite of the 8200 and 8500!).	Here is a nice 
		summary table  also in the help file:

		Modify SX100 and SX50 software overhead constants for estimated time calculations.

10/11/10	Add Driver logging mode menu to TestType.
	
		Modify code in MoveSetFaradayDefault and AcquireStartSample to only unblank beam if using default blank beam 
		mode or "beam on" flag is not true (to optimize acquisition time).

10/04/10	Add user specified flag to not set analytical or column conditions during acquisition in
v. 8.42		the Acquisition Options dialog (Davis).
	
		Create new TestRegistration installation ZIP for testing Thermo remote server SX100/SX50 driver installations.
		
		Add new flag ThermoNSSLocalRemoteMode for Thermo NSS local vs remote computer configuration (Seward). Default
		is 0 for local server mode (PFE and Thermo NSS installed on the same computer).

		Add standard assignment output to PC custom format (Carpenter).

10/03/10	Add new Run menu for listing sample calculation options	(Carpenter).
	
		Remove extra "for Windows" text strings (Fournelle).

		Fix EMSA format time and date fields. Add EMSA standard composition data fields (Ritchie).
	
		Modify TimeCalculate code to handle different hardware interfaces differently and calculate off-peak motion
		explicitly.
		
		Modify code to NOT set default magnification during automated acquisition. This is partially to save time, extra 
		relay "clicking" and also to avoid the Cameca Sx100 hardware microcode bug that causes the bFocus value to 
		decrement when the scan mode is toggled between two beam current settings.
	
		Add Go button to Stage.exe Automate window.
	
		Add warning in AnalyzeCombineSamples if number of datarows in sample to be combined is different than first sample.
	
		Modify .ELM code (RECALB3.bas) to "trim" element, x-ray and crystal strings to avoid confusing Probe Image 
		with extra spaces.
	
10/02/10	Modify comments in PFWUpdate.bat.

9/18/10		Work on EMSA export format for TestEDS and Probewin.
	
		Add Bruker and Thermo interface files to distribution.
	
		Decrease time estimate for JEOL interface for hardware overhead.

9/15/10		Fix Bruker EDS and imaging issues for multiple clients.
	
		Modify EDSWriteDiskFile to utilize sample number and line number.

9/12/10		Modify Bruker code to handle bitmap stream image data.

		Add instrument specific hardware overhead values for Time calculation (Fournelle). Please check your projected time 
		calculations for accuracy, especially overnight runs.
	
		Don't load disabled channels when using Combined Sample analysis.

9/08/10		Fix display bug where elemental oxygen was not getting displayed and also modify code to use average for specify 
		concentrations by analysis option and specify by unknown sample.
	
		Add output of fiducial transformation matrix if using 3 points when calibrating PictureSnap (Carpenter).
	
		Add new special users.
	
		Update documentation.

		Add menu in CalcZAF to update MAC values in USERMAC.DAT (Poeml).

8/29/10		Add fixes to Drift.exe for additional output.
	
		Modify Digitize2.bas to support 4:3 mode for Thermo imaging.
	
		Modify Thermo image interface code and Sx100 video speed.

8/23/10		Modify Drift.exe for Paul to add additional output parameters.	
	
		Add driver logging level menu in Output menu.
	
		Adjust image interface calls.
	
		Tweak variable step wavescan stepsize calculation.
	
		Add check box on Stage Map form to make form "always on top".
	
		Use different file handle numbers for .COR, .ELM and .PHA files in RECALB code (to avoid multiple file 
		stream problems).
	
8/21/10		Exit procedure after starting Thermo image acquisition to allow delay. Add code to allow get/set beam mode for 

		ThermoImage interface. Add code to get image intensity min/max. Enable 2048 imaging for Thermo.

8/19/10		Add delay for Thermo TE portal image CSV file write.	
	
		Update documentation and help file.
	
		Allow up to 99,999 data points and 19,999 samples per run.
	
		Add "UserMAC.dat" MAC file for user defined MAC values. Add menus to CalcZAF to create and edit it.
	
		Make PictureSnap calibration window "always on top".
	
		Fix Digitize Shotgun where beam size was not being utilized for spacing random points.
		
		Add flag to force negative interference intensities to zero.
	
		Add highlight color for Standard GETCMP form to warn user of oxygen calculated by stoichiometry
		if entering oxide percents.
	
		Add SX50 serial cable documentation.

8/18/10		Fix "Test Polygon" load bug for demo mode in Polygon Digitize dialog.
v. 8.41	
		Update documentation.
	
		Modify ZIPDIST.BAT, ZIPDIST2.BAT, MAKMATRIX.BAT and MAKREMOTE.BAT files to copy
		compressed vbajet32.dll file to Vista distribution folders.

		Modify default path to always use C:\Probe Software\Probe for EPMA (Remote and Matrix).
	
7/25/10		Modify Setup1.exe project to copy vbajet32.dll if not present in Vista or higher systems.	
		
		Modify swt setup files.
	
7/24/10		Update context sensitive help in Probewin, Standard and CalcZAF.
	
		Modify distribution files to fix Vista errors and make default install folder C:\Probe Software\
		instead of C:\Program Files for all installations.
	
		Add new user specified output items to documentation. Make new help files.

7/21/10		Add off-peak count time statistics calculation equation to documentation.	

		Add user specified output flags for sample number and sample analytical conditions.

		Fix bug in specify by unknown where wrong list was getting disabled (Heather Wright).	
	
7/17/10		Modify AcquireStartSample to set beam mode to spot if user does not want scan mode even if automate sample 
v. 8.39		basis is > 1.

		Update Bruker config documentation.
	
		Add device compatible bitmap warning in BMPPrintDiagram.
	
		Fix Bruker imaging API calls ("acquire" should be spelled "aquire").

7/11/10		Add Match Image Names to Sample Names button to Image Display dialog.

		Disable Time weighting label if not using TDI in Analysis Options.
	
		Fix problem where integrated intensity data from quant samples was not getting normalized to 
		time (Fournelle).
	
		Lower SX100 minimum stage speed limit to 500 in InitMotors (Poeml).

7/4/10		Modify error message regarding integrated intensity channel in DataGetMDBSample (Fournelle).

6/27/10		Fix update problem with FTP folder being renamed.

		Recompile Faraday.exe, Monitor.exe and CalcImage.exe to allow new SX100 velocity range for SX100R (Poeml).
	
		Add better error message for SX100 bad crystal position returned.
	
6/26/10		Modify code after call to RealTimeSetConditions to load scan mode and mag for SX100 even if column
		conditions are being used (Goemann).
	
		Add formatting for scan rotation output in TestColumn.xls.
	
		Add fix for "Overflow" in MathAverageWeighted if just analyzing trace elements with no matrix specified.

6/20/10		Document "Overflow" error issues in Probe for EPMA and how they can be avoided.
	
		Add TestColumn.xls to Remote distribution. Update Remote/Matrix help and pdf files.
	
		Fix bug in SX100GetColumnParameters.
	
		Fix quickscan sample to measure and load beam current if not combined condition sample.
	
6/14/10		Fix bug in AcquireDoWavescanSpec and AcquireDoWavescanSpecROM where beam current was not being recorded if
		combined condition wavescan sample.
	
		Fix bug in AcquireDoWavescanTunableSpec when running combined condition wavescan samples with different 
		beam currents.	

		Add Call to DataOpenDatabase in DataFiducial for shared file use.
	
		Move zero blank reset to top of AnalyzeSingle code (before specify by unknown code).
	
		Add output option for unknown or standard samples in User Specified output (Goemann).
	
		Disable TDI weighting control if TDI not selected.
	
		Allow SX100 velocities for X and Y down to 1000. (add speed range error trap to SX100GetErrorText) (Poeml)
	
		Add check for off-peak equal to on-peak (Goemann) within small tolerance.
	
		Create new test Excel sheet (TestColumn.xls) for testing column parameters using Remote interface.

6/13/10		Add get column parameters code to Sx100 interface (for Remote calls).	

6/10/10		Add SX*.WMF files to Probewin setup files.	
	
		Add code to check window value in GetPHASetPHASave.
	
		Update documentation for new TDI weighting factor.
	
		Add spin buttons for stage in FormTRAVERSE (Kremser).
	
		Work on Specify by Unknown and Specify By Analysis controls and code for "Specified Concentrations". Seems to work!
	
		Fix display bug in ProbFormCloseFile where Analyze! controls were getting reloaded after form was globally unloaded.

6/6/10		Fix display bug in time calculation if using alternating on/off peak acquisitions for unknowns.
	
		Add flag and factor to weight TDI intensities based on elapsed time. See new routine VolatileCalculateWeighting.
	
		Add image display flags to Run table.
	
		Add printout of aggregate number of channels in Analyze and Type code.
		
5/29/10		Add skip deleted and duplicate menu items for PictureSnap display from Run menu (Kremser and Wright).	
v. 8.38
		Replace variable AllCrystals2ds(3) with constant for LIF 2d throughout code. Also add adjustment for x-ray database
		range in nominal interference calculation if using large 2d crystals. (Kremser and Wright).
	
		Fix FAQ document heading.
	
5/25/10		Modify aggregate count time to use average instead of aggregate count time. Has effects on sensitivity
		calculations when aggregate mode is flagged (add new aggregate number of channels parameter to sample 
		structure).
	
		Fix bug when loading PictureSnap with three point calibration (was re-setting to not calibrated).	

		Add additional output for predicted detection limits along with projected detection limits and also
		actual time and average beam.
	
		Add code to PictureSnap to check for PrbImg calibration file and convert ACQ file if ACQ file does not exist.

5/23/10		Fix average beam time for aggregate counting for statistical calculations, add display of average beam 
		current to AnalyzeTypeResults.

5/22/10		Fix beam de-normalization/normalization problem	in ConvertDetectionLimits2 where wrong beam current
		was being used in aggregate intensity mode. Need to use average beam current for all aggregate channels!

		Modify aggregate beam current calculation in DataCorrectDataAggregate to calculate average beam current
		for proper de-normalization/re-normalization.
	
		Rebuild Help file.
	
		Add documentation regarding JEOL driver function level timeout (Carpenter).
	
		Fix Analyze GridStat format for standard error.

5/20/10		Fix blank assignment bug in GetElmAll.	
	
		Update documentation.
	
		Add code to use slope calculation instead of intercept on hyper-exponential TDI calculations 
		if using aggregate intensity calculation (intercept from single TDI channel will not be correct 
		for aggregate intensities).
	
5/18/10		Fix bug in VolatileCalculaterFitSelf2 where intercept was not calculated correctly if TDI sample
		was hyper-exponential and using combined condition samples (in beam drift correction). 
	
		Make new distributions (add SX50Column and SX50Column2 apps).
		
		Load different default program path if Vista and up for Matrix and Remote apps.
	
		Fix PictureSnap loading if close first run and open second run with different picture. Force reload of 
		acquired positions from Run menu.

5/15/10		Fix Excel export bug in Userwin.
	
		Add parameters for saving original instrument interface types.
	
		Add code to set column conditions if combined conditions sample and using Return to OnPeaks option.
	
		Add alternative code for demo set beam current.

		Add user choice to output standard or unknown samples for TDI (volatile) output (Carpenter).
	
		Update documentation.
	
		Add user specified output flag for standard assignments (Hellebrand).
	
		Add keV values for absorption edge warnings.
		
		Update alternative FTP download.
	
		Add "OutofMemory" error explanation in PictureSnapPrintOrClipboard error code.
		
5/8/10		Re-set PictureSnap calibration if image was calibrated and changing from two points to three point
v. 8.37		calibration (Carpenter).
	
		Check that CurrentOnPeaks!(chan%) is not zero before checking for inbounds positions in 
		AcquireUpdatePeaks (Carpenter).

5/6/10		Add context sensitive help to User Specified Output dialog.
	
		Add Excel output to Userwin.
	
		Add x-ray line dropdown list in Standard.exe Option | Calculate Interferences.
	
		Enable "Combine Multiple Setups" in Automate! if standard samples checked.
	
		Reset total acquisition time in ProbFormSaveUserStartStop when new run started.

		Add appropriate error message if system does not contain enough video memory to save bitmap to clipboard
		for PictureSnap.

5/4/10		Add check box to normalize ROM and PHA scan intensity data from Run menu.

		Move Run |Image menu after Run | Scan menu. Update docs.
	
		Fix Move window when user edits increment by hand.

5/3/10		Fix peaking bug caused by adding check for sampletytpes in Automate! (Carpenter).
	
		Fix update problem in PlotUpdateSlopePolynomial for multi-point background fits if sample has 
		data but does not contain multi-point intensities.
	
		Modify colors in FormMODEL to highlight current polynomial or multi-point position.
	
		Adjust equation for high curvature TDI correction in VolatileCalculateCorrection.
	
		Add count time for estimated time calculation if UseUnknownCountTimeForInterferenceStandardFlag is set.
	
		Highlight All Samples option for Automate! window for running standards and unknowns together
		(Karen Wright).
	
		Add additional information for setting large area crystal flags for SX100 to SCALERS.DAT section
		of User's Guide and Reference manual Configuration Files section (Carpenter).
	
		Fix bug in SetupNewElement when adding new element (if oxygen present and OxideOrElemental = 1).
	
		Add more thermal conductivities to CalcZAF temperature rise dialog.
	
		Add light mode buttons to PictureSnap calibration window for ease of use.

5/01/10		Add Frequently Asked Questions pdf to File and Help menus.

		Modify SX100ROMWaitScan to ignore premature scan status complete return.
	
		Modify SampleLinesCombine to check for peak positions matching within a tolerance (Severin).
	
		Use integer value to target beam current in SetupNewElement when loading standard intensity
		from element setup database.
	
		Only print fiducial matrix if verbose and debug modes.
		
		Work on new TimeCalculateCombined code for modeling elapsed time for combined condition
		samples.
		
		Print out count factors for standards if UseUnknownCountTimeForInterferenceStandardFlag is true.
	
4/24/10		Update documentation for Kremser suggested edits (thanks Dan!).
	
		Fix Confirm form Jog button (Carpenter).
	
		Pause Confirm dialog if AutoFocus button is clicked (Carpenter).
	
		Fix problem with auto-focus when very close to Z limit (Wright).
	
		Move PictureSnap code around to save memory.
	
		Fix problem with pre and post scans (e.g., manual peaking) when run from Automate! 
		window (Severin).
	
		Fix Matrix.exe (and Remote.exe) COM server so it unloads completely (unload all forms explicitly).

4/17/10		Add TypeNewCounts call to SetupGetStandardization, etc if debugmode.	
	
		Add additional overhead for number of samples in Automate! for estimated time calculations.
	
		Improve background correction for Matrix standard intensity calls. Now uses main DataCorrect code for 
		background corrections.
	
4/9/10		Remove check for CombinedConditionsFlag in DataGetMDBSample and DataReplaceAddSample for "Multiple"
		table. It is not necessary.
	
		When loading element intensity from element setup database, do not load into standard list
		if already in standard list.

4/5/10		Add menu to PictureSnap to save image with graphics objects to BMP file.
	
		Fix minor problems when plotting multiple wavescan samples or elements (Goemann) in FormPLOT.	

		New feature to load standard intensities from element setup database (Fournelle). Changes
		to DataFileSetupLoadData and see new code SetupLoadStandardIntensityFromDatabase.
	
		Fix GetElmAll to only update blank assignment if unknown sample (Goemann).
	
		Disable parameters in FormSPECIAL that are not currently active.
	
		Check CurrentAcquisitionStartTime and do not calculate total acquisition time unless initialized.

4/3/10		Finish temperature rise calculation window in CalcZAF.	

3/28/10		Modify Brent's maxima code to interpolate data points to fit. Much improvement to maxima fit.	
	
		Utilize maximum intensity as starting point for Brent's maxima fit. Seems to improve fit 
		considerably.
	
		Add time, deadtime and beam normalization to threshold in Scan Data dialog.
	
		Add graph display to TestLsq.exe for Brent's maxima code testing.

		Fix invalid property bug when switching multi-point elements with on-peak intensity 
		option checked (Allaz).
	
		Add code to force minimum number of scan points in Sx100 ROM scan.
	
		Add enable/disable code for Peaking options.
	
		Add code to fix out of range integrated step sizes in GetELMSetElmSave if off-peaks are too close 
		together (Severin).

03/24/10	Add Add/Remove Standards To/From Run button to CalcZAF ZAFELM form.
	
		Add ZAF correction factors, compound MACs, and k-ratio options to User Specified output (Carpenter).
		
		Add alternative FTP download site to IOUpdate.bas.
		
		Work on Brent's maxima code.

		Add deadtime correction to COM Matrix Component get intensity code. Fix problem with too many setups 
		returned that was causing "subscript out of range".
		
		Add text in Count Times dialog for multi-point background counting and document in F1 help.
	
		Replace call to MiscTimer with simple Doevents statement in RealTimeGetPHADistribution2 
		and RealTimeGetPHADistribution3.
	
		Remove extra delay in PHA scans for first point.

03/20/10	Remove TestRegistration from PFWBETA.BAT (PFW update zip).
	
		Adjust TimeCalculate to improve ROM scanning estimate.
	
		Fix SX100 ROM scan problem by properly rounding speed and step size parameters.

03/11/10	Add error 1069 for Sx100.
	
		Force re-load of standard intensities if TDI flag or fit type changed.
	
		Add option for counting interfered elements in standards at same count time as unknowns (Allaz).
	
		Fix multi-point update bugs in Current.bas.
	
		Force JEOL 8900 and 8200 users PHA detector bias values to even numbers (not a problem on the 8500).
	
		Fix SX100ROM code to handle scans with better warning messages.

03/10/10	Fix wavescan graph display for more efficient redraw for ROM scans with short dwell times.
v. 8.36
		Make SX100 ROM scan limits to be 2048. Requires new Sx100 driver with larger buffer.

03/09/10	Modify SX50 position cache to be 1.1 times realtime interval.

03/06/10	Finish multi-point manual flag feature (Allaz).

		Tweak Nth point monitor element code.
	
		Add additional code to MoveReturnToPeak to handle disabled acquisition for setting next element
		PHA parameters.
	
		Add code to RealTimeSetDefaultState to not load PHA window values if too small when reading current
		PHA conditions from instrument (in case after instrument reset the PHA window is very small).
	
		Modify PHA scan code to use max window if scan window is too small.
	
		Fix crystal flip bug in AcquireDoCrystalPHA (Wark).

03/02/10	Adjust nominal overlap calculation to correct for LDE resolution.

		Add adjustment for non-standard rowland circles to improve resolution calculation
		in Interf2LoadElement (Wright).
	
		Call XrayGetOffsets in GetPeakSave after sample is read back.
	
		Remove spectrometer offset negation that was requested by Seward. Too confusing!

03/01/10	Add printout of crystal 2ds and Ks if debugmode for standard and unknown samples.
	
		Add code for update multi-point fits (iterate point and fit model) in FormMULTIPOINT.
		
		Work on multi-point flag and parameter updating.
		
		Add platform specific code for range checking Bruker and Thermo imaging interfaces.
	
		Fix problem when using automated pha or bias scans after peaking. Was using default PHA parameters
		for static PHA parameters (Carpenter).
	
		Add code to set PHA and detector parameters in MoveReturnToPeak to first order elements to 
		improve initial start timing. Only works if Return To On Peaks After Acquisition flag is set 
		in Acquisition Options dialog.
	
		Fix problem with ScalCrystalFlipFlags = 1 in RealTimeChangeCrystal due to recent code 
		optimizations (Wark).

02/27/10	Add Zoom Wavescan button to MultiPoint dialog.
		
		Disable fluorescence by beta lines until duplicate element problem figured out.
	
		Broke beta line fluorescence correction- fixed again (went back to 1/10/2010 code). Need to call init 
		fluorescence correction first with beta lines turned off.
	
		Fix multi-point wavescan overlay multiple sample selection plotting (Allaz).
	
		Fix fluorescence oddity when switching between aggregate and non aggregate for some duplicate elements.
	
		Fix aggregate intensity problem by fixing UpdateGetStandards (Allaz). Also did a complete re-write of 
		the DataCorrectAggrgate procedure to make it more readable by using temp variables to store 
		summed intensities.
	
		Add more realistic ROM scan demo code to simulate proper on-peak position.
	
		Don't call ScanUpdateData in RealTimeROMWaitScan if wavescan (as opposed to peakscan).
	
		Fix problem with demo ROM scan calculation forcing stepsize to min scan points.

02/24/10	Use bitblit for redraw graph in WavescanUpdateGraph.

02/22/10	Improve loading of wavescan form for multi-point overlay.	

		Add debug statements to ROM scan code. Improve Demo ROM code for more accurate simulation.

		Work on overlay wavescan feature in Display MultiPoint menu.

02/21/10	Fix too long graph title bug in Evaluate.
	
		Fix KLM output (Allaz).
	
		Add ROM wavescan acquisitions to wavescan acquisition type. Add printout to TypeWaveCounts.
	
		Add extra elements to traditional geological sort order.
	
		Add check for step size in SX100 ROM scan code.
	
		Fix integrated intensity bug (Goemann). Database was using dbInteger for data field- changed to DbSingle.
	
		Clean up debug output.
		
		Add Time Stamp Mode to Output window for timing various functions (usually used in conjunction with Debug Mode).
		
		Modify SX100SetMagnification to set spot to scan, then mag, then back to spot if necessary (Carpenter).
	
02/17/10	Test new Thermo TEPortal imaging function calls.  TEPortal.dll and Socket.dll must be dated 2/17/2010 or
		later.
		
		Add code to handle open database statement and trap errors if database is already open by another process. Will try 20
		times to try and open database if busy. Currently only used by DataAddMDBLIne and DataAddMDBCounts (and DataRun and 
		DataCurrent).
	
		Fix bugs in PlotSmoothUnsmoothGraphLoadData and PlotSmoothUnsmoothGraphLoadDataLoad when missing data is present.
	
		Update documentation.
	
		Add DefaultLiFPeakWidth for nominal interference calculation to INI file.
	
		Modify SX100 number of scan data points limits. Add test for old/new spectro board for SX100_ReadSpectroScan function.
	
02/15/10	Use vbSystemModal mask to force "Automation Completed" and "Filament Standby On" MsgBoxs on top 
		(other applications continue to run).

		Add code to turn off SE detector during acquisition. See new flag in INI file: TurnOffSEDetectorBeforeAcquisition
		in [hardware] section.
	
02/14/10	Fix ByVal parameter passing in SX100_ReadSpectroScan declaration, Add user defined scan points limit. Add support
		for 1024 limit on older Sx100s (1228 on newer SX100s). Add warning messages when minimum speed and maximum points are 
		adjusted for both JEOL and SX100 instruments.
	
		Add additional checks for standard assignments.
	
		Check multi-point and spectro limit and absolute/relative position code (removed extra call to GetElmSetElmCrystalUpdate).
	
		Add more details for crystal flip not in position error.
	
		Update documentation.
	
		Add flag for element output sort order in [software] section of PROBEWIN.INI file.
	
			GeologicalSortOrder=0		; 0 = traditional, 1 = low to high Z, 2 = high to low Z
	
		Add double check for assigned standard being in the current run.
	
		Improve peak width calculation in demo mode for ROM peaking scans.

02/13/10	Add extra tolerance for LDE crystals for "too far offset" check in peaking code.
v. 8.35	
		Start new temperature calculation code for CalcZAF.
	
		Add warning for off-peak backgrounds too close together and change disabled element acquisition notice message color
		to black (Carpenter).
	
		See updated documentation in the DETECTORS.DAT section of the Probe for EPMA reference manual.

		' Detector types:
		'  XPCH = sealed Xe detector on H-spectrometer (has different slit device compared to XPC) (no Ar gas)
		'  GPCH = gas flow prop detector P-10 atm press, on H-type spectrometer
		'  XPC = sealed detector Xenon proportional counter (no Ar gas)
		'  GPC = gas flow proportional detector P-10 atmospheric pressure

		' Spectrometer types:
		'  H = H-type two crystal spec, has range ~86-240 mm
		'  TXE = two crystal spec, same range as XCE, do not know how these are identified
		'  XCE = two crystal spec, has range ~60-260 mm  all normal 2-crystal Jeol spectrometers are of this type
		'  FCS = four crystal spectrometer, always has flow detector, has range ~70-260 mm  all normal 4-crystal Jeol spectrometers are of this type
	
		Only warn of Xe absorption edge if JEOL and also XPC detector (Carpenter).
	
		Have program only warn of Ar Edge if Cameca or JEOL and not XPC type (Carpenter). Note that the "DetectorModeString"
		values in the DETECTORS.DAT file can be used to indicate the detector type for this purpose.
	
		Have Load File Setup use original acquisition times when loading standard intensities (Carpenter).
	
		Fix incorrect spectrometer number printout in drift correction warning message (Carpenter).

		Fix problem with image automation where mag values were getting overwritten in DigitizeImageReadMagKeV.

02/05/10	Fix image acquisition for configurations without magnification interface (e.g., JEOL 733) (Kremser).

02/01/10	Add geological order sort button for Analyze! window stat and data grids.
	
		Add traditional geological order output option for JJD2 and Wright custom output formats.
	
		Modify VolatileCalculateFitSelf (create alternative routine VolatileCalculateFitSelf2) to calculate
		TDI self volatile correction using unique line number as opposed to sample row and sample datarow to support
		analyzing lines from multiple samples as one sample.
	
		Modify GetElmSetElm to apply absolute/relative option to multi-point positions (Allaz).
	
		Add output of individual emitting element MACs in CalcZAF for my favorite dude.
	
		Work on Thermo TE Portal imaging interface.
	
		Fix minor problem in FormANALYZE2 where auto analysis removed selected cell row for analysis and display.
	
		Add update of multi-point position in Peak/Scan Options if user changes on-peak positions. Add current table multi-point
		update in AcquireUpdatePeaks.

01/30/10	Add relative offset for multi-point backgrounds for intensity data output.	

		Update documentation.

01/28/10	Add code to automatically update multi-point backgrounds after spectro peaking in AcquireUpdatePeaks.

01/27/10	Work on TDI display issues.	

		Fix MODEL background code to handle exponential multi-point fit display.
		
		Start work on manual override flags for multi-point backgrounds.
	
		Calculate average high and low off-peak positions if sample is multi-point acquired but not using multi-point 
		background calculations.
	
		Finish multi-point exponential fitting.

01/23/10	Finish multi-point custom output format.

		Add code for formatting total (sum) output based on precision. Both to log window and Analyze! grid.
	
		Add check for too large a logical step size and too close to lower limit with JEOL instruments when performing a
		spectrometer ROM scan.
	
		Add exponential fit option to multi-point data.
	
		If Surfer .BAS output selected and wavescan selected, then uncheck Surfer output option (to plot wavescan properly).
	
		Add code to skip re-draw of current stage and beam positions if performing image calibration.
	
		Update User Reference manual.

		Add beam drift correction to DataScanGetScanData for Display Scan Data dialog (Run menu).
		
		Add text if "system not ready" error to check for gun vacuum ready and non-zero filament emission.
	
		Add check for sufficient number of points to iterate to in multi-point code.
	
		Excel Troubleshooting:
		When accessing the Remote Automation Interface from Excel you may receive the error message: Excel does not 
		does not recognize the Remote object. 

		To correct this error, simply go to the Tools menu and click on the References menu (this may vary 
		with the Excel version) and scroll down until you see Remote Automation Interface. Check this box and click OK.
	
01/21/10	Add note to Remote and Matrix active-x documents:

01/17/10	Modify Monitor demo mode to reflect faraday cup state in beam vs sample current reading.	

		Add driver function level timeout ignore for SX50 (requested by Fournelle).
	
		Allow Combine Analysis lines from Analyze! if samples are multi-point or off-peak acquisition as long
		as they use the same off-peak correction type.
	
		Add automatic saving of .SRF files (modify Surfer script file (XYSCAN2.BAS) and add image map output.
	
		Fix display of wt % when first loading composition for intensity calculation in CalcZAF.
	
		Fix default crystal save and re-load in Virtual standard intensity form.
	
		Remove calls to toggle beam scan in JEOLSetConditions (not necessary)
	
		Fix status bar output of beam current from JEOLSetBeamCurrentMDA.
	
		Disable Delete All button in FormSETUP if sample has data.
	
		Update documentation.
	
		Uncheck filament standby after restore beam.
	
		Add warning in PlotUpdateSlopePolynomial if current sample contains data and cannot update
		multi-point acquisition parameters.
	
		Add printout of crystal 2d and K if debug in TypeCounts.

01/16/10	Fix database field bug in DataReplaceAddSample.

01/15/10	Modify ZAF equation mode in CalcZAF to be consistent with DTSA-II.	
	
		Add multi-point parameters to element SETUP database structure.
		
		Fix multipoint update code in Plot2.bas so samples with data are not updated for positions.
	
		Move code for SETUP database update to FormMAIN (Probewin.exe only)
	
		Fix Plot! bug for normal graphs.
	
		Add option for beta line fluorescence to be turned off (normally on).

01/10/10	Add multi-point fields to SETUP element database.
v. 8.34
		Add debug code to SX50SetColumnConditions (Severin).
		
		Fix variable for KLM marker specified element.
	
		Add 3 way manual multi-point flag code (not in user interface yet).
		
		Tweak new analyze multiple samples code.

01/09/10	Optimize calls to PositionNewFile and PositionUpdateMDB.

		Add combine analysis lines features (from multiple samples) for analysis.
	
		Add display of on-peak intensities to multipoint display.
	
01/06/10	Add correction for beam drift and deadtime to plot multi-point intensities.
		
		Fix time calculation for multipoint backgrounds for realtime display of progress.
	
		Make sure VolatileCountIntervals is set properly even if user doesn't open FormSPECIAL.

01/05/10	Change smallamountx10 to smallamountx5 in ModelMultiPointPosition.
	
		Tweak multi-point code to skip calculation for peak positions out of spectrometer limits.

01/01/10	Add Bragg order parameter support for all code (acquisition and plotting) (Fournelle).
v. 8.33

01/01/10	Add Call to DataMotor(2) to save Motor table before file is closed (if downloaded for off-line processing).
	
		Update Reference manual for Fournelle suggestions on TDI.

12/31/09	Slight change to loading of elements from MOVE window (re-calculate multi-point positions).
	
		Fix Nth point option on multi-point acquisition. 
	
		Fix problem with published sum when no oxygen is present.

12/30/09	Tweak multi-point features some more.
	
		Tweak multi-point features more. Add log window output.

12/29/09	Update documentation for multi-point features.	
	
		Work on Multipoint graphical display and output.
	
12/28/09	Modify GetElmAll to not save background type if data present (used to allow changing to 
		off-peak if off peak data was present).
	
		Bump version to allow multi-point background controls to be accessed.

12/27/09	Work on multi-point background feature (graphical display and custom output format).	
v. 8.32
		Work on Bruker image interface (for SX50).
	
		Work on multi-point backgrounds.

12/26/09	Work on interference debug output (with RTF equations)
	
		Fix menu problem when Standard.exe tries to open wrong database type.
	
		Add additional flags and debug output for interference corrections.

12/24/09	Work on multi-point bgds more.
	
		Make new distributions.	
	
		Add support for number of cations and oxygens up to 99 (Carpenter).
	
		Add additional information on read POS file errors (Severin).
	
		Read mag/kev when manually starting image acquisition.
	
		Work on multi-point acquisition more.

12/19/09	Update Quick Start manual (Seward).
	
		Allow zero forbidden elements for KLM plotting in INI file.

12/15/09	Fix problem with default multi-point position calculation in CurrentUpdateMultiPoint.
		
		Work on multi-point backgrounds.
	
		Add Probe Software On The Web menu to CalcZAF.
	
		Add Quick Start manual to distribution and Probewin menu.
	
		Update Matrix and Remote documentation and help files.
	
		FormMATCH- display oxide composition if using stoichiometric oxygen or display as
		oxide flag.
	
		Fix CalcZAF problem when editing compositions for intensity calculations (Carpenter).
	
		Create missing position database in Probewin load form event.
	
		Add code to allow autofocus timeout to continue in JeolAutoFocusScan.
	
		Add check for no positions samples in DigitizeUpdateAutomate.

12/12/09	Add new SX50 prototypes for driver version 3.1.0.
	
		Work more on multi-point backgrounds.
	
		Modify Match composition form code to handle errors better.
	
		Update Reference manual (Fournelle).
	
		Do not print out background fit coefficients if not using detailed output mode.
		
		Modify call to DataMakeNewSample in NewMakeNewSample to handle errors better.
	
		Add no quant interference flag to UpdateGetStdInterferences.

12/05/09	Add driver logging level flag to SX50 code (Gaynor).

11/28/09	Work on multi-point background code more.	
	
		Add options for PHA bias and gain scans to automated PHA scans (Carpenter).
	
		Add check for very low PHA baseline (Fournelle).
		
		Add DataAddMDBMulti to write multi-point data to probe database.
		
		Enable Remove TDI flags for standard samples as well.
	
		Modify GetElmAll to not save TDI flag if no data is present (standard and unknowns)
	
11/27/09	Fix problem with standard and unknown integrated intensity scans (Kremser). Fix
		problem with estimated time calculation for integrated intensity scan elements.

11/23/09	Fix problem when selecting absorption edges in xray database dialog
		and problem with plotting user defined KLM markers.
	
		Consolidate some background string definitions.

11/22/09	Work more on Multi-point background feature.

		Add cps per nA output for TypeNewCounts and SampleLoadGrid code.
	
		Add warning for Ar and Xe absorption edges between on and off peak positions.

11/21/09	Work on multi-point background code.

		Fix TypeCalculateOneSigma to deal with one sigma calculations better.	
	
		Tweak IOStatusCancel call for spectrometer ROM scan cancel.
	
11/13/09	Fix bug in DataCorrectData on unusual problem for beam drift correction on off-peak
		intensities when nominal beam is changed (Allaz).
	
		Fix Standard.exe output (do not print image shift).

11/08/09	Fix wavescan ROM scan cancel and image acquire cancel for JEOL instruments.
	
		Fix wavescan position plot in Image Display by adding "Skip Duplicate Points" checkbox.
	
11/03/09	Fix problem with average total and stddev output.
	
		Document wavescan printout labels (Analyze! | Data button).
	
		Add output of variable step and inverted wavescan acquisition flags.
	
		Modify NIST output to handle when beam drift and deadtime corrections are turned off.
	
		Change IDAB command to use UnitNumber.UnitEOSZero to cancel ROM wavescan.
	
		Tweak the wavescan beam current measurement acquisition code a little.

11/01/09	Work on multi-point off-peak backgrounds.	
	
10/30/09		Make additional changes to utilize actual off-peak measurements on polynomial
		background fit. For this to work with wavescan data, modify AcquireStartWavescan to measure
		an initial beam current to use even if not measuring beam current explicitly because the 
		polynomial fit must be performed on beam drift corrected data! Modify DataGetMDBSampleOnly
		to load default beam current if beam current was not measured in older runs.
	
10/29/09	Finally fix polynomial fit to properly handle re-normalization using different 
		beam currents (thanks to Julien Allaz!).
	
		Add code to properly cancel image acquisition and ROM scan on JEOL instruments.


10/28/09	Fix problem with deadtime de-normalization in CountOverwrite code.	
	
		Modify automatic formatting to precision and detection limits to round before truncating
		to significant digits. Modify average to also use worst precision and detection limits
		for formatting of average (Williams and Allaz).
	
		Add deadtime correction to CountOverwrite code and add Analysis Options flags code. Handle
		wavescan samples properly for Count Overwrite.
	
10/27/09	Add DoEvents to OnPress events for FTP and HTTP update software code to prevent
		spectrometer position errors on SX100 when connected to instrument.
	
		Work on CountOverwrite code (Jercinovic and Allaz). Should be working now. 
	
		Add Re-load INI Values button to re-load [image] parameters for image calibration testing.
	
10/26/09	Have Probe for EPMA Help | Update check for already up to date version before
		attempting download.
	
		Start creating user interface for editing overwrite values.
	
		Add "overwrite" count table to preserve original data intensities.
	
		Add check for new version in Help | Update Probe for EPMA (warn user if already up to date).
	
		Add Nth point for wavescan beam current acquisitions (Allaz and Jercinovic).
	
		Add extra text to Analyze! output for sample name using blue font (Cornelius).
	
		Warn user if Nth point background option selected but no elements selected.
	
		Modify Drift.exe to set search options (Wark).

10/25/09	Tweak detailed output. Set StageMap timer back to one second.
v. 8.31
		Fix combined conditions on wavescan samples. Fix beam current acquisition for wave
		scans when using synchronous mode.

		Make smoothing number of points a drop down list. Fix loading of unsmoothed data.

10/24/09	Fix problem in FormSETELM for calculating off-peak interferences (Chi Ma).
	
		Fix formatting of std and unk counts in TypeCounts if NominalBeam = 1.
	
		Add standard TDI calculation to standard drift array loading (UpdateGetStandards).
	
		Fix several small bugs in smoothing and peaking routines.

10/12/09	Add code for standard samples for TDI quant and output.

		Add smoothing option to ScanData dialog. (Carpenter)
	
		Modify smoothing in ROM Peaking routine to use maximum allowed number of smoothing points.
	
		Add acquisition of TDI for standard samples. Modify standard assignment dialog for
		TDI elements. No standard intensity calculation yet! (Carpenter)
	
		On Stavitsky-Golay smoothing don't overwrite end points.
	
		Add code for measuring the extra delay due to the faraday cup being pulled out before the actual
		count integration starts. This is automatically incorporated into the volatile (self)
		TDI correction for proper extrapolation back to zero time.
		
10/11/09	Add globals for utilizing monitor structure info for updating StageMap window to 
v. 8.28		improve	response time (especially for JEOL 8900). (Carpenter)
		
		Add additional formatting for absorbed current and count intensities if nominal beam = 1.
	
		Add label field explaining count times for peaking.
		
		Add sample flag for Nth Point acquisitions. Add more output of Nth point flags.
	
		Fix time calculation for off-peaks in TIME.BAS
	
		Add check for using sample setups with peaking.

10/10/09	Fix problems with Clipboard button code (need to convert graph to bit blit first).
	
		Add Stavitsky-Golay parameter for smoothing for wavescan plots.
	
		Add hours display to Count Times.
	
		Add check for valid monitor element.
	
		Reload StageMap after loading new INI values so they take effect.
		
		Modify Run menu sub menus for images and scans.
		
		Add colored warning is PHA control is turned off.
	
10/04/09	Modify count intensity output to include nominal beam and also use f8.2 format for
		intensity data when nominal beam current is 1.
	
		Fix Pre/Post scan ROM based scan options in Peaking dialog. Spectrometer positions
		were not getting saved properly (Carpenter).

09/28/09	Finish Nth Point "Smart" monitor intensity feature.
	
		Fix clipboard button in plot window.
	
		Modify JeolGetImageMode to use new command set.
	
		Add code to fix 8900 PIC mode problem for image acquisition (Adams).
	
		Add nominal beam field for polynomial background fitting normalization.
	
09/27/09	Add new data fields for Nth point monitor element and percent change.
v. 8.26
		Add field for integrated intensity type for "inverted" variable step wavescans. 

		Uses minimum step size on backgrounds, and longer step sizes on peaks. See
		Elements/Cations (Jercinovic).
	
		Disable controls when moving to on-peak positions in Peaking dialog. Also add icancelauto flags if Cancel 
		button is clicked.

		New run reset stage increment for scanning and peaking in InitData for new runs (when program is not closed).
	
		Force order number to MAXCHAN when loading a new element in GetElmSetElmSave to make sure that new 
		analyzed element is loaded after the last element on that spectrometer (was defaulting to zero which loaded 
		first in order number).
	
		Fix AutomateConfirmSelected warnings for missing sample assignments.
	
		Replace local "sym" ("St", "Un", "Wa") variables with globals.
	
		Fix PHA acquisition "cancel" bug.
	
		Allow SGSP to be turned off for 8900 before digital imaging.
	
		Do not print "Column conditions loaded" if error.

09/22/09	Make tolerance for initial integrated intensity steps sizes more generous (Wark).	
	
		Add debug statements to JEOL set beam mode.
	
		Resize and color Save To Database button for imaging.
	
		Load current mag and kev on Load FormIMAGE.
		
		Make interfering line first order if new interference.	

		Fix problem with duplicate analyzed and specified elements in PUBL: totals. Did not affect results
		just the calculated sum for the PUBL: line.
	
		Add field for interference calculation sensitivity to Elements/cation dialog.
	
		Fix some F1 context sensitive help index numbers.
	
		Make some quant warnings magenta color (beam drift correction disabled, etc).
	
		Load tooltip help for integrated/variable step depending on sample type.

09/20/09	Fix specified composition problem- if standard skip update specified concentrations.	

09/06/09	Spell check Reference manual, recompile Help file, new pdfs.	
	
		Add stagemap window as modal dialog in Traverse dialog (Cogburn).
	
		Add SX50 DIC0/DIC1 board check to initialization (Seward).

		Add auto-focus to StartWin Modes menu. Auto focus will be affected by Cycle menu. (Carpenter)
		
		Fix MAN problem with quick standards and use off-peaks for MAN fit (was applying 
		aggregate intensity correction when not necessary in UpdateGetMANStandards).

09/05/09	Add Nth Point off-peak background method (Tim Grove).
v. 8.25	
		Work on Bruker and Thermo image interfaces.
	
		Fix MAN element formatting in Report button.
	
		Fix Faraday GUI problem.

09/02/09	Work on formatting of debug statements in JEOLSetBeamCurrentMDA code.	
	
		Work on Thermo and Bruker imaging interfaces.
	
08/27/09	Fix fiducial transform bug in AutomateImportPositions from adding import increment 
		feature.
	
		Modify ZIP batch files to put system32 files in separate folder.
	
08/26/09	Add move to starting position of auto-focus scan if JEOL.
	
		Add 2 second timer for JEOL 8900 on beam mode calls in StageMap.
	
		Move copy protection code to RealTimeInitInterface.

08/19/09	Test new SX50 SX_ReadAccVol and SX_ReadMag functions (only driver v. 3.0.1 or higher).	
	
		Fix extra call to JEOL EDS if not initialized.
	
		Add structure for Thermo and Bruker imaging interface.

08/17/09	Modify Tracor ROM scan stepsize calculation (Horn and Carpenter).
	
		Fix window position load on old user new file for Automate window.

08/14/09	Change name of product to Probe for EPMA. Update documentation and help files.

08/11/09	Remove IOMsgBox from EDSWriteDisk (use normal MsgBox)

08/08/09	Fix Edax spectrum read/write disk procedures (Severin).	
	
		Fix problem when using integrated intensities with quick standards in UpdateGetStandards.
	
		Fix bug where Scal Off/Wave/Peak ScanFactors were not stored in MDB file (add to DataMotor).

08/04/09	Fix bug in ProbFormOpenOldMDB where DataMotor was not being called before last sample was read.
v. 8.24	
		Add Lispix output for wavescan arrays for spectrum imaging.

08/02/09	Fix GetTimAll to load and save nominal beam for off-line calculations.

07/24/09	Add code to RealTimeROMWaitScan "If done And ROMPHApointnumber%(iscal%) = 0 Then" to reset status flag
		and continue to check for scan data (premature completion flag problem on SX100)
	
		Recompile Matrix and Remote to deal with JEOL EDS INI parameter.

07/23/09	Modify Faraday output again.	
	
		Modify Digitize Image/Imaging window control layout.
	
		Add date/time option to Faraday beam output

07/22/09	Modify JEOL EDS code.

		Fix "subscript out of range" problem in Plot! when using Normalize Samples (Y Sets) on non wavescan data.

07/17/09	Fix problem with some v. 8.21 and 8.23 MDB files that had both wavescan limits set to low limit.	
	
		Fix order problem, when acquiring wavescans from older MDB files.

07/16/09	Fix problem with missing current wavescan parameters when loading older MDB files in AcquireUpdatePeaks.

		Move totals positions to both after elemental wt% and after oxide % for user specified output format. (Wark)
	
07/13/09	Fix problem with using fixed step sizes in traverse dialog. Increments were not being 
		calculated properly. (Wark)
	 
		Fix ST 8900 command in emulator INI file.
	 
		Add "Using Filament Standby..." message to AutomateConfirm code if selected.
	 
		Fix bug in Acquire! | New Sample when no position file exists.

07/11/09	Add Custom Output format (User Specified) flags and code. (Wark).
v. 8.23	
		Rearrange Standard menu.
	
		Add template code for JEOL EDS "batch file" acquisition. (Carpenter)
	
06/28/09	Add option for "short" labels in Image Display and PictureSnap. (Wark)
	
		Suppress blank analysis output to log window and Analyze! form unless debugmode.
	
		Fix problem in ZAFPhiCal when hydrogen stoichiometry to excess oxygen is inappropriately applied
		to a sample that does not contain water (prints more friendly error message)
	
		Force PictureSnap to repaint position graphics when using Copy To Clipboard (method 2). (Wark)
	
		Force order number to MAXCHAN when loading an element setup to make sure that new element is loaded
		after the last element on that spectrometer (was defaulting to zero which loaded first in order number).
	
		Add option for in/out testing of faraday cup to Faraday.exe (Fournelle).
		
		Fix load digitize image to not use Acquire Current Sample label (use current sample name).

06/27/09	Add "*No" to elements not yet peaked in Peaking Results to indicate which elements are going
		to be peaked but are not yet peaked.

06/18/09	Fix problem with disable quant flag and aggregate intensity feature (Lowers).	
	
		Fix predicted detection limit calculation to use nominal beam.
	
		Add sample name to status output in AnalyzeSample.

06/16/09	Tweak trace element custom output format to include count times, beam currents and raw intensities.
	
		New custom output format for trace elements. Outputs averages, standard deviations and t-test data.
	
		Make RealTimePeakGetCentroid "Less than 3 points..." error to exit gracefully to allow peaking to proceed. Add 
		printout of datapoints if this error occurs.

06/15/09	Disable off-peak fields in Count Times window to indicate element is MAN (standard or unknown).
	
		Create invisible controls for storing wave and quick scan limits for GetElm form in case user changes
		the element, xray or crystal. In this case the program will reset these to zero so they get properly 
		reloaded to defaults.
	
		Use constant for "smallamount" fraction and add JEOL spectro jog amount (0.5 mm) for lower limit on
		JEOL interfaces where off-peak and wave and peak scan limits are adjusted.

06/13/09	Add FOV display for analytical and imaging magnifications in FormCOND and FormGETCOND.
	
		Fix spectro limits code in AcquireUpdatePeaks. Was not setting inside limits if position equaled limit.

06/11/09	Change coarse ROM scan failure warning to red.
	
		Change FormDIGITIZE Create button text (Carpenter).
	
		Add "green" OK and Close buttons to forms, remove extra form controls.
	
		Add code to AcquireDoPeakROM to also save centroid if using Sx100 internal peaking.
	
		Modify DataStandard to always save unacquired standards if not RealTimeMode.
	
		Fix out of bounds warning in RealTimeGetMotorPosition to write to PROBEWIN.ERR.

06/10/09	Add consistent rules for rejecting extraneous intensity data from ROM scans.
	
		Add column condition method and string arrays for combined condition samples.
	
		Add up to 4 tries to read beam and absorbed current for SX50 interface (Fournelle).
	
		Set interference order to blank when clicking Remove button.
	
		Modify explanation of Data button in Analyze! button (Fournelle).
	
		Modify import code increment fiducials if non-zero and save to position file for subsequent export if
		using import increment and no fiducial transformation. This will be useful when putting standard (or
		unknown) block into a completely different stage position.
	
		Change default import increment factor to zero.

06/07/09	Fix command line argument problem (move code to procedure) by removing double quotes inserted by
		Command$ function.
	
		Fix problem with one sigma value shown in Analyze! window if displaying unnormalized counts.
	
		Add Vista distribution setups for Remote and Matrix.
	
		Add trace capability to PFW Update code for both FTP and HTTP (if DebugMode is on).
	
		Change default demo instrument to JEOL.BAT (no W motor). Update Motor tables for JEOLEL.MDB and JEOLOX.MDB
	
		Fix position sample selection by fiducial number in Stage.exe.

06/01/09	Tweak conductive coating correction. Improve debug output for conductive coating calculations. 
	
		Finish conductive coating absorption correction for matrix correction (needs testing).
	
		Make sure that FileViewer is always referenced with double quotes in case path contains spaces.
		
		Use constant for maximum ROM intensity.
	
		Modify AutomateImportPositions to also perform import increment on standards if no fiducials selected.
	
		Add "none" to first index of fiducial selection list in Automate!

05/31/09	Adjust SX100 ROM start wait scan warning message.

05/26/09	Modify Sx100 code to handle bad ROM scan data better.	
	
		Fix DemoGetPositionFactor code for better wavescan simulation.
	
		Add wavescan parameters to sample data structures. Requires significant changes to some routines.
	
		Add check for SX100 spectro start and target positions during ROM scanning- in case of driver corruption.
	
		Fix Help | Display Version Info menu code.

05/23/09	Work on JEOL 8530 interface (add stage read, faraday cup and set/get hv calls).
v. 8.21	
		Add Z increment to CONFIRM dialog.
	
		Place display version.txt file code in subroutine.

05/20/09	Modify SX100ROMGetData and GetData2 code to reject bad spectrometer intensities.

05/19/09	Fix divide by zero in FormWAVESCAN load event (in debugmode only) (Kremser).

		Fix problem where auto re-standardization (and also final re-standardization) wasn't utilizing Y increment!
	
		Add option for yes to all for selected standard deletion in Standard.exe.

05/18/09	Fix File menu item enable problems in Standard.exe (Carpenter).
	
		Make some changes to Edax file read/write structures (Severin).
	
		Add menu to Help menu to view version.txt information (Fournelle).
	
		Add code to triple check crystal name in SX50 if crystal name was not found first time (Fournelle).
	
		Add jumps to acquisition routines to skip steps if spectrometer is already at peak position (Fournelle).
	
		Add color to peaking failure messages (magenta).
	
		Fix MenuFileArray_Click code so that UserData folder is updated if file is loaded from recently loaded 
		menu arrays (Carpenter).

		Set move without beam blank flag true for traverse and grid move buttons.
	
		Add visual indication of faraday cup state.
	
		Fix Plot button in Automate to clear previous plotted points in arrays (Carpenter).

05/16/09	Fix StrataGEM output to use kilovolts array only if combined condition sample (Fournelle).
	
		Modify peaking message in AcquireStartPeak to only print out elements assigned if using automation and
		Peak On Assigned Standards.

05/06/09	Add hardware based jog commands for stage and spectrometers to allow user to specify ROM based 
		jogs from MOVE window (JEOL 8900/8200/8500 only).
	
		Create Increment button in FormPOSITION to allow arbitrary increment (translation) for selected position 
		samples (Crabtree and Carpenter).
	
		Modify Import Increment dialog to display imported positions before applying increment
	
		Modify CalcZAF ZAFElm form to select "Specified" if in CalcZAFMode% = 0 (calculate intensities from wt%).
	
		Use timed dialog in AcquireStartSample for scan mode warning if automation and not using last unknown.
	
		Add Default peak position button in Peak/Scan Options dialog.

5/2/09		Add element, xray and spectro for "Starting spectrometer peaking procedure..." message in AcquireStartPeak.	
	
		Modify exponential background fitting routines to pass double precision fit coefficient variables. Changes
		to several Model.bas and Model2.bas routines. Required for exponential background fitting near Ar edge 
		for U Ma line.
	
		Add short delay after starting move to crystal flip position in case flip crystal command is issued 
		too quickly in MoveDoMotorCrystal and generate spurious "spectrometer is not in crystal flip 
		position" error.

		Add loading of image channel name text in FormIMAGEDISPLAY.
	
		Make List Report button yellow in Analyze! window and add extra tooltip help
	
		Add UseLastUnknownAsWavescanSetupFlag to data file and Acquisition Options dialog (Fournelle).

4/25/09		Add custom format output menu #13 (Hanchar-Montel Geochron) for monazite age calculations in John 
v. 8.14		Hanchar's Excel spreadsheet.	
	
		Work on Jeol7000 (8530) init/close interface.
	
		Add new PROBEWIN.INI flag (UseLastUnknownAsWavescanSetup in [software] section) to force loading of new 
		wavescans based on last unknown (Fournelle).
	
		Add additional output for wavescan samples if debugmode.
	
		Add comment that deadtime value in PHA dialogs is for software correction only.

4/18/09		Change interference order display in FormSETSTD to roman numerals.
		
		Fixed problem with beam mode changing occasionally to scan mode under certain conditions.
	
		Add new buttons to Analyze! to allow user to edit combined analytical conditions and count times for samples other 
		than the current sample. Code changes to AcquireChangeConditions2 and added AcquireChangeCountTimes.

4/12/09		Work more on JEOL 8530 interface (add imaging interface).	
	
		Add Tracor get crystal position code. Leave Move dialog confirm for stage and spectro positions.
	
		Disable controls for ROM peaking other than "Internal" for Tracor interface. Force Interval for Sesame, Tracor, 
		SX50/51 and Thermo-Tracor.
	
		Fix problem with storing of Tracor centroid position.
	
		Wait 4 seconds (instead of 1 second), in SX100FilamentWarmup the first time the heat value is set.
	
		Set beammode to spot if user doesn't want scan mode in AcquireStartSample.
	
		Add icancelload = False to all places where modal dialog is loaded and then checked for icancelload = true.
	
4/11/09		Work on Tracor interface again. Increase max number of ROM scan points to 4096 (Carpenter and Horn need
		to test this).
	
		Work on Tracor spectro scan more.

4/6/09		Tweak Tracor 5600 PAC ROM spectro scan code.	

		Uncomment get beam scan mode code for 8900 in JeolImageGetScanMode. Apparently the low level driver
		is not handling the get scan mode code appropriately (works for 8200 though). Sorry Dave.

4/05/09		Work on JEOL 8530 (7000) interface.

4/03/09		Work on JEOL 8530 (7000) interface.	
	
		Fix EDS only acquisition (no WDS elements) problem in CurrentCheckRealTime (should be ierror=false!).
	
		Add text fields for image shift in COND.FRM. Disable image shift fields if not demo or JEOL interface.
	
		Fix minor problem in CalcZAF when changing from analyzed to specified (enable appropriate text fields).
	
3/31/09		Fix problems with missing standard assignments in UpdateStdInterferences and AnalyzeTypeReport if element
		is disabled for quantification.	
	
		Fix EDS only acquisition.
	
		Add ROMPeakingType to INI files for specifying ROM based peaking type. Default is 2 for Brent's maxima.
	
		Add sample in blue font for TypeNewCounts.

3/22/09		Add display for image shift values and variables to store in Line and Position tables.	
v. 8.12		
		Modify SX50 spot mode (SX50ImageSetBeamMode) to not reset beam size if zero (some later model SX50 instruments 
		will lose spot mode?).
	
		Add deadtime calculation spreadsheets to distribution. Make new PFW and CalcZAF distributions.

3/4/09		Add extra status label output for PHA set delays.
	
		Add debug statements to Bruker init. Add QueryServer and QueryUser calls.

		Update documentation and help file.
	
		Disable Analytical Conditions controls if UseCurrentConditionsAlways is set.
	
3/3/09		Add new keyword to [general] section of PROBEWIN.INI file: "NominalBeam" which is defaulted to the default 
		beam current. This allows users to have the nominal beam normalization constant set in the INI file (e.g.,
		NominalBeam, = 1.0 for intensities in cps/nA) (Llovet and Fournelle).

		Add PCO to default CRYSTALS.DAT file.
	
		Fix name for multiple selected Automate! Plot button plot.
	
		Add cancel button MsgBoxTim in case of large loop warnings.
	
		Add globals and INI keywords for Bruker remote client interface (EDS_ServerName, EDS_LoginName, 
		EDS_LoginPassword).

		Double calls to resize wavescan graph in Form_Load event (sometimes wasn't resizing perfectly).

3/1/09		Fix typo in Startwin FormCOUNT for saving window position on activate event (Carpenter). Check other 
		Form_Activate events.
	
02/22/09	Add APF re-normalization to help when the trace elements vary in precision and are affecting 
		the APF correction in a pure element (e.g., Si Ka in O).
	
		Add auto backup when using auto update from Help menu (Fournelle).
	
		Modify ImportIncrement feature to increment and update based on spin button.
	
		Check report from Paul that off-peaks are not set properly inside spectro limits if new peak position places
		the off-peaks outside limits. However, the code appears to be working properly.
	
		Also specify character used in Auto Increment feature in INI file (see AutoIncrementDelimiterString in the
		INI file [software] section).
	
		Add option to turn off HV when using filament standby in INI (use existing INI parameter FilamentStandbyType=1). 
	
		Reset TDI and quickscan acquisition mode in InitData.
	
		Add comment to FormSPECIAL warning of asynchronous mode if using TDI.
	
		Add rough outline for JEOL 700/8230/8530 interface.

02/21/09	Modify ImportIncrement dialog per Dave Crabtree.

		Modify Jeol set MDA code to reflect new condenser range data for 8500 from Scotty.
	
		Disable Acquire buttons during change conditions (and load column conditions).
	
		Update Pre-installation checklist.
	
		Add import increment option for unknown/wavescan position import, when no fiducials are used.

02/14/09	Modify Automate Plot to plot all selected samples.

		Fix acquisition order bug when loading file setup that is using a user defined order (thanks Eric).
	
		Blank position sample description field when importing position data to avoid "stale data" problem.
	
		Add check for both start and target positions for TracorStartPeak by adjusting stepspoint down until positions
		are in bounds or steppoint < 1.
	
		Add SX50Column_RegistryWriteMode to [software] section of PROBEWIN.INI for Bruker software. Modify SX50Column.exe
		to support direct write to registry.
	
		Add 1/10th msec constant to JEOL code.
	
		Add debugmode trace top SMTP control.

02/08/09	Add calibration (.ACQ) file for export of BMP from DigitizeImage dialog.
	
		Consolidate serial port comm event trapping code.
	
		Change max PHA window to 5 volts for SX100.

01/29/08	Add check for target position in TRACORROMStartPeak. Iterate stepspoint until within spectro limit.
	
		Fix coating absorption correction x-ray line problem in ZAFSetZAF and ZAFStd.
	
01/27/09	Add OnComm event error trapping to TestType. Modify all serial OnComm event code to use IOMsgBox
		instead of just MsgBox to display serial port errors in log window.
	
		Add code for calculating x-ray absorption loss to coating thickness (not implemented yet).
	
		Fix constant in energy loss calculation for coating thickness. Replace some explicit numerical values
		with named constants. Fix bad constants for alternative units scale bar in image display.
	
		Fix problem in JeolSetBeamCurrentMDA and JeolSetBeamCurrentMDASet for saving last good condenser values.
	
1/24/09		Remove "RealTimeInterfaceBusy" flags from plot routine (maybe causing Scotty's runaway count issue?)

1/22/09		Fix wavescan window height resizing problem on new wavescan.	
	
		Work on Jeol MDA beam current code (Scotty). New code to handle failure to iterate. In these cases the
		software will automatically set the condenser lenses to the last known valid condenser values for the 
		specified beam current.

1/21/09		Modify SX50 caching times to use non-multiple values (Fournelle).
	
		Move some OEM distribution folders to SOURCE2 and PFW Components folders.
	
		Modify SX50 caching to use multiples of RealTimeInterval.
	
		Clear status bar after filament warmup.

01/17/09	Add speed calculation code to TRACORROMStartScan.
	
		Add more colored buttons for ease of use.
	
		Add filament standby off menu.

01/15/09	Adjust sx50 caching code and cache times to 0.5 seconds for motor positions and 5.0 seconds for crystals.
	
		Work on TRACOR spectro scan code (needs testing) for TRACOR and Thermo-TRACOR interfaces. Try TestType.exe first.
	
		Add call to update Automate window position coordinate list when digitizing before points are added.
	
		Copy Jeol config (demo) to Jeolw config. Edit Jeol config to use only x, y and z stage axes.

01/14/09	Make another tweak to the SX100SetColumnConditions code and extend Sx100 timeout to 40 seconds.	
	
		Modify the way DigitizeLoad loads the sample option so the Automate position list doesn't get re-loaded.
	
		Change sx50 cache time to 0.08 seconds (from 0.06 seconds).
	
		Change fiducial output to VerboseMode.

01/13/09	Fix FTP on_progress event. Delete zip file if exists before download.

01/11/09	Fix download update bug when using automatic file extraction.	
	
		Fix DisplayAsOxide bug in CalcZAF.

01/09/09	Fix Acquire and Automate window position code (add save position to activate event).
	
		Skip loading current conditions for detector biases if detector biases are zero.
	
		Add files to TestFid distribution.

01/08/09	Modify SX100 set column conditions code to better load from off condition.
	
		Remove dead code found by Project Analyzer.
	
		Fix formula problem in CalcZAF with oxygen.

		Fix Penepma batch mode copy problem.
	
01/07/09	Add Update Sample Data Files menu to CalcZAF.
	
		Fix disconnect bug in PFW update OnProgress event.
	
		Fix FormMOVE and FormSTAGEMAP activate events to save window positions.
	
		Fix splash screen (remove form bitmap reference) and use only Image control bitmap.
	
		Fix EDS table reference in DataReplaceSample (thanks Paul).
	
		Modify TestType to also test image shift.

01/02/09	Fix Get Image Shift code for Jeol 8900 (thanks Dave Adams).
	
		Add update menu to CalcZAF (web site only).
	
		Add new menu items to documentation.
	
		Rebuild help file because context mapping got offset.

01/01/09	Happy New Year!
		
		Rebuild distributions.

12/31/08	Add Update PFW menu to Help menu in Probewin. Uses FTP or HTTP protocols to download the update zip file 
		and a small batch file to extract it once the program has closed.
	
		Modify format of increment in wavescan window.
	
		Fix information text in ScanData form (resize).
		
		Add menu for resetting window positions to default.
	
		Small bug fixes (mostly display issues)
	
		Remove "Remote Command" client control reference in projects.
	
		Remove all EDS weight percent interface code and references (Edax and PGT).

		The above entailed many, many changes to the general code base. This means however that the Automate option of e-mail 
		errors will now work with secure e-mail servers (thanks Dave Adams).
	
12/29/08	Add new secure SMTP and other TCP/IP controls. This is mainly for SMTP e-mail messaging. See the new
v. 8.11		keyword: SMTPUserName, in the [general] section of the PROBEWIN.INI file which should be set to the e-mail 
		account user name. The e-mail password will be prompted for automatically and retained only for the current run.

		Update documentation and help file.
	
		Add overwrite original parameters because user changed them in COND.BAS and DataRun.Bas:
		OriginalBeamMode% = DefaultBeamMode%
		OriginalBeamSize! = DefaultBeamSize!

		This may fix problem with user runs dropping into "analog scan mode" unexpectedly.
	
12/19/08	Work on interval, parabolic, pre/postscan and PHA scan data save routines to fix problems 
		from code changes involving saving all ROM scan data.
	
		Add arrow keys to implement spin buttons for MOVE window (and WAVESCAN window).
		
		Update documentation to note that joystick polarity values are used to set Move window stage spin 
		buttons (Scotty).
	
		Fix paste text issue in log window (do not use shortcut key in menu because it causes double paste behavior).
	
		Work on TRACOR spectro scan code.
	
		Fix holiday greeting bug (double message).
	
		Fix ROM scan bug for SX50 (created when modified ROIM scan data saving).
	
12/18/08	Add context sensitive help for Help menu.
	
v. 8.07		Modify ROM peaking code to save all scans (fine, coarse and 2nd fine), also both initial and
		final TRACOR ROM scans.

		Fix problem with ForceNegativeKratiosToZero flag in INI file (was being reset in InitData).
		
		Found that serial input code was not handling ASCII null (Chr$(0)) values properly since
		32 bit VB interprets the values as 2 Byte Unicode characters. Fix TRACORStringInput and
		remove "repair" code from TRACORConvertReal.

12/17/08	Work on Tracor/Thermo interface. Fix input routine to handle ASCII nulls.

12/16/08	Work on Tracor/Thermo interface more. Fix minor counttime and stage position issues.
	
12/15/08	Adjust TRACOR interface to handle 2 byte floating point strings returned from PAC.
	
		Tweak Penepma code more.
	
		Create SPEC.INI test configuration (JEOL setup, 3 spectrometers, no stage)
	
		Add context sensitive help for menus.

12/13/08	Work on disabling buttons and menus if no tunable spectrometers or no stage motors.	
	
		Work more on batch mode for Penepma.
	
		Zero out elapsed time variables in ProbFormClose.

		Add spin buttons for stage increment moving to FormWAVESCAN for IncrementReset.

		Fix Stage increment for wavescans (needed call to get current stage positions).

12/11/08	Fix quick standard time calculation when used with Automation.
	
		Fix time calculation for quick standards if run automatically or not.
	
		Add some EPMA birthdays to RealTimeCheckHolidayGreeting.
	
		Add "Delete All Elements" button to Element Setup dialog (Fournelle).
	
		Improve Browse for Folders dialog (uses new Shell32 styles). Used by Find File menu.
		
		Add help context to menu items. To get help on a menu item simply highlight with the mouse and hit the F1 key.

12/10/08	Work on PENEPMA batch mode.
	
		Work on PENEPMA batch mode (not finished yet).
	
		Add Get/Set Beam Mode calls to Remote interface (must call RemoteImageInit function first).
	
		Fix problem with combined analysis with volatile data in one of two samples (volatile data must be in first sample)
		(thanks John)
		
		Add turn off probe scan during MDA set beam current (Jeol only).

12/7/08		Fix rich text log window error message problem (remove doevents statements) from IOWRiteLOgRichText
		which caused weird problem in ElementCheckXray.
	
		Work on Penepma08 interface.
	
		Fix fixed spec problem in TimeCalculate code.
	
		Add AutomateNewSampleBasis confirm text to AutomateConfirmSelected msgbox.

12/4/08		Add enable/disable for fiducial combo in FormAUTOMATE (Probewin and Stage).	
	
		Modify RealTimeFaraday to leave faraday cup out (or beam unblanked) if faraday cup is not present (ARL).
	
12/1/08		New menu in StartWin to skip setting analytical or column conditions for count or wavescan if checked. Add 
		code to set conditions for wavescan in Startwin.
	
		Start work on secondary fluorescence phase boundary code (Llovet).
	
		Add PHAFirstTimeDelay code to add time delay after setting PHA for the first time in case there are
		large bias voltage changes that require some time for bias gain response for detector.
	
		Add fix for X and Y stage only for RealTimeMoveStageMotors.
	
		Fix disable control code for TestType.
	
		Add read for image shift to UseCurrentConditionsAlways and UseCurrentConditionsOnStartup codes.
	
11/29/08	Modify Demo/Jeol SetBeamCurrentMDA codes to iterate more efficiently and give more appropriate 
		debug output.

		Also modified t-test (C.I.) calculations to use blank and interference corrected peak intensities but
		only a very small change in results.
	
		Modify analytical sensitivity calculation to use blank and interference corrected peak intensities (Thanks 
		Celeste). This is necessary where a large blank correction is implemented and the peak intensity approaches
		the bgd intensity.

11/24/08	Modify image shift debug output.
	
		Add extra debug statements to TestType for testing Thermo StageColumn Automation interface.
	
		Set image shift parameters in JeolImageSetBeamMode for all three beam modes after set SGSP.
	
		Add read for image shift (Jeol 8900/8200/8500 only) in FormCOND and FormGETCOND when reading beam modes.

11/23/08	Add ForceNegativeKratiosToZero flag to [software] section of PROBEWIN.INI file.
	
		Add fix for bias voltage on/off menu (for fixed spectrometers).
	
		Fix TDI bug if TDI element is disabled for quant (Thanks Paul).
		
		Fix Startwin for fixed spec bug.

11/18/08	Fix TE Jeol 8500 set HV command to use TVAS (not TAVS).

11/17/08	Work more on conductive coating energy loss code. Move call to ZAFPrintStandards to ZAFStd.	

11/16/08	Work more on conductive coating energy loss code.	
	
		Tweak Thermo stage/column interface.

		Fix problem with Jeol 8500 TFE gun status call in JeolGetColumnConditions2 (thanks Brian G.)

11/11/08	Add Thermo.bat for testing Thermo-Tracor interface (InterfaceType% = 7).
	
		Make sure Penepma material file names are less than 20 character including extension.
	
		Add ThermoInitInterface functions for stage and column control.

11/10/08	Fix 8900 range checking in InitINIHardware.
	
		Work more on Thermo stage/column interface (add TNColumnStage Type Library to selected projects).

11/9/08		Add Jeol_j8K flag for 8500/8530 driver calls.
	
		Add photon detector geometry to Cu_Back.in Penepma base file (was missing).
	
		JeolCoarseCondenserCalibrationDelay=0.1		; in seconds (0 to 2 seconds)
	
11/6/08		Add JeolCoarseCondenserCalibrationDelay to [hardware] section of PROBEWIN.INI to add delay during
		coarse condenser calibration.

		Start work on Thermo-Tracor interface: (Thermo Stage/Column-Tracor WDS/Faraday)
	
		Modify Auto-Digitize to use current "Shotgun" digitize parameters.

11/1/08		Update documentation for new Auto-Increment and Auto-Digitize features.

		Add AutoIncrement and AutoDigitize controls for Digitize window (Dave Crabtree).
		
		Fix problem with halogen subtraction during analysis if duplicate halogen elements and 
		DisableQuantFlag is utilized.
	
		Fix problem with registration name display (InitData).
	
		Fix problem with "replicate" wavescans in Automate! window. (Fournelle)
	
		Add additional text to MAN error if standard is missing.
		
		Fix formulas for CalcZAF.dat examples.

10/26/08	Add (P+B) note to volatile element plots (Fournelle).
	
		Fix problem when using All Matrix Corrections and analyzing selected lines. (thanks to Chi Ma)

		Modify registration code to create security file differently under Vista.


10/10/08	Add database fields for interference order and aperture number. Modify standard assignment dialog.
v. 8.06	
		Fix forcing parameter output in Penepma interface.
	
		Fix match database issues in Standard.exe

9/25/08		Work more on vacuum app for Paul

9/22/08		Adjustments to fiducial selection and set number control reload if positions deleted or
		unreferenced fiducial deleted.
	
		Add dropdown list to select all standards with specified fiducial number.
	
		Add demo code for digitize polygon (stage) with randomized positions in x, y and z.

		Add support for multiple apertures for Jeol 8900/8200/8500. See help file and new INI file
		keyword (JeolCondenserNumberOfApertures)

9/21/08		Work on Jeol 8200/8500 vacuum readings.

		Fix AcquireDoPeak if combined conditions and element is disabled for acquisition (or not).
	
		Add code to AcquireDoSample to mark disabled channels as completed for combined conditions.
	
		Fix display of excess oxygen when using precision formatted results and hydrogen by stoichiometry are selected.	
	
		Fix display of stoichiometry oxygen for particle analysis in NORMOX%.
	
		CalcZAF now display filename and sample name in form captions when importing data.

9/20/08		Fix particle flag problem in AnalysisSingle2.
	
		Add warning if interference standard already contains another interfering element.
	
		Add limit to graph titles for samples names larger then 60 characters.
	
		Add code to skip loading specified elements for standards if analyzed.
	
		Add code to prevent loading specified element if already analyzed but not disabled for quant

9/10/08		Add delete button for specified elements in Specified Concentrations.

		Add "Stagger grid points option in Grid Rectangular. Improve accuracy of grid calculation of points.
	
		Add Lispix spectrum image "raw" file output for EDS data.

9/7/08		Fix minor labeling problem in PHA forms (bias and gain scan labels not showing).
	
		Update penepma08 installation document.
	
		Add code for Jeol 8500 vacuum reading from TFEStatus packet.
	
9/4/08		Fix Cameca registry keys to use REG_DWORD for Bruker HV and Mag interface.
		
9/2/08		Create SX50Column.exe and SX50Column2.exe for reading HV and mag from SX50 for Bruker
		system running on secondary computer and communicating over a serial port. Run 
		SX50Column.exe on PFW computer and SX50Column2.exe on secondary computer running Bruker.
		Be sure that serial port parameters in PROBEWIN.INI are properly sent for each.

9/1/08		Add code for "Adjust" button for Penepma.	
	
		Fix EABS problem with Penelope code.
	
		Fix file open problem in TestType if started first.
	
		Comment out error check after calling Thermo TEVB_Disconnect function.

8/28/08		Remove "SPF0 LUN REMO ACI3" call in SX50InitInterface.
	
		Work on SX50Column.exe.

8/27/08		Fix Thermo start server code.

		Create small utility to read serial port for SX50 and write HV and mag values to
		Cameca registry for Bruker EDS interface.
	
		Fix Thermo start server interface to support Thermo NSS (system 7).

8/26/08		Add "NumberofStageMotors" value to Run table for proper relative distance calculations
v. 8.05		off-line.
	
		Add check for missing std and MAN assignments
	
		Work on Sx100 image source selection (need to use 4 image window display mode for 2nd 
		video channel selection).

8/24/08		Add warning for different background types in AcquireStartSample. 
	
		Fix text strings in FormSPECIAL regarding "volatile".

8/17/08		Make new dialog and code for Penepma08 version.
	
		Add check for significantly different stage position before giving the .Refresh method
		to StageMap. On Jeol instruments there is stage jitter that causes this to be called 
		constantly. See MotBacklashTolerances parameter in MOTORS.DAT line 18.
		
		Add Penelope and Penepma copyright and acknowledgements for Cesc and Xavier for
		secondary fluorescence.
	
		Change all mentions of "volatile" to "Time Dependent Intensity (TDI)" in both 
		user interface and documentation. Massive amounts of code changes (Paul 
		Carpenter).
	
		Fix exit with error if analog scan is not ok in AcquireStartSample.
		
		Fix click weirdness in CalcZAF when loading data file in mode=0 after opening ZAF options
		dialog.
	
		Add error trap from SX100 "pic" (peak) not found during peak center.

8/13/08		Replace more numbers with constants (e.g., MSECPERSEC)
v. 8.04	
		Add button for edit Penepma input file.
	
		Disable update excess button in Standard.exe if DisplayAsOxide option is not selected.
	
		Add flag to not display empirical MACs if not loaded flag is set. make sure display is
		current.
	
		Warn user if using analog scan mode (first time only if click OK).

7/30/08		Fix major data loss bug in GetElmSave where 

		GetElmOldSample(1).VolCountTimesStop(j%, GetElmOldSample(1).LastElm%) = GetElmTmpSample(1).VolCountTimesStop(j%, i%)
		GetElmOldSample(1).VolCountTimesStart(j%, GetElmOldSample(1).LastElm%) = GetElmTmpSample(1).VolCountTimesStart(j%, i%)
		'GetElmOldSample(1).AbBeamCountsArray!(j%, GetElmOldSample(1).LastElm%) = GetElmTmpSample(1).AbBeamCountsArray!(j%, i%)
		GetElmOldSample(1).OnBeamCountsArray!(j%, GetElmOldSample(1).LastElm%) = GetElmTmpSample(1).OnBeamCountsArray!(j%, i%)

		were not being saved. Possible data loss for combined condition and volatile samples under certain
		circumstances.
	
7/20/08		Work more on PENEPMA input file creator code.	
		
		Work on PENEPMA input file code.
	
		Additional formatting of output in CalcZAF for model electron and x-ray ranges.

7/19/08		Fix problem of re-loading of FormIMAGE when closing FormIMAGE.

		Add extra second delay before loading final hv in SX100SetColumnConditions to attempt to
		avoid occasional "Maximum Request Exceeded" errors.
	
		Fix Y increment bug in AcquireDoAutomateNext (move code to AcquireDoAutomateYIncrement)
	
		Modify Calczaf to allow oxide (and other) options in calculate intensity mode (Carpenter).
	
7/13/08		Modify DigitizeImageStart/DigitizeImageGet/DigitizeImageStop to skip setting beam modes, scan 
		speeds, magnification, etc if CheckSkipBeamModes checkbox is checked. (thank you so much to Severin!)
		so that a "raw" image capture can be obtained using the Matrox boards though this new feature will
		affect all other image interfaces as well.

		New help files.
	
		Disable new sample button in FormIMAGE if only acquiring images.
	
		Fix CalcZAF to handle combined calculated and excess oxygen.

6/30/08		Modify CalcZAF to allow oxide and atomic percent output.
	
		Load current sample name from FormACQUIRE and FormDIGITIZE depending on where the
		FormIMAGE is loaded from.
	
		Work on elapsed time calculation projection for combined conditions.

6/29/08		Add new sample button to FormIMAGE when digitizing positions.

		Fix name of sample in CALCZAF.DAT example file (change Fe2SiO4 to Fe2O3).
	
		Add reset button for re-drawing grid boundary in DigitizeImage.
	
		Add z stage position to image data (create 4 variables, one for each corner for future use).
	
		Add checkbox for manual sample selection in FormPLOT
	
		Replace some values with constants (MSECPERSEC, EVPERKEV, etc)
	
		Add beta factor output in CalcZAF if calculating intensities and using alpha factors.
	
		Add detail text for CalcZAF listing of absorber-emitter pairs MACs.
	
		Fix InitWindow code if form is maximized.

6/21/08		Fix problem in plot zoom code if x axis is not user defined.
v. 8.02

		Modify Olivine 1.0 um particle example data file.
	
		Fix error in PlotSetXYStageIndex if no elements.
	
		Change button color (to yellow) in FormGRIDP.

		Prevent thin particle calculations if alpha factor corrections are selected.

6/12/08		Fix SX50 call for get scan rotation angle (SX50GetColumnParameters).

		Fix beam current display if combined conditions (only print arrays).
	
		Fix apps for close image interface (Matrox driver needs to be closed). Thanks Clayton.
	
6/9/08		Quick fix for CalcZAF grid display (thanks Ryna).

		Add Excel output button and options to CalcZAF (atomic, oxide and formula options disabled for now).
	
		Add position of analysis positions scaled to actual beam size in DigitizeImage and ImageDisplay.	
	
6/8/08		Modify Calczaf more (combined sample support for multiple kevs, etc)	
	
		Modify TestType to read and write PFW config files.

6/6/08		More mods to CalcZAF (Carpenter)

		Modify ImageInterfaceType = 7 to use NTSC resolution framegrabbing	

		Modify Digitize Image dialog to use Single Points as the default.

6/3/08		Yet more CalcZAF tweaks for the Paulster.

6/1/08		More CalcZAF tweaks for Paul.	

		Add confirmation of number of digitized points in image polygon digitize feature.

5/31/08		Add SX50 image source selection for Matrox interface.

5/30/08		Tweak Matrox image interface again.

		Finish Matrox interface for SX50 (ImageInterfaceType% = 2).

5/29/08		Additional changes to CalcZAF (ZAFEquationMode) and cation total.

		Fix CalcZAF UpdateStdElements problem.
	
		Add Add Standards button to Standard Assignments dialog.

5/27/08		Finish Matrox image interface code (thanks Brian).

		Add formula calculation options to CalcZAF and ZAFPrintSmp output. (Carpenter)
	
		Add compositional entry for ZAF calculations by atom, weight and by standard. (Carpenter)
	
		Modify AbsorbGetMACJTA to check for energies less than 1 keV and skip if so. (Carpenter)

		Modify XrayGetPositions to make sure NoMotorPositionBoundsChecking(motor%) = False to enable range
		checking. Modify error message in WaveSave to print out of bounds position. (Carpenter)
	
5/24/08		Modify "zoom" code to not zoom if zoom ratio is too large (to prevent problems when just clicking 
		on the plot for say placing off peaks).

		Fix problem with AutomationBasis flag getting changed even if clicking "cancel" button in Automate! 
		"Conditions" dialog
	
		Modify Standard.exe to only perform MQ output if MQOPTIONS dialog is visible (on some computers in
		"guest" login a File/Access error is generated.

5/14/08		Modify Matrix active-x app to return a -1 (TRUE) if no x-ray data exists for the element x-ray combination.

		Add MatroxInit call to use meteor-11 board constant.
	
		Add more error output to SX100LoadColumnCondition.

5/11/08		Modifications to CalcZAF output for Paul Carpenter for Lehigh advanced analysis course.

5/5/08		Fix bug in percent error calculation (raw on-peak counts and beam current were not getting aggregated
		properly). Found by Allison Payne. Bug did not affect actual weight percent results.
	
		Add ability for importing a previously acquired wavescan samples from another run (for Heather and Paul)
	
		Fix "OneSigma" bug in SampleLoadGrid (was not renormalizing intensities to beam and deadtime). Added
		call to TypeCalculateOneSigma to be same as in TypeCounts.

5/4/08		Forgot to re-compile Userwin.exe for MiscConvertTimeToString overflow error (now re-compiled).
	
		Fix amphibole/biotite "file already open" output bug (P. Carpenter).
	
		Re-compile help file.

4/19/08		Re-arrange PHA bias/gain scan controls for more intuitive layout.

		New feature! See Automate! window for new automatic re-standardization interval. Program will run standards 
		every n hours automatically and re-start the unknown sample where it left off. (thanks to Heather Lowers)
	
		Add different line color for each y axis data set in FormGRAPH.
	
		Add "Move To" buttons in PictureSnap calibration window (to aid in re-calibrating image).
	
		Change warning of renumbered fiducial set in DataMakeNewSample to timed message box if running automation.
	
		Add warning to log window if user selects sample, file or multiple sample setups and none are assigned.
	
3/23/08		Fix row selection problem in Automate! grid when auto-focus is selected (digitized autofocus on subsequent points).
	
		Add button to stage bitmap calibration dialog to read PROBEWIN.INI [standards] stage bitmaps values without
		having to re-start the application.

		Fix cancel bug in formula entry in Standard.exe.

3/15/08		Update XYSCAN.BAS and XYSCAN2.BAS Surfer "scripter" files to use "C:\Userdata\" as the default directory to 
		find the sample auto gridding data files in.

3/9/08		Add new (v3) SX100 driver call for SX100_ReadCurrentAbs.
	
		Fix cancel problem with custom output formats (now works for both log window cancel and Analyze! window
		cancel buttons).
	
		Fix MiscConvertTimeToString overflow.
	
		Add SX50 calls for Matrox image interface.

		SpectrometerROMScanMode = 0  ; SX100 only, 0 = absolute scan, 1 = relative scan
		
3/8/08		Add more error text to SX100GetErrorText. Add absolute and relative scan mode option to PROBEWIN.INI
		for SX100 spectrometers only. 

		Modify GetElmAll to set AllAnalysisUpdateNeeded = True if the disable quant flag changes for a
		standard sample.
		
		Modify DataCorrectDataAggregate procedure to be able to call aggregate intensity routine separately
		and reference unknown sample for disable quant flags for proper loading of standard intensity arrays.
		This change will allow the standard to have different disable quant flags than the unknown sample
		and still have the UseAggregateIntensitiesFlag work properly.
	
		Add Matrox specific code to DigitizeImageLoad.

3/1/08		Fix problem in PlotGetSelectedData for runs containing more than 32,000 data points. Thanks Paul.

		Change SX100 command request deleted to warning.
	
2/25/08		Update documentation, many bug fixes and enhance security.
v. 8.01

2/21/08		Add "force analytical update" flags to GETCOND calls in case nominal beam was modified (to
		load new standard/MAN/Interf counts).

2/17/08		Work on Matrox image interface.

2/11/08		Fix fixed spectrometer issues (GetElmSetElmCrystalUpdate and RealTime procedures).

		Add actual total acquisition time to USER.MDB (displayed in Probewin in Acquire! in debugmode.
	
		Work on Matrox image interface.

2/10/08		Update reference manual.
v. 7.45
		Fix coating flag issue (still not enabled until finished coding)

		Work on measured excess oxygen disable quant and aggregate intensity disable acquisition issues.

2/9/08		Modify SX100SetColumnConditions	to load heat, then hv.
	
		Add caching code to SX50 get position, crystal routines.

		Modify MiscParseStringToStringA to handle sub strings of arbitrary length.

1/28/08		Work on final quantitative code for Bruker interface. Ta da!

		Add print sample setup after OK in Peak/Scan Options in Acquire.
	
1/27/08		Work on Bruker interface more (quantify spectrum function).

		Work on Bruker interface more.	
	
		Add sample name text for sample setup and multiple sample setup display in Automate window.
	
		Add display flip for coordinates to ACQ file PictureSnapSaveCalibration2.

		Add save thin film export parameters to data file.

1/26/08 	Modify StrataGem output to use 0.0002 as minimum k-ratio to output.
v. 7.42	
		Get Bruker spectrum acquire working.

1/20/08		Add smoothing to wavescan plot.
	
		Fix ROM peak getting reset between pre and post scans (Carpenter).

		Work on Bruker interface.

1/18/08		Updated documentation of ROM peakscan range calculation.

1/14/08		Work on SX50 ROM scan. Make new PFW distribution files. Make Evaluate variation plot line numbers
		visible only on expanded plot.

		Fix scan speed (DXRS) in JEOLSetColumnConditions2.

1/10/08		Disable digital scan mode in JEOLSetColumnConditions2 (DXMS).

		Many changes to database text field lengths to handle long path filename for column conditions.
	
		Fix printout of f(chi) in Standard.exe.

1/9/08		Changes to JeolSetColumnCondition2 (8200 load column conditions).
v. 7.41
		In ZAFReadMu if no MAC available use MAC of 10 for k lines, 100 for l lines and 1000 for m lines.

		Comment out code in ZAFReadLn that forces absorbers to default x-ray line (not sure why it was there).

1/5/08		Add oxide k-ratio calculation and Excel export to CalcZAF for binary alpha factor calculations.

2/4/08		Add multiple corrections for alpha-factor plots.  Fix Standard.exe for hydrogen in standard
		sample if using alpha-factors (Carpenter).

1/1/08		Fix CalcZAF alpha-factor plot to also output Ma x-ray lines. Fix SiIr1.Dat sample Calczaf 
		file for Ir x-ray line typo (should be Ir La).

12/31/07	Add Penelope output file code (not finished).

12/27/07	Change the way self-volatile sample assignments are handled. Now self volatile assignments
v. 7.32		can be done on multiple sample selections.

		Work on Matrox and SX50 imaging code (implement MARK beam deflection).

12/26/07	Get Bruker demo server running (finally). Work on Bruker interface.

		Add constants for 32000 for speed. Add time calculation for column conditions change if using 
		multiple setups.

12/23/07	Modify PlotGetData to handle more samples.

		Rough out Matrox.bas code.

		Add default correction and ZAF flags to PROBEWIN.INI.

		Add flag to disable full quant interference for demonstration (educational) purposes.

12/15/07	Add "(one sigma)" text to results output for analytical error.
	
		Fix sx100 default image scan speed (Carpenter)

12/9/07		Fix CalcZAF for carbon by stoichiometry (carbonate analyses) when using manual data 
		entry (Fournelle). Also handle import when same standard is used for more than one element.

		Skip ROM scan values greater than 1E10^8.

12/6/07		Fix Evaluate for StandardGetIndex

12/03/07	Add DoEvents to StartPHAGetPHADistribution2

		Add autofocus time to Automation time calculation (based on autofocus style flag)

12/02/07	Update CalcImage to use new calls to init standard index and ZAF dynamic variables.

		Add debug statements to Bruker EDS code.

		Handle command request deleted error in SX100StartCounts.
	
		Load FormANALYZE position in ProbFormOpenOldFile.

12/01/07	Add SX50 ROM spectro scan calls for new v3 SX50 driver.
	
		Make Remote and Matrix Readme.txt files for distribution update zip files.
	
		Change max peaking deviation in INI file to 80%.
	
		Fix Startwin problems with analytical mag and read current conditions. (Carpenter)

		Fix toggle for resizable wavescans (and peak scans) if graph is maximized, resized and then toggled
		again.

11/20/07	Add error 1020 to SX100 trap (vac not ready).
	
		Make wavescan form resizable (Carpenter).
	
		Add menu and checkbox controls to PictureSnap and StageMap to force beam blank during stage
		moves.
	
11/18/07	Add controls to testMatrix test app to check get crystal calls in Matrix server- 
		everything works. Add additional error trapping though in case zeros or blanks are passed.

		Re-compile and make new Matrix distribution.

		Add no beam blank for MoveStageMove and MoveStageMoveXYZ (Stage Map and Picture Snap) (Carpenter)

		Set Jeol stage backlash during JeolInitInterface. (P. Carpenter)
	
		Add disable ROM based stage jog for MoveMotorIncrement code to disable jog during wavescan 
		stage increments. (H. Lowers)

11/11/07	Modify JEOL set column conditions to properly set ACC status.

		Re-create distributions for Matrix and Remote.
	
		Increase maximum number of crystals in CRYSTALS.DAT to 60.
		
		Modify SX50GetFaraday to try again if first beam current reading was bad. (Fournelle)
	
11/10/07	Add fix for SX.mdb import to not load coating elements.

11/4/07		Add more global variables for coating parameters and standard coating dialog.
	
		Work on JEOL perl import (Carpenter) for standard compositions.
	
		Add SX100 error 109 (bad pic) as warning.
	
		Modify PHA printout (TypeSampleSetup).
	
		Add JEOL 8200 auto contrast brightness command. 
	
11/3/07		Add standard parameters table for coating parameters.
v. 7.31

		Work on Bruker interface.
	
		Add two Copy to Clipboard menus for PictureSnap. Add Print Setup menu to PictureSnap so user
		can select PDF printer for digital image with plotted stage positions (Eckert).
	
10/27/07 	Modify Automate time calculation to include stage motion time to each sample and to each point 
		within a sample.	

		Change PictureSnap display position menu labels for clarity (Thanks Paul).

10/18/07 	Fix XrayCalculatePositions code to account for JEOL spectrometer jog of 0.5 mm.

10/13/07 	Work on JEOL linefeed UNIX import format.

10/8/07		Fix Matrix and Remote default installation folders.
	
		Add new speed limit for JEOl up to 500000 (5mm/sec) for 8200 and up to 400000 (4mm/sec) for 8900.
		
		Add code to prevent automation from continuing on unknown or wavescan samples if any spectrometers
		did not properly peak.
	
v. 7.24		Add quickscan Hi and Lo range parameters to Current parameter table. Modify printout again to use
		new parameters.

10/6/07		Fix two problems when using duplicate elements and different x-ray lines and various combinations
		of disable quant flags are used.
	
		Change printout of quickscan limits in TypeWaveCounts.
	
		Change motor position out of limits error to log window output only for JEOL interface.

10/5/07		Add 2 mm "slack" at spectro limits for JEOL 8900/8200 quickscans.

		Change Add/Remove program names for installation to start with "ProbeSoftware".
	
		Don't allow less than 0.2% speed on SX100 for quickscan.
	
		Increase low limit start position for quickscan if JEOL.
	
10/4/07		Add check for synchronous in quickscans (if JEOL interface) so crystal flips are 
		synchronous.

		Add sample coating flags (element, density, thickness). See ZAFCalculateEnergyLoss.
			
		Add hydrogen by stoichiometry to excess oxygen calculation (for OH and H2O calculations)
		for Ed Vicenzi.
	
		Only print APF values if loaded.
	
		Allow combined sample analysis for elements disabled in either sample (Fournelle)
	
		Add sample description label for Image Edit dialog.
	
9/30/07		Add energy loss calculation to CalcZAF range dialog.
	
		Allow formula data entry on existing standards (warn if existing).
	
		Add total cation output in Standard if using oxide display.

9/28/07		Document AMPHI and HALOG file output.

		Add Load button to Model background dialog to load selected sample background fit 
		parameters. Note this is in addition to the Load Background Parameters button. Doh!

9/23/07		Add import capability for Cameca peakSight sx-97.mdb standard coordinates to .POS.

		Update documentation for MagnificationType keyword in INI file.
	
		Add new functions to Matrix.exe server to get crystal flip positions, number and current
		crystal. Also get and set matrix correction and MAC strings and modes. 
	
		Add control to allow calculation of interferences from any element in Standard Assignments 
		dialog.

9/22/07		Document Monitor and GunAlign applets.

		Allow conditions button enable for wavescan samples in Analyze! window.

9/06/07		Fix volatile output problem from Output menu (Carpenter).

		Add amphibole and biotite flags to probe data files and OPTIONS dialog.
	
		Add EDS spectra interface parameters for off-line reprocessing.

9/02/07		Work on Ague amphibole and biotite codes.
v. 7.22

9/01/07		Add Cameca SX100 PeakSight import for sx.mdb standard database file.

		Add Select Standard Database menu to CalcZAF for selecting non-default standard databases	
	
		Add O Ka in U empirical MAC.
	
		Add short delay in SX100 load column condition code for rare "system not ready" problem.

8/31/07		Fix array dimensioning problem in SIS get image function.

8/27/07		Work on Edax net intensity problem for Severin.

		Work on Bruker interface also.
	
8/25/07		Risky move. Remove most calls to set RealtimeInterfaceBusy for modal dialog calls. 
	
		Should be ok now that status and cancel dialogs no longer pop up, but look for problems
		when modal dialogs are loaded, e.g., Elements/Cations dialog for example.

		Fix printout issue for List Report (keV value)
	
		Modify Thermo start EDS spectrum code to call get preset time code.

8/18/07		Continuing work on Bruker EDS spectra interface.
	
8/16/07		Modify DataMotor to ask update Motor table if realtime mode.	
		
		Add voltage to List Report header.
	
		Add TestMatrix.* to Matrix update zip.
	
		Modify Sx100 error messages.
		
		Add Re-Load button to variation window (Evaluate).

7/24/07		Fix correlation output for Evaluate. Add correlation output for Probewin (numerical only) on a sample
v. 7.21		by sample basis.
	
		Fix clipboard calibration file save.
	
		Add function to query database through matrix active-x server based on spectro number and optional
		crystal number. Add test function to TestMatrix program.

7/21/07		Add calculation of Pearson's correlation coefficients to Variation plot (log window) in Evaluate.exe
	
		Add call to AnalyzeLoad when loading Probewin to make sure blank sample array get initialized.
	
7/18/07		Add menu to Standard menu to allow user to select a different default standard database. Useful
		for opening a probe database file from another laboratory.

7/14/07		Add element setup database query for Matrix active-x server. To be used for Probe Image for 
		users to select elements to acquire x-ray maps.

		Move JEOL ROM scan code to separate routine. Add debug statement for changed counttime and
		reduce minimum scan speed to 1000 (0.01mm per sec).

7/13/07		Increase maximum elements per sample to 72 (make some ZAF arrays dynamic).

		Only warn wavescan limits inside off-peak positions on wavescan sample.

7/12/07		Increase number of elements per sample to 60, number of standard per run to 64.
v. 7.20	
		Add some image parameters to Run table.
	
7/9/07		Remove "Thank-you for registering Probe for Windows" message in RegisterLoad
v. 7.19		for TestType. File already open problem seems to have fixed itself!

7/6/07		Add "stationary" scalebar to PictureSnap (Cornelius).	
	
		Add resize events code to variation plots for Evaluate.
	
		Add Demo images to source (data) zip.
		
		Add nominal beam current field in Analytical Conditions dialog, so that
		nominal beam can be edited in off-line mode. (Severin)
		
		Fix analysis position plot problem for PictureSnap where all coordinates 
		for all sample types were getting plotted. (thanks Scotty)
7/4/07		Add force negative k-ratios to zero flag.
v. 7.18	
	
		Continue work on variation plotting.	
	
7/1/07		Optimize database speed using more string constants.
	
		Replace many literal null strings "" with vbNullString constant.
	
		Add CalcZAF and Evaluate menus to ProbeWin.

6/30/06		Start work on "variation" plotting in Evaluate.
	
		Add output for images (via clipboard for scale-bar etc)
	
6/28/07		Modify Transaction.bas to increment transaction counter for nested 
		transactions. Add close to commit transactions to probFormCloseFile.

		Add comments to thin film/particle dialog.

6/27/07		Modify Data.bas to call TransactionCommit after DAO object update.

6/18/07		Add demo mode for Cameca ROM spectrometer scanning. Modify demo scan so random offset is not 
		applied during demo ROM wavescans (only peak center scanning).
	
6/17/07		Add multiple matrix correction option in Analyze! window to calculate all matrix 
		corrections (Fournelle).
	
		Make MQ data default save to UserData folder.
	
		Adjust negative interference counts warning.
	
6/15/07		Modify ZAF routines to support negative intensity calculations (no longer necessary
		to use Bence-Albee factors for trace elements).
	
		Fix problem in DataGetMDBSampleOnly for out of range sample numbers.
	
		Add code to draw first point of polygon.
	
		Add code to update beam deflection center after image is acquired and no position data
		from Digitize Image mode.

6/11/07		Add checks for out of range unknown setup numbers in AutomateConfirmSelected3.

		Add polygon grid digitize image	feature. Whew! (thanks Ed).
	
		Fix errors bars in volatile display if negative intensities.

6/8/07		Add code checks for samplerow > 0 throughout (just in case).	
	
		Add control for Bragg order in Xray Database form.
	
6/7/07		Fix problem in PositionFiducialUpdatesSets.
		
		Fix FormZAF (CalcZAF) window position problem.
		
		Add MatrixCalculatePosition activeX public function to Matrix interface for calculating
		spectrometer position.
	
		Finally fix "ActiveX can't create component" error in Remote and Matrix (need to use binary
		compatibility option for distribution).

6/5/07		Check for graph control loaded in XrayLoadListXray.

		Add linear fit interface to Matrix server (normally for MAN fitting, but could be used
		for image quant using calibration curve).
	
		Add some tool tip help.

6/2/07		Implement iterated matrix blank correction code.

		Document blank calibration correction.
	
		Add option for aspect ratio control "icon".

5/31/07		Clean up text and scalebar code in image display. Add alternate scalebar units in INI file.
	
		Fix problem when loading file setup and reading images and scans from DataGetMDBIndex.

v. 7.17		Add blank calibration correction feature.
	
5/30/07		Modify MODEL form to integrate only when user clicks "Integrate" button.	
	
		Add density list to Xray and electron range calculation dialog.
		
		Add reset button for wavescan stage increment update.
	
		Modify wavescan and model background code to use globals and handle out of subscript range errors
		better when the user is clicking around trying to break my program (Fournelle).

5/29/07		Edit Edax code to fix 100% DT problem (Severin).

		Add DisableSpectrometerNumber flag to INI file for working around hardware problems (Fournelle).
	
		Finish Matrix.exe active-x component and TestMatrix.exe test application! Roger, Houston. That 
		calls for a glass of Tang!
	
		Modify code to automatically increment fiducial set number in position database if fiducial set
		number already exists in probe database. See DataMakeNewSample and DataFileSetupLoadData.
	
5/27/07		Add error message to WaveCalibrateReadWrite2 regarding change to number of spectrometers or crystals 
		in configuration files.
	
		Work on Matrix applet for interferences (add beta factor calculation for primary and standard
		intensity calls).
	
		Add update for beam deflection/column conditions after load column condition or change 
		analytical conditions.

5/26/07		Modify peaking code to check for large offset	
	
		Fix SX100 video stop if not scan mode.
	
		Fix matrix setup for Program Files.

5/22/07		Fix bias change delay problem with cancel.
	
		Make initial Matrix active-x distribution files and documentation.
	
		Fix problem in CurentCheckRealTime for wavescans and EDS acquisition flags (just ignore if
		wavescan sample).
	
		Fix volatile error bars for log plot. (Fournelle)
	
		Fix Measure button cycle cancel problem in GunAlign, Calibrate and Monitor.

5/21/07		Modify FormSETUP to allow users to edit MAN and interference setup databases.
	
		Work on active-x matrix server. Matrix iteration now working!
	
		Fix problem with rounding error when setting PHA window (10. > 10). (Eckert)

5/20/07		Fix restart of Cycle mode in Faraday. (Eckert)
	
		Add time for imaging in automation time calculation.
	
5/18/07		Modify Imaging Display to allow user to edit various items after acquisition and saving (double-
		click on Image list).
	
		Re-set scan speed back to fast in SX100 after image is acquired.
	
		Modify Image Display to allow user to edit image title (double-click image list)
	
		Fix Image Save To Database to use image title.
	
		Add error bar options to Volatile and Alternating On/Off intensity plot (Run menu). J. Fournelle
	
		Add bias off menu to several programs.
	
		Fix Evaluate for unusual samples (re-set arrays for each plot).
	
		Modify Edax code function calls to always pass function values instead of constants.

		Fix LOCATE form grid and DIGITIZE grid for "top row" code. Caused problems on some computers 
		(but only for P. Carpenter?).

5/11/07		Update and spell check reference manual.	
	
		Add interference standard intensity SETUP3.MDB to Save Setups code.
	
		Carpenter reports problem with setting toprow property in DigitizeLoadPosition.

5/10/07		Add code to check for (and skip) zero spectrometer position returned in JeolMonitorRead.
	
		Modify Drift.exe to save search results to clipboard (new menu item).
	
		Work on Matrix active-x app.

5/9/07		Make FormScan user resizable (for P. Carpenter).

5/6/07		Work on Matrix.exe active-x component more. MAN background database now working.

5/3/07		Adjust GRD file import for PictureSnap for JEOL coordinate stages.	
	
		Fix spline fit problem when xdata (spectrometer position) values are duplicated.
	
		Fix GRD file import (use twips instead of pixels for loading Calibrate dialog)

5/2/07		Grid file read/write format (v. 7) was not quite right for non-symmetric GRD files. Fixed.

5/1/07		Add grid file import for PictureSnap (MicroImage or ProbeImage stage coordinate images)
	
4/28/07		Have PictureSnap updated when user digitizes (or deletes) a new point or acquires a new point
		depending on whether displaying digitized positions or analyzed positions.

4/25/07		Add Go button to Automate! window. Fix "Reload" button.
	
		Work on Matrix active-x component.
	
		Add SE offset and BSE gain auto brightness/contrast values in INI files.

4/21/07		Add check for z out of range in three point PictureSnap (Carpenter).

4/19/07		Add suppress backlash flag for JEOL stage automation (Vicenzi)	

4/17/07		Make beam deflection center check based on tolerance in AcquireStartSample (thanks Amelia).

		Set scan mode before setting scan rotation (SX100).
		
4/15/07		Add call to update spectrometer position before storing current position for ROM scan in
		RealTimePeakScanStart.
	
4/12/07		Work on Matrix.exe Active-X matrix correction server app. See TestMatrix.exe.
	
		Fix "remaining automation time" format output to Automate form.
	
		Add user defined peaking flag time to TimeCalculate estimate (assume 90 sec).
		
		Fix PictureSnap GRD file output.
		
		Add maximum digit format flags to detection limit output.
	
4/8/07		Fix problem when using user defined peaking flags with automated unknown samples on JEOL 
		interface (need to process monitor packets during wait loop in AcquireDoAutomateNext)

4/4/07		Tweak imaging features for better response.
	
		Fixed bug in image data save and get. If user saved images all of the same dimension or of even multiples
		of the same dimension there was no problem. Now all is fixed. Sorry about that!
	
		Add resizable current image window with automatic histogram.
	
		Fix Analyze! Conditions dialog to update multiple samples.

4/3/07		Fix Sx100 beam deflection (remove extra y axis flip now that polarity flags are properly utilized).
v. 7.16	
		Add code to SX50GetMotorStatus to accept motor position if within 1 step and time out has been
		exceeded (for sticky motors).
	
		Finish SX100 video acquisition code.

4/2/07		Work on histogram display. Add to TestImage utility. Add black and/or white pixel suppression feature.
	
		Update misc test utility files.
	
		Modify CalcImage project file to use files in current project folder (make backwards compatible).

4/1/07		Fix CalcImage to properly display GRD files of all types!!!!!	Also to save current working directory.
	
		Fix grid file output from Display and Export Image dialog and also PictureSnap (now uses stage,
		and display polarity flags to ensure proper export in off-line situations). 

		NOTE: this means that when adjusting the polarity flags during initial instrument configuration
		a new database file has to be created for each polarity adjustment!!!!!!!!!!!!!!!!!! Or...
		even better use the TestImage test utility to determine the PROBEWIN.INI flags:

		Global ImageInterfaceDisplayYPolarity As Integer    ' acquisition flag to fix image display problems
		Global ImageInterfaceDisplayXPolarity As Integer    ' acquisition flag to fix image display problems
		Global ImageInterfaceStageYPolarity As Integer    ' acquisition flag to fix stage polarity problems
		Global ImageInterfaceStageXPolarity As Integer    ' acquisition flag to fix stage polarity problems
		Global ImageInterfaceBeamYPolarity As Integer    ' acquisition flag to fix beam polarity problems
		Global ImageInterfaceBeamXPolarity As Integer    ' acquisition flag to fix beam polarity problems

		before using ProbeWin to acquire images.
	
3/31/07		Add beam, stage and display (and registration) polarity flags for imaging to DataRun so that
v. 7.15		proper image and stage orientation can be calculated in off-line situations. 

		Modify DigitizeImageStart to only set analytical/column conditions if automated imaging.

3/30/07		Finish SX100 video acquire code (use ImageInterfaceType% = 6 in PROBEWIN.INI)
	
		Add 2048 resolution for imaging (SX100 Video only).

3/29/07		Add SX100 video imaging interface.
	
		Make display image histogram right side up.
	
		Adjust 16 bit overflow problem in Jeol imaging code.

3/27/07		Fix CalcZAF zip update.
	
		Add sanity checks to jeol image acquisition code.

3/26/07		Add histogram to image display window.	

		Add background corrected volatile intensity output (custom menu).
	
3/25/07		Modify image capture code to handle normalization and arrays better. Image polarity/display flags may need
v. 7.10		to be changed.
	
		Fix problem with stoichiometric oxygen and element by difference when using alpha-factors.
	
		Adjust color font for indicating empirical PHA value loaded (Carpenter).
	
		Only warn once in Peak/Scan Options if off-peaks are outside wavescan range.
	
		Fix typo in XrayCalculatePositions for order > 1. Fortunately it was always called with order = 1
		except for the Excel Active-X interface for calculating spectrometer position. Thanks to Paul C.
	
3/20/07		Modify initialization so that C:\UserData is default data directory to prevent problems
		under new XP and Vista security.
	
		Add modified (alternate) homogeneity calculations.

3/19/07		Modify volatile custom output format.
	
		Add custom output format for volatile data.

3/17/07		Modify how ROM spec data is saved (do not fit or save less = zero data points)

		Fix RealTimePeakGetCentroidData to skip zero values.
	
		Change SX100GetCounts order of status read

3/15/07		Add new sample flags for detection limits and homogeneity calculations.
v. 7.09
		Add warning for duplicate elements when not using aggregate intensity option.
	
		Adjust EDS parameter output.

3/13/07		Fix EDS net intensity normalization for counttime.
	
		Add Realtime interface call to get EDS preset for automation elapsed time calculation.
	
		Add check for front end detector selection change.
	
		Add count time normalization for EDS spectrum intensities.

3/12/07		Modify Thermo interface to fix TEPortal bug for DLL initialization (Greg Fritz will fix eventually).
	
		Add color change in text fields for out of range on-peak and EMPPHA load (Elements/cations window).
	
		Add Output menu items to documentation. Also new CalcZAF menus for standard calculations (Carpenter).
	
		Modify coarse iterations for Jeol beam current (MDA).
	
		Fix specify concentrations to handle specify by standard option when oxygen is calculated by stoichiometry.
	
		Fix alpha factor calculations to handle duplicate elements (Fournelle).

3/9/07		Fix PictureSnap print so it prints analyzed positions properly (Carpenter).
	
		Fix off-peak/wavescan limits issue when both are out of range (XrayCalculatePositions). Thanks to Paul Carpenter!
	
		Modify wavescan centroid to append sample name.
	
		Fix modal analysis code in Standard.

3/6/07		Fix Thermo EDS code for "WriteSystem".
	
		More work on wavescan centroid output.

3/5/07		Create empirical PHA buttons in GetElm and GetPHA forms.	
	
		Fix null characters in AMCSD database.
	
		Add new centroid output for wavescans (custom format #11)

3/4/07		Improve empirical PHA code (Carpenter).

		Improve model xray transmission calculation in CalcZAF.

2/27/07		Add AMCSD mineral database to Standard.exe.
	
		Many other small changes.
	
		Fix element by difference if duplicate element.
	
		Make "match" window modeless.

2/24/07		Update documentation for PFW and Remote.

		Fix Monitor analytical conditions to use default mag as default.

2/17/07		Fix Standard duplicate function to allow user to change standard number
	
		Add std number column to Evaluate output (Fournelle)
	
		Add current peak position for scan display.

		Create TestThermo EDS interface test program.

2/14/07		Minor changes to code to avoid bad SX100 ROM scan data

		Modify xaxis max graph plot for PHA bias scan in StartWin.

2/10/07		Add sample position type conversion to Position window.	
	
		Fix disable quant for element with no standard assigned (John Fournelle).
	
		Additional mods for Carpenter.

2/7/07		Document MatchStandardDatabase keyword in PROBEWIN.INI.

		Modify CalcZAF standard output format for Paul.

2/6/07		Add Match button to Analyze! window for matching compositions using different databases.

2/5/07		Fix CalcZAF ZAF output for standard output.	
	
		Also new export menu in Probewin for exporting standard analyses for CalcZAF processing (see Output menu in Probewin.exe).
	
		Add new "standard" format CalcZAF single line processing input capability (see Analytical menu in CalcZAF.exe).

2/04/07		Start work on active-x EXE Matrix.exe for image quantification for Probe Image.

1/31/07		Add calibrate button for electron image calibration.

1/27/07		Fix PictureSnap Z position bug (three point calibration).

1/23/07		Update documentation.
	
1/22/07		Add menu for detailed ZAF correction display in Standard.exe. Add export/import to tab delimited file
		for single row manipulation in Excel (Thanks Paul) for Standard.exe.
	
		Modify CalcZAF to allow samples names in CalcZAF input files (thanks Paul).

1/21/07		Modify GunAligh to use shift key for gun shift (more intuitive).	
	
1/17/07		Fix several places in the AMB DCX init code where if an unexpected error occurred the software
		would print either a blank error message or a wrong (old) error message.
	
		Fix background fitting problems in Model backgrounds (thanks John F.)
	
		Autoload stage map and digitize window in stage.

1/16/07		Add CalTech5.1.wmf stage map for demo distribution	
	
		Add conditions for NIST and Hanchar custom output formats to sample name line.
	
		Add image comment field to imaging window.
	
		Add channel order option in combined conditions dialog (Acquire!).
	
		Add ROM scan option in Peaking dialog.
v. 7.08
1/14/07		Fix mag problem in SX100ImageGet if in spot mode. Modify to use stage scan if less than ~800x.

1/12/07		Save scale bar options in FormIMAGE.	
	
		Add button for Add/Remove Standards to New Sample dialog.
	
		Load minimum keV if zero before setting emission (SX100).

1/9/07		Fix GetPHA code to use kilovolt, current, size arrays if combined condition sample.

1/6/07		Add color and text formatting capability to log window.

1/4/07		Fix ratemeter form timer that was always on!

12/31/06	Add z stage tilt correction for Picture Snap feature when using three point calibrations (Thanks to Paul Carpenter).	
	
12/29/06	Add ImageDisplaySizeInCentimeters to database tables so that analytical field of view is always
		accurate.	
	
12/27/06	Fix problem in ROM based wavescans to use actual returned spectrometer positions for angstrom 
		calculation (not RealTimeMotorPositions()).	
	
		Fix SX100 SetColumnConditions code to deal with beamsize oddity on SX100.

12/25/06	Tweak ROM wavescanning code. 
	
		Improve labels for Realtime scan graphs for peaking.
	
		Modify wavescan stage increment to utilize fraction microns (even for integer stage systems such as SX50/SX100)	
	
		Adjust elements/cations so that LLIF or LIFH matches LIF, etc.
	
12/23/06	Tweak ROM peaking so if ROM peaking fails (using initial position) the software reports
		the spectrometer peaked as "No".

12/19/06	Fix ROM quickscan and wavescan if one spectro scan finishes with no new data.	

		Add default optical light intensity parameters to INI file.

12/16/06	Add ROM spectrometer scanning support for SX100 and Jeol 8200/8900 for normal wavescans
v. 7.06		and pre and post peaking scans.
	
11/29/06	Modify wavescan graphs so forbidden elements are plotted when using 
		specific element option.

11/25/06	Add .KLM output file for wavescan export. See Output menu.	
	
		Modify Standard output for elemental or oxide and 24 oxygen basis for oxides. Sort output for export.

11/24/06	Add right click for listing position samples in Automate! and Position windows.

11/20/06	Improve wavescan plotting and processing speed (Thanks Paul, for the 1000 point wavescans).	
	
		Modify Evaluate to plot each standard set as a different color.
	
		Increase sample array (MAXROW) to 100 so that default sized wavescans are one sample.

11/19/06	Fix Analyze "Excel>>" button to handle wavescan samples.	
	
		Change to plotting routines to improve look. Add status bar to Plot! window.

11/18/06	Add custom output option for wavescans.
	
		Add count time to Scan Data display for PHA scans.
	
		Change y axis label to counts per sec in PHA acquisition window.
	
		Fix volatile assignment issue with no data samples.

11/12-16/06	Add check for changed Move window positions before PHA or ROM peaking.

		Add flag to only acquire automated standard positions if actually digitized (thanks Heather).
	
		Fix Monitor.exe auto-focus (thanks Paul).

		Add auto-focus options for Jeol in INI file. See:

		AutoFocusTimeCoarseScan=20
		AutoFocusTimeFineScan=20	; 1-500 msec 
		AutoFocusPointsCoarseScan=100
		AutoFocusPointsFineScan=200	; 50-1000 points
	
		Add volatile fit type for each element.

11/7-11/06	Changes to utilize new jeol driver. 
v. 7.05
		Modify XRAY.MDB so odd numbered higher order reflections fall off faster than even numbered order
		reflections. Need to download if you want this.

11/6/06		Enormous amounts of work on Jeol interface, Thermo interface and Calibration Curve display dialog.
	
11/2-5/06	Many changes to integrated intensity, add Savitzky-Golay smoothing. Fix bugs in SX100 and 
		Jeol 8200 interfaces. Use S-G smoothing prior to Brent's maxima fitting.

10/28-30/06	More tweaks to auto-focus/ROM peaking and multiple magnification changes.

		Massive changes to add magnification (analytical) and magnification (imaging) fields and data structures. 
		This will allow the user (H. Lowers) to specify separate imaging magnifications for each digitized position
		sample.

10/27/06	Massive changes to autofocus code to make it device independent. Change z backlash per Carpenter.

		Add remaining automation time to Automate window.

10/25/06	Lots of small changes to various routines!!
	
		Fix off-peak inside wavescan limit check.

10/16/06	Add maximum plot centroid to autofocus debug.	
	
		Add peak fitting to both Model Backgrounds and Display Scan Data dialog.
	
10/15/06	Many small changes to PFW. Improved display of auto-focus and ROM peaking data during debug (click
		on scan graph to update debug graphical display). 
	
		Leave StageMap loaded during automation
	
		Fix volatile element equation in AnalyzeCorrect to use 1/2 elapsed time (update documentation). Intensity
		now agrees with y-intercept calculation in Run menu.
	
		Change call to RealTimeImageGetBeamMode to use local variable only (for StageMap window).

10/13/06	Add centroid fit option controls in form MODEL. Display fitted centroid is GRAPH window.

10/11/06	Work on peaking issues.

		Fix some issues with ROM peaking (parabolic wasn't dropping into coarse scan if negative slope).
	
		Don't load kilovolts or beam current when using UseCurrentConditionsOnStartUpFlag is less
		then 1 keV or 1 nA.

10/10/06	Make improvements to auto-focus display (add ROM peaking scan data).
	
		Improve demo auto-focus to use noisy data to test code.
	
		Add AutoFocusType = 2 (maximum intensity value) for Jeol 8900/8200 instruments only.
	
		Add live view of auto-focus data if debug mode is turned on.

10/9/06		Add UseCurrentConditionsOnStartUpFlag to INI files.

		Fix problem with column condition text change event updating analytical conditions text fields even when
		analytical conditions is selected.

10/8/06		Finish "shotgun" digitizing. Works great- can't wait to use.	

		Use better calculation for gaussian fit deviation.
	
		Work on "shotgun" digitize method.
	
		Add both sample number and line (row) numbing to Image Display and PictureSnap (thanks to Heather Lowers).
	
		Disable backlash options for Jeol and Tracor interfaces.
	
		Modify init code to make PROBEWIN.INI directories.
	
		Fix problem with crystal flip and Acquire/Count window display of current crystal.

10/7/06		Add msgbox to ask user whether to restore gun condition after filament standby.
	
		Work on SX100SetConditions.
	
		Start with value of 2000 1/10th micron units.

		' Check for too slow scan speed (must be greater than MINROMSCANSPEED& per sec)
		If nrange& / (counttime! * nscanpoints&) < MINROMSCANSPEED& Then    ' new code 10-4-2006
		counttime! = (nrange& / MINROMSCANSPEED&) / nscanpoints&
		End If

10/4/06		New code to prevent Jeol ROM scan speed too low

		Work on EDS spectrum display interface (and Thermo NSS code).
	
		Work on column conditions more (SX100).

10/3/06		Add light control for EDS thin window to SX100 (and JeolSetColumnCondition)	
	
		Improve multiple peak centering dialog instructions and output (StartWin).
	
		Add add standards button to Digitize window. 

10/2/06		Work on SX100SetCondition code. Add get light status to StageMap (and scan status).

9/28,29,30/06	Work on parallel PHA acquisition, SX100 column setup and filament standby procedures.
	
9/26/06		Work on parallel PHA code. Add crystal names to Acquire window.
		
		Work on parallel PHA acquisition code for "prior" and "after" peaking PHA.

		Add code to save current user directory if user uses File | Close menu (thanks Ryna).

9/25/06		Remove self-extracting zip files from distribution.

		Enable threshold for Gaussian peak fitting. Add code to enable z backlash only on Jeol auto-focus.
	
		Add Window menu to Probewin so Stage and Move are accessible without opening a database.
	
		Fix FormSCAN so that threshold and fit do not display during automated PHA scans.

9/24/06		Fix NumberofScans increment when doing both "prior" and "after" automated PHA scans.	
	
		Move code to restore backlash on Jeol 8900/8200 to before moving to final auto-focus position.

9/21/06		Final work on SX100 ROM scanning. Now working!
	
		Work on SX100 spectro scanning.

9/20/06		Add live and 1st crystal display in progress and elapsed time meters.
	
		Work on SX100 ROM scan code.
	
		Fix height calculation for FormSCAN and FormWAVESCAN.

9/19/06		Fix SX100 wait for auto-focus (driver issue). Move calls to clear status bar after error handler events.
	
		Improve file handling in PictureSnap so last folder gets saved. Add new demo files to update and
		distribution for demo mode of PictureSnap.
	
		Fix time estimate for quick standards in Automate.

		Modify FormMOVE to use separate button for moving spectrometers only.
	
		Edit scan baselines for Cameca config SCALERS.DAT files (change 4 to 2).

9/17/06		Fix problem with nominal beam in FormGETTIM when user cancels.
	
		Fix problem with peaking when counts are low (SX100 error 1107)
	
9/10/06		Fix crystal flipping parameters for SX100. 2 crystal spectrometers require using index 0 and 3 but 2
		crystal large area crystals require index 1 and 3. Changes to SCALERS.DAT file for flag to indicate
		large area crystals.

		Move nominal beam measurement to count times dialog (use default beam as nominal for default beam
		drift correction).

9/9/06		Modify SX50 ROM peak get data. Fix problem in quick standards (>n%) option (thanks to J. Fournelle).
	
9/8/06		Improve standard composition output in Run menu.	
		
		Fix TestType ROMMotor problem.
	
		Modify FormSETSTD to display x-ray lines for interfering element only if duplicate elements are
		present. (Thanks to Heather Lowers).

9/7/06		Modify SampleCheckSampleList to return the last selected sample instead of the first selected sample.

		Fix unload Scan window when automation completes.
	
		Fix motion software timeout for SX100.

9/5/06		Fix projected acquisition time if using multiple sample setups (thin films).

9/4/06		Work on SX100 spectro scan code. Add more keyboard shortcuts.	
	
		Fix gaussian fit display for FormSCAN.

9/3/06		Work on SX100 spectro scan code. Add more right click menus to Automate Digitize grid.

9/2/06		Add right mouse click menu to Automate position grid for updating and deleting selected positions.	

9/1/06		Fix elapsed time calculation in TimeCalculate (unknown off-peak time was not being included).	
	
8/31/06		Add calculation and display of total acquisition time for automation. Fix fit display for integrated
		intensities. Improve display for TypeSelectedSampleSetup counttimes for MAN elements.
	
8/30/06		Add Analytical Conditions dialog to Stage.exe (File menu). Create Distribution and Documentation
		folders for CD-ROM distribution.

8/29/06		Fix count time display in TypeSampleSetup. Recompile help file and PDFs.	
	
		Add option in ImageDisplay to plot Nth stage positions and also offset scale bar.
	
		Modify count time display in TypeSampleSetup
	
8/27/06		Add saving and display of pre and post scan manually selected peak centroids. Add centroid display for SX50/SX100 ROm (internal)
		scans.

		Unload formSCANDATA when automation completes.
	
		Fix SX100 crystal flip index problem for 2 crystal spectrometers.

8/23/06		Modify TypeCounts to not print off-peak info for MAN elements.	
	
		Fix minor problems with beammode when using sample setups. Set acquired image flag false in DigitizeImageClose after
		asking user whether to save.

8/22/06		Fix plotting in ScanData and other plot routines for xaxis min and max.
	
8/21/06		Fix problem with zero magnification in AM interfaces (Livi). Fix 1SIG calculations for MAN elements (OnTimeData
		array was not getting loaded for MAN elements (due to change in aggregate intensity options).
	
8/19/06		Continue work on integrated intensity options using new Gaussian ft routines. Changes to integrated output
		and display.
	
8/18/06		Work on integrated intensity feature (modify to use rigorous gaussian fit) and also use new rigorous gaussian fit
		for peaking procedure. Thanks to Don Snyder.
	
		Add call to AnalyzeStatusAnal("") after saving elements setups from Analyze!

8/14/06		Fix SX100 light modes

		Fix light mode function prototype declaration for SX100.	

8/13/06		Add full window view to PictureSnap. Also add three point coordinate transformation for rotated sample images.
		Note that full view window is clickable for stage move. Also add display calibration points button to
		PictureSnap calibrate dialog.
	
		Add get light and scan modes and display button state in StageMap.
	
8/12/06		Add alpha factor graphical plot for CalcZAF.
	
		Add forbidden element list to PROBEWIN.INI file for KLM markers.
	
		Fix SX50 tran/refl commands.

8/11/06		Add output of file/sample name to Excel output based on sample names (each file to separate sheet in workbook).

8/9/06		Add check for image acquisition not saved. Add scan mode buttons to StageMap. Add SX50 light on/off functions.
		
8/08/06		Add insert cup before nominal beam measurement. Add reflected and transmitted light functions and buttons to
		StageMap window.
	
		Fix problem when reading older version and loading standard intensities (load file setup) in DataGetMDBIndex.
	
		Set self volatile (or alternating on/off) intervals to less than or equal to MAXROW% * 4 (200 points).
	
		Fix enables in IMAGEDISPLAY if no images.
	
		Fix problem with no points in polygon grid (all z stage positions out of range).

8/7/06		Fix problem with setting spot mode (reported by E. Vicenzi) for utility apps (Calibrate, Faraday, etc).

7/28/06		Fix problem where mag was not getting set properly when setting spot mode for Jeol 8900 (reported by A. Logan).

7/24/06		Fix SX100GetCounts (use loop until non-zero elapsed time).	
	
		Add extra <cr> to "Are you sure you..." for updating position sample.

7/23/07		Make Jeol exit macro error silent (for image acquisition cancel).

7/19/06		Force beamsize to integer for Jeol 8900 (Logan).	
	
		Fix pre/post scan flags (Eckert).
	
		Fix menu shortcuts.
	
		Make some warnings only show once (Sample parameters will be applied to next sample created) in GetPeakSave
		and GetPHASave.

7/17/06		Add call to set mag for jeol when setting spot mode since this affects the beam position slightly (Ma).
	
		Fix aggregate count times using new computational arrays.

7/15/06		Add new feature to allow peaking on manual or automated unknown samples of user defined elements. 
v. 7.03		See Acquisition Options. Can be used for samples with peak shift.
	
		Fix PictureSnap display of analyzed coordinates (not erasing them). Start adding
		column condition Save/Load for SX100.
	
7/13/06		Add variables IncrementXForAdditionalPoints and IncrementYForReStandardizations to
v. 7.02		database.

7/12/06		Fix missing "beammodepresent" parameter. Add module level flags for volatile data dialog.
	
		Add module level flag for SetPHA2 and GetPHA for setting column conditions.

7/11/06		Work on SX100 interface.	
	
7/10/06		Move set beam mode calls before set magnification calls. Don't set magnification
		unless in analog scan mode.

7/9/06		Bump version to 7 because of so many optimizations to code.	
v. 7.01
		Fix typo for beam size in AMGetConditions!
	
		Remove additional dead code from Project Analyzer report.
	
7/8/06		Add peak positions to sample and multiple sample setup dialogs. Add more info for sample
		description.
	
		Modify PC custom format for Carpenter.
	
		Tweak SX100 ReadCounter function for new status call.
	
7/6/06		Did something cool! Add code to save wavescan (and graph) plot options including KLM
		markers for subsequent plots.
	
7/5/06		Remove some dead and redundant code from projects. Biggest risk: remove procedure level
		variables, xdata, ydata, zdata, ddata, etc from PlotGetData (to activate module level 
		variables).

		Change max mag for jeol interface to 300,000x.
	
		Recompile apps and update help.
	
7/4/06		Check GridMinerals options (all ok) and fix tab order.
v. 6.62
		Add flags : If AnalysisCheckForSamePeakPositions and If AnalysisCheckForSamePHASettings 
		to analysis option. These flags when true will check that the peak positions of the unknown
		and standard are within 0.005 percent and the PHA settings are within 0.5% before loading the
		count arrays. Useful for situations when using multiple setups with common elements.
	
		Update documentation and help files for PictureSnap feature.
	
		Add AutomatedPHAParameterDialogPriorFlag and AutomatedPHAParameterDialogAfterFlag
		to data MDB (Run) file.

		Finally got orientations correct in GRD file output (version 7 Surfer format had
		X and Y swapped (it worked only on symmetrical matrices). Checked both Jeol and Cameca
		orientations, all correct.

7/1/06		Add "cache-time" parameter to SX100 init structure (default to 50 msec)
v. 6.61
	
		Read current condition if UseCurrentConditionsAlwaysFlag is set in INI file.
	
		Make Read Mag button larger in GETCOND.
	
		Change FormNEW and FormGETNAME to use OK default and add "Add <cr>" buttons for description
		fields.
	
		Change default ROM peak scan width from /2 to /3.
	
6/30/06		Change ROM peaking counttime from 1/8 to 1/4 PeakingCountTimes.

		Add undocumented INI parameters for image registration for reverse field optics.
	
		Add print and clipboard menus to PictureSnap.
	
		Add position display to PictureSnap (both Position database and Analyzed Samples).

6/28/06		Modify Jeol image cancel to go back to IDAB command.
	
6/27/06		Modify PictureSnap cursor to not hide center point. Modify PictureSnapLoadCalibration
		to load existing picture calibration if picture is already loaded and calibrated.

		Add save calibration code to PictureSnap feature (and load when loading image).
	
		Add GIF and JPEG import to PictureSnap.
	
		Modified StageMap code so stage moves do not "trail" the background image. Also don't
		show mag box or beam spot unless faraday is out or beam unblanked.
	
		Fix minor code syntax issues in Misc.bas found using Project Analyzer demo. Will buy soon.
		
		Fix problem with demo mode and out of range gain values once and for all.
	
6/26/06		Add a live current position cursor on PictureSnap image. Moves when the stage moves. Thanks
		to Scotty Cornelius for a great suggestion.
	
		Add tooltip help to various. Split Acquire.bas (to Acquire4.bas).
	
		Work on PictureSnap feature.
		
6/24/06		Fix About box to use ShellExecute for loading default browser. Improve realism of
		demo ROM scan code (slow down scan based on count time per point and add intensity
		variation for each scan).
	
		Fix loading of "Probewin" for username.
	
		Add help context mappings for Stage calibrate form and periodic form.

6/21/06		Add ImageDisplaySizeInCentimeters INI parameter for SX100
	
		Work on new PictureSnap feature (see TestStage.exe). It's going to be slick.

6/18/06		Add clickable link to ProbeSoftware.com in About box.
	
		Fix manual PHA prior to peaking if parabolic peaking and skip P/B is selected.
	
		Add new fit options to FormVOLATILEDATA for volatile and alternating on/off peak data
		display.
	
		Simplify Operating Conditions dialog for CalcZAF and Standard.
	
6/17/06		Add color to crystal flip time if not zero. Add ROM peaking to SX100 interface. Remove
		mag and beam mode if Standard.exe in sample description. Fix TypeType parameter captions
		for peaking option.

		Create TestStage.exe for testing new form for stage registration of images (click and go)!
	
6/14/06		Add column condition parameter file for Jeol (COLUMN2.DAT). Add code to GETCOND also
		for analytical condition update when using column condition strings.
	
		Fix divide by zero in ProbFormTypeSummary if overvoltage less than 1.0.
	
		Improve error handling if overvoltage is less than 1.0 in Acquire | Elements/Cations.

6/12/06		Fix (uncomment) ScanHiddenFlag so FormSCAN appears during automated PHA (even after manual PHA).

6/11/06		Modify StrataGem output to allow automatic output of each data row (in corresponding samples)
		to calculate standard deviations based on individual thin film results. Also useful
		for situations where the film thickness varies and each point needs to be calculated
		separately as opposed to averaged.
		
6/8/06		Add ISAB command for imaging cancels. Add label fields for units per step for wave
		and peak scans (FormSETPEAK).
	
		Make standalone TestRegistration program for SX100 driver distribution to Thermo.
	
6/6/06		Modify SETPEAK form to add normal wavescan range button. Modify out of bounds
		condition to use limit plus (or minus) 0.001 (0.1%) of limit.

		Fix tool tip help for automated PHA scans.

		Work on GunAlign.exe (should work better for Jeol 8900/8200 now). Work on 8200 save/load
		column conditions (fix get mag code). Add status bar updates for saving and loading 
		JEOL 8200/8900 column conditions (Faraday.exe).

6/4/06		Add Chantler MAC table (from N. Ritchie). Fix SX100StopAllMotors. Update pdfs and help file.
	
		Add set beam size to WIN30 (SX50) set beam mode since mode fix resets the beam size.
	
		Add automated PHA flags to FormPEAK. Adjust time calculation for sample time.

6/1/06		Add Remote Automation call for RemoteFlipCrystalMoveMotor in TestRemote.exe to test high level
		call for Remote Automation Interface. Create new Remote distribution files.

5/31/06		Work on automated PHA scanning. See:
	
		Global AutomatedPHAParameterDialogAfterFlag As Integer  ' not implemented yet
		Global AutomatedPHAParameterDialogPriorFlag As Integer  ' not implemented yet

5/30/05		Add clear analyze status calls in Update.bas. Add SX100 counter calls and stop functions.	
	
		Add code in MiscSelecttext to deal with "object not set" error.
	
		Fix issue with tab order in electron range calculation and tweak time calculation for wavescans.
	
		Modify StartWin to load default nominal beam automatically.
	
		Fix pre/post acquire string in Startwin.

5/23/06		Add window position and size save for other applications.
	
		Add edge energy output in calcZAF for x-ray generation range.

5/22/06		Modify beam deflection acquisition to always spot mode for analysis acquisition.
	
		Add auto focus button to Confirm dialog.
	
		Increase number of peakscan steps in InitScalers.
	
		Modify imaging so mag and beam for imaging are separate from analysis.
		
		Add Z range check for Jeol auto-focus.
	
		Comment out acc status integer output for 8200 (debug mode).
	
		Fix Vacuum display for Jeol 8200.
	
		Add update form after autofocus in Automate! and Move windows.
	
		Increase size of Wizard text window and scan parameter label control.
	
		Fix FORMULA format in PC custom output format.
	
		Allow analog spot as default beam mode in PROBEWIN.INI.

		Fix function level timeout and image cancel issues by adding doevents in JeolImageGetScan (driver update
		required).

5/21/06		Disable Y axis list in FormPLOT when Surfer option is unchecked.

5/14/06		Add acquired mag field for images and date-time field for scans (requested by Carpenter and Fournelle)	
v. 6.59
	
		Fix code in AutomateConfirmSelected (Fournelle) for wavescans.

5/11/06		Re-design Stage map calibrate form to be more intuitive (Carpenter).
	
		If out of bounds position in .POS import just skip instead of stopping (see AutomateImportPositions).
	
		Set faraday depending on DefaultBlankBeamFlag in DigitizeImageStop (for Carpenter).
	
		Add check for too low and too high magnification in RealTimeSetMagnification.

5/9/06		Fix mag/beammode issue in Startwin reported by Carpenter (caused by Severin fix).	
	
		Fix problem when using column conditions and mag/beam mode overwrites condition (reported by Severin).
	
		Fix Evaluate data point loading when using difference option (use "not analyzed value" flag).

5/8/06		Fix PUBL values when aggregate intensities are used in standards
	
		Unbelievable! Let me say that again: Unbelievable! I finally fixed a problem with the digitize cluster
		feature when using a round boundary and a number of sectors greater than 1. Problem was due to
		passing a constant in a function call "Call X(1)", when I should have been passing a variable "Call X(Int(1)).
		Unbelievable! 

5/7/06		Add code to export to Excel for other custom formats.
	
		Work on SX100 interface.
		
5/6/06		Fix Analyze! window scroll bar. Fix mag/beam mode problem when using column conditions. Increase
		hardware overhead time for wavescans.

5/2/06		Minor fixes for better error flagging for direct PHA hardware (PHAHardwareType = 1).	
		
		Fix Report button for Carpenter example MDB file with infinite loop (caused by analyzing crystals 
		with same 2d but different names, e.g., LIF and LIFH).
	
		Fix width calculation in Startwin PHA window.
	
		Fix PHA scans for baseline + window greater than PHAmax (both MOve window and GetPHA code).

		Improve error checking in save code.

5/1/06		Change Monitor B/W PHA print format for F8.2.	
	
		Fix problem with RealTimeProcessFlagsGet created when exiting function without setting return value.
	
		Work on SX100 interface.
	
		Add EOS command option for Calibrate application for 8900 EOS commands.
	
		Add primary standard to Evaluate graph.

4/30/06		Add exit for CheckFaradayState in RealTimeProcessGet/Set also.
	
		Exit Faraday insert/remove "process flag" routine if using shared monitor packet.
	
4/27/06		Fix error message problem and load problem when using duplicate elements and aggregate
		intensity option in Evaluate.exe. Fix all times Call IOStatus is called before error
		message is printed.

4/25/06		Add active window copy to clipboard to several forms including Evaluate.
	
		Increase number crystals to 52. (CRYSTALS.DAT)
	
		Fix problem when using aggregate counting and interference correction together. Changes to 
		UpdateStdInterferences and AnalyzeWeightCorrect.
	
		Add more overhead to time calculation for wavescans if using actual hardware.

4/23/06		Add more flexible option for errors bars in Plot! window.
	
		Make Automate position list wider.

4/22/06		Fix filament standby bug.
	
		Fix problem with MAXPHAWindow code in InitData for Cameca gain values.

4/20/06		Add data type to Excel sheet output.
	
		Create Test_SX100.exe for Gaynor.

4/19/06		Fix PHA warnings in CurrentCheckRealTime. 
	
		Work on SX100 interface.

		Fix typo in JeolReset procedure for stop spectrometer (unit number not being loaded correctly).

4/18/06		Add IDAB command to JeolImageGetScan if user clicks cancel during image acquisition.
	
		Fix row number display in automate window.
	
		Add Gaussian fit option for Jeol auto-focus.

4/15/06		Work on SX100 implementation.	
	
4/14/06		Add feature in image display (Run menu) to show only coordinates from the associated
		sample or all sample coordinates within image area.

		Modify demo and Jeol beam deflection code to use last image resolution.

4/13/06		Adjust time calculation for progress meter. Modify demo images for different channels.
	
		Adjust progress meter time calculation.

4/12/06		Fix acquire string problem string when string is blank.
	
		Add additional tool tip help.
	
		Fix thin film particle global parameter problem in Calculation options.
	
		Add move stage options to image display dialog (Run menu).
	
		Fix problem with mag when using automated digitized conditions.

4/11/06		Add code to skip read mag in stage map if interface is busy (to prevent problem
		when getting digital image). Add code to only call procedures if form is visible.

		Fix user defined KLM in wavescan graph. Add periodic KLM selection for
		wavescan graph.
	
04/9/06		Finish translating Gaussian code. Doesn't appear to be super accurate at higher
		spectrometer positions.

		Add options for ROM peaking. See old ROMPeakingType in PROBEWIN.INI file. Now 0 = internal
		(Cameca only), 1 = parabolic, 2 = maxima, 3 = gaussian. See also new threshold INI options for 
		the last three peaking types:
	
		ROMPeakingGaussianThresholdFraction=0.33
		ROMPeakingMaximaThresholdFraction=0.50
		ROMPeakingParabolicThresholdFraction=0.33
		
		ROM scan acquisition.
	
04/03/06	Fix grid line loading issue in FormWAVESCAN. Adjust progress meter time calculation.
v. 6.58		Fix unassigned analog signal channels captions in FormIMAGE. Add code to try and speed up
	
4/1/06		Modify exponential fit so it can handle exponents up to 8 (Thanks to John F.) and add spin
		button to make it easier to modify exponent value.

3/31/06		Add more color to Element Setup dialog. Fix estimated time in AutomateConfirm.

3/30/06		Add two second interval to stage map read mag code.

		Fix progress meter.
	
		Fix log window resize when status bar is present.
	
		Fix problem when canceling analysis and re-starting.
	
		Improve Report button output in Analyze! window.

3/28/06		Add support for CL analog imaging

3/27/06		Fixed some glitches in ZAFSmp for oxide output.	
	
		Continue work on progress meter. Not totally satisfied with it but it is interesting.
	
3/25/06		Worked three hours to fix a silly little @#$%&*! bug that caused the Periodic form to load the first time
		the Move window is opened and the Go button is clicked. Made a bunch of other changes so the form is
		updated more cleanly. New procedure MoveUpdateForm.

3/24/06		Work on PFW User Wizard.

3/23/06		Add mag read for Stage Map form. Add counttime progress display. Add unknown count factor to SETUP.MDB.
v. 6.57
		Add current condition parameters for PHA and peaking scan display.
	
		of crystals on spectrometer 1 (PHA code).
		Fix bug in StartWin where current crystal of spectrometer other than 1 is greater than number 

		Add new Realtime parameters for saving scan data.	
	
		Update Periodic form when crystal is changed in Move window.
	
3/18/06		Modify SCALERS.DAT for so Inte/Diff mode and Deadtime are specified on a crystal by crystal
v. 6.56		basis. See new lines in SCALERS.DAT file. Update deadtime and inte/diff mode code throughout
		program,=.

		Fix problem with bad .COR file in RecalbGetSetCrystalMotorPositions
	
		Fix problem with standard k-factor when using aggregate intensities on major elements.

3/15/06		Modify EMPPHA.DAT file for new format.

3/13/06		Add blue font for frame headings. Add Search program to File Find and Load File Setup dialog.
	
		Improved modeless Periodic dialog for Move window.

3/10/06		Move set image source to separate real time level call (because 8200 requires it).

		Replace analysis status with status bar in form ANALYZE!.
	
		Modify MOVE form to use new element buttons.
	
		Clear FormAUTOMATE current sample and row fields when moving from StageMap.

3/8/06		Fix 8200 image source list names. Change to PICT mode for digital beam mode for 8200.

		Fix data labels in Scandata graph

3/6/06		Remove automation status window and replace with status bar.
	
		Fix problem with interval halving method (Fournelle report).
	
		Finally fix font size problem on scan and scan data and fit display issues.
	
		Fix major problem with RealTimeCrystalPositions in PHA code (should be motor% not scal%)
	
		Add real time display for parabolic and intervals peaking.
	
		Fix WaveReset function to keep current selections.

3/5/06		Add parameters for Thermal Field Emission Gun (kev, etc).
	
		Add Realtime display of parabolic and interval halving peaking.
	
		Add backlash mode menu to Monitor.exe.
		
		Add backlash off for alignment peak center. Add excel link for alignment peak results.
	
3/4/06		Add magnification to shared monitor packet. Fix standalone TestFid program for transformation
		of stage coordinates between different beam instruments.
	
		Rearrange digital imaging beam mode per Otsuki suggestions for 8200.
	
		Add code to trap no points to plot in many routines.
	
		Add MAN data to alternating data table display.

3/3/06		Add code to trap older files for volatile off-peak (alternating) intensities.
	
		Add display option for P-(H+L)/2 in volatile data dialog.

03/2/06		Add new input and output capability for Startwin peak alignment scan feature (thanks Paul).
	
03/01/06	Add mag box for stage map showing current mag scan size if in analog scan mode.	
	
		Add new INI file parameter [General] section: PeakCenterSkipPBCheck.
	
		Add demo mode for graphical autofocus display in TestType.

2/25/06		Add plot of centroid and threshold to ROM peak scans and save parameters to scan table.
v. 6.54
		Remote interface updated for new scan and peaking calls.
	
		Peak scans can now contain up to 1000 points (both ROM and non-ROM).
	
2/23/06		Many changes to ROM scanning and peaking code to allow users to specify counttime and number of
		points for scans and allow re-entrant ROM scanning.

		Modified the startup code so now it reads the current instrument PHA values if UseCurrentConditions
		flag is set in the INI.
	
2/21/06		Changes to the read Jeol beam current code. Modified the set beam current code so it won't 
		fail with an error. Also implemented the PHA monitor packet updates. 
	
		Add PHA display to Monitor.
	
		Fix shared monitor packet problem fro non-jeol interfaces.
	
		Add more info in Automation status form from set beam current.

2/20/06		Add get/set column parameter methods to Remote interface.

		Fix Remote code for all interfaces. Add code in TestRemote for MOveAllStageHardwarePresent
		flag in INI file. Update .XLS sample spreadsheets.

2/19/06		Fix Monitor so the elements are displayed only if they are close to on-peaks.
	
		Fix some context sensitive string IDs in PROBEHLP.INI.
	
		Add ability of program to parse pre and post acquire strings for SX50/51 and Jeol 8900 
		instruments. Simply separate multiple commands using commas. (Thanks to Paul Carpenter for
		the idea).
	
		Fix saving of DefaultBeamMode on closing Image form.
	
2/14-18-06	Minor fixes for image stage move problem, add Thermo code for loading 
		spectrum data (anticipated). Fix minor cosmetic issues. Work on new feature list.

2/13/06		Fix final code on Thermo EDS interface. Tweak GetPHA frame captions.	

		Work on Thermo EDS interface (almost working!).
	
		Add remove polygon coordinate button in Digitize Polygon Grid dialog (Thanks Amelia)
	
		Remove extra call to GetPHAMoveToOnPeak.
	
		Add update of default conditions to all hardware specific calls.
	
		Add get mag and beam mode to RealtimeSetDefaultState if UseCurrentConditionsAlwaysFlag
		flag is set in INI file.
	
		Add display of PHA interval width to StartWin PHA form.
	
2/13/06		Add shared monitor call to Remote.exe. Add default variables to xxxxxSetConditions
		calls. Add set mag to FormCOND calls.

		Add data export button to volatile data and scan data displays.	
	
		Fix problem with recording alternating on and off data to Volatile table.
	
		TestTracor EDS interface.
	
v. 6.52		Add deadtime correction option to StartWin.

2/10-11/06	Add volatile data display dialog.
	
		Wait- problem with shared packet causes 45 second hang after move. Return to old method for now.
	
		Add shared monitor packet calls to main programs. 
	
2/9/06		Update Remote Automation distribution files. Now includes high level RemoteFlipCrystalMoveMotor
		call for spectrometers.

		Change INI file: Delete GetOnlyStagePositions and GetOnlySpecPositions. Use old 
		keywords ReadOnlyStagePositions and ReadOnlySpecPositions. These should always be zero except
		for Axioscope interface. Force to zero in INI file for backwards compatibility.
		
		Add zoom and shift spin buttons for wavescan plots.
		
		Add warnings for off-peak ranges outside wavescan ranges.

02/07/06	Add pre and post acquire strings to sample array.

02-06-06	New version of XRAY.MDB is available with stronger and higher high order intensities.

		Modify Position database to include beam mode.
	
02/03-05/06	Many changes to integrated beam mode and mag into sample acquisition and imaging
		and beam deflection. Fix quick standards for John Fournelle and wavescan plotting for Paul
		Carpenter.

		Add beam mode parameter to position database and mag and beam mode to automate Conditions.
	
02/02/06	Add beam deflection and column condition display in Acquire! Add beam mode parameter and 
		magnification to acquisition code.
	
		Expose RealtimeFlipCrystalMoveMotor in Remote interface.
	
		Modify INI file parsing to deal with semi-colon comments when reading strings from INI file.
	
		Fix problem with Jeol ROM data not being saved.
	
		Add hourglass cursor for image save.

01/31/06	Fix display issue for Jeol image flags (need to also flip long data array).

01/29/06	Make FormSELECT "always on top". Move Load FormACQUIRE to after open MDB file.
		
		Fix problem with saving window position and size if minimized. Add minimize button to
		FormIMAGE.
	
		Fix byte offsets for vacuum parameters for 8200.
	
		Wait for bias scan delay before 1st point only.
	
		Set beam size to zero for WIN30 imaging if SX50 and restore after imaging.
	
		Don't save ROM data for SX50. Check for low = high values for bias and gain scans in SCALERS.DAT.

01/24/06	Disable ICWW command for 8200
	
		Add fields for storing alternating on and of peak data. Add code to return and store ROM data 
		to scan tables. Add flags for alternating on and off peak acquisition.
	
		Modify Monitor to ignore "zero" crystal position returned by Jeol 8900.
	
01/16/06	Add code DataScan.bas to automatically record all PHA, peaking and peak scanning data. See 
v. 6.48		new menu under Run.	
	
01/12-15/06	Add many new features to software (too many to note but including an option for displaying
		the PHA dialog before or after the peak procedure (manual or automated peaking)). Test ROM peaking
		code with both backlash factor polarities (limit Jeol 8900/8200 to negative backlash). 

		Add code to save window positions based on user name.

01/11/06	Modify Jeol code for stability. Modify captions background color to match in XP mode.
	
12/31/05	Fix problem with old MDB format and bad config for finding crystal in
		XrayConvertSpecAng.
	
12/26-29/05	Work on ISPM command. Add Eo/Ec to CalcZAF output. Fix subscript out of range problem
		in wavescan display. Remove Clng from calculation of centroid for ISPM and auto-focus.

12/25/05	Add FormANALYZE2 to display row format of analyzed data. Merry Christmasyulekawanzasoltice.
	
		Fix problem with displaying PUBL when excess oxygen is present in standard and displaying
		PUBL values in oxide format (Jeez...).
	
		Fix problem with documenting APF renormalization in EMP.FRM
	
		Test ROM Peaking, add ROM peaking to Remote interface.
	
12/20/05	Fix Remote Automation installation to create Program File\Remote Automation 
		folder for application files.	

12/16-18/05	Work on ROM scanning and peaking code. Moved peaking code to Realtime layer and
		add new functions for Remote automation interface. Tweak PHA and bias scan code and forms.
	
		Modify GetPHA to support bias and gain scanning.

12/15/05	Add spectrometer position calculation and PHA distribution to Remote interface.
	
		Modify TypeResults to zero average results if average kraw is less than zero (Fournelle).
	
		Modify volatile element corrections to use more accurate elapsed time calculation
		including older files (both assigned and self).
	
12/12-13/05	Add several INI flags. Extend SCALERS.DAT file to add room for Gain scan
		parameters. Modify PHA dialogs to support both bias and gain scanning (Carpenter).
	
		Fix problem with MODE FIX and imaging with SX50/51 with Win30 board (thanks Ken).

		Make many changes to volatile correction including the addition of an "elapsed time"
		array for all standard and unknown data points. And a quadratic option for fitting.
	
12/9-10/05	Work on new feature for Startwin.exe. Based on Paul Carpenter's suggestion
v. 6.47		implement a "bias" scan" feature to scan the detector bias at a fixed and narrow
		PHA window.

		Fix problem with missing Jeol INI parameters (thanks Ken and John).

12/8/05		Add Auto-focus button to Move and Automate, add PUBL to oxide analysis (thanks Ken).

12/7/05		Work on imaging more. Test ROM peaking code. Add Update button to Automate windows.
	
12/05/05	Add Copy to Clipboard button to graph forms. Add stage move to imaging
		window. Modify Jeol imaging functions and speed up get faraday and mda beam current 
		code.

12/1-4/05	Work on image display dialog- add palette and scalebar options.

11/29-30/05	Work 8200 image source, auto-focus and imaging codes. Also modify MDA set 
		beam current code to use option for INI file based calibration parameters
		and modify JeolGetFaraday to check for stable values returned.
		
		Modify Monitor to fix probe scan/scan mode commands for 8200.
	
		Modify JeolSetBeamCurrentMDA to allow coarse condenser to be iterated.
	
11/28/05		Add new imaging features including display of data points and point
	line numbers and print and copy to clipboard. Also automated image acquisition
		for analog signals (see Acquisition Options).
	
		Also includes the ability to manual acquire images and display them from the 
		Run menu. In addition one can deflect the beam for manual data acquisition.
	
11/24-27/05	Work on new imaging capability for image saving to probe database
		(image data is 32 bit and saved to a binary image file with a .BIM extension).
	
		Work on GunAlign. Fix call to ReadImaging for ISPM (add flush)
	
		Add imaging table to PFW database and imaging parameters to sample structure

11/17/05	Add crystal 2d and Ks to wavescan data printout.
	
		Fix typo in Xray Database comment (Thanks to J. Fournelle).
	
		Modify Run | List Run to print crystal (2d and K) parameters.

11/15/05	Modify J8K_ReadImaging function to handle unit name for ISPM.
	
		Work on Jeol "ROM" peaking code.
	
		Work on GunAlign.exe.
	
11/13/05	Modify DigitizeImage to show pixel coordinates and also to use beam deflection 
		when not digitizing stage coordinates. Also tweak Jeol imaging code for 8900/8200.
	
11/11/05	Modify many routines to allow line numbers up to 99,999 (for P. Carpenter's
		giant wavescan runs).	
	
		Work on spectrometer "ROM" peaking.

11/9/05		Work on integrated imaging. Modify gun x shift/tilt in ReadMonitor (gun align).

11/7/05		Work on Jeol imaging commands and peak scanning.

11/6/05		Work on imaging commands.
	
11/4/05		Tweak Jeol interface with Paul. Modify JeolSetConditions to load current conditions
		if first time program is run. Modify JeolFilamentStandby to read current filament
		current and save that for "restore mode". New JeolFilamentWarmUp code.
	
		Add Conditions output file (.TXT) from Plot window when using ASCII file output.

10/27/05	Fix problem with postscans not using sample conditions of PreAcquireString.
	
		Update documentation and help file.
	
10/24/05	Add INI file parameters for auto-focus. Fix some small problems in
		Jeol integrated imaging. Implement SE and BSE imaging sources and a/d conversions.
	
		Fix FormIMAGE for SIS interface.
	
		Add instructions to TestFid.

10/20/05	Tweak auto-focus (one mo' time).
	
		Edit Command-corrected.txt (fixes typos from Otsuki-san).
	
		Fix SIS image aspect problem (SIS requires square pixels).
	
10/17/05	Add additional code checking for auto-focus. Fix Jeol stage backlash
		problems (GBKR does not work, GBMS does not affect ILSM).
	
		Modify TestImage GetImage code to handle either ILBM or IMBM commands.	
	
		Fix typo in Jeol documentation regarding turning backlash on or off (GBMS).
		
		Change movement time for wavescan steps in TIME.BAS from 1.0 to 0.5.
	
10/17/05	Fix problem with off-line files when copying PROBEWIN.INI file and 
		forgetting to change ImageInterfaceType to zero. Program now forces demo
		mode for imaging if IntefaceType = 0.
	
		Fix backward compatibility for formula in versions prior to 6.06 (again).
	
10/12/05	Fix LeastDeviation to calculate actual percent deviation and also modify
		VolatileCalculateFit and VolatileCalculateSelfFit to convert from log units.
	
		Make FormGRAPH resizable (thanks for bugging me Paul).

10/11/05	Fix auto-focus code, add print ILBM parameters.

10/9/05		Modify some wavescan form parameters. Add kilovolts to FormGRAPH (PLOT)
	
		Modify FormXRAY load to pre-load correct x-ray range for selected wavescan.
	
		Implement a bunch of good ideas from Paul Carpenter regarding the wavescan window.

10/6/05		Fix problem with beam blanking after prescan during peaking procedure.	
	
v. 6.43		New feature- option to run quick standards in two modes: normal and with
		a "minimum" weight percent. In the new mode all elements in the standard
		that are greater than a specified weight percent will get acquired. See
		Acquisition Options from the Acquire! window. Thanks to a great suggestion 
		from John Fournelle. 

10/3/05		Fix problem with quick scan modification in AMMoveMotor.
	
		Modify ReadMonitor functions, add JeolMonitorInterval& default to INI file.

10/2/05		More tool-tip help.	
	
		Update distributions files for new Jeol stage maps.
	
		Add option for Calculation Options to calculate sum of cations normalized
		to a specified value.

10/1/05		Modify interference correction to handle duplicate elements so long
v. 6.42		as they have different x-rays (Zn Ka and Zn La on Na for example). Note
		that this is not essential, one can use the disable quant feature to
		handle this situation and is required to in the case of element and 
		x-ray line duplication (Zn ka and Zn ka with Na). Note that when 
		duplicate elements and x-rays are present one must disable the 
		duplicate element for both the unknown and also the interference standard.
	
		Add Sample Exchange button and INI file parameters.
	
		Modify Periodic to warn regarding low overvoltage situations.
	
		Modify format of off-peak offsets in XrayPlotXray.

10/1/05		Modify Time.bas to use in AutomateConfirmSelected if empirical time estimates are not available.

		Add display of elapsed time for all sample types in AutomateConfirmSelected.

9/28/05		Add FormSETPHA2 to Move dialog.
	
9/26/05		Finish stage map calibration code to improve accuracy of stage bit maps. This
		will allow the user to refine the stage map image corner coordinates
		using known features of interest in the microprobe. Try it, you'll like it!
	
		Modify GetElm code to not allow loading from Move window if spectrometer position
		if too far from theoretical position.
		
		For example standard MgO 12 could be a file called "0012_MgO_Block2.bmp" or 
		"0012_Periclase_Block4.BMP". Both files will load during standard digitization.
		
		Add automatic support for standard image files for display of electron image. Program looks
		for any BMP files in the StandardPOSFileDirectory$ (defaults to UserDataDirectory$) and
		if it finds a match to any file (first 4 characters) of the standard number it loads it.
	
		Add more tooltip help. 
		
9/25/05		Add StartSpectroExtFlag(motor%)to AM code to allow slower spectrometer speeds if
		using "quickscan".
	
		Add tooltip help to some controls (just a few for now).
	
		Add button and INI file parameters for sample exchange positions.
		
		Add Remove volatile assignment button in GetElm.
		
		Display wavescan count time in plot.

9/24/05		Modify Count Times spectrometer time display to show individual elements.
	
		Modify Stage Map cursor display to use MiscAutoFormat.
		
		Make xray load by default when element is changed.
		
		Fix problem with fiducials not present for standards when analyzing when after loading 
		file setup and clicking "Yes" for loading standard intensities. Changes to
		DataFileSetupLoadData code.
	
		Add kev cursor display for FormWAVESCAN.
	
		Add off-peak offsets in FormGRAPH for wavescans.
		
		Add "jog stage" button to FormConfirm.
	
		Make Custom Group Field #3 (FormFileInfo) longer.
	
		Add new stage bitmap calibration code (click @ symbol button)
	
		Add "to" in Report code. 

9/22/05		Add many changes, especially periodic table form. Add ability to "read" current settings from
		MOVE window for FormGetElm (Elements/Cations).
	
		Modify StageMap so the holder selection and position frame can be minimized. 
		(thanks for John Fournelle for complaining)
	
		Modify GunAlign app to respond to scroll and text events better.

9/15/05		Add EDS spectrum parameter output to EDS Assign dialog and log window
	
		Modify StageMap labels so they disappear when map gets small. Add resize buttons to form.
	
		Add reply buffer to ILSM command for auto-focus.

		Add 300 msec delay to JeolSetBeamCurrentMDA after going from high to low condenser value.

9/9-14/05	Work on Jeol code.

9/8/05		Work on Jeol auto-focus.	
	
		Fix beam deflection to use -512 to 511 range.
		
		Add Jeol Get/Set Transmitted Light functions add to auto focus.
	
		Change Mektech to use livetime for display. Multiple URSA net intensities times 1000
		for better display.
	
9/7/05		Fix problem created by adding "no data" "asterisk" to position samples causing
		position list to reload.
	
		This version requires an upgrade of Jeol driver.
	
		Add log file comments for Jeol debugging. 
	
		Add 0.05 delay after setting condenser in JeolSetBeamCurrentMDA.
	
		Modify fiducial printout for standards (TypeCounts).
		
		Modify TestJeol to handle up to 24 parameters.
	
9/6/05		Fix problem in passing "literals" to memcpy_endian.  Should fix problems with ILSM
		and BPOS commands (auto-focus and beam deflection).
	
		Work on auto-focus code for Jeol 8200/8900.
	
9/5/05		Add menu item to Run menu to list referenced fiducial sets including standard sets
		for the current run.
	
		Modify Jeol auto-focus code.
	
		Add auto focus offset to PROBEWIN.INI
	
		Add "Move To" buttons to traverse and grid dialogs.
	
		Add Adjust PHA buttons to Probewin an Startwin.
	
		Change Mektech EDS "start" delay to 0.7 seconds.
	
		Modify Standard menus per Fournelle suggestions.

9/4/05		Add sample numbers to stage map display
	
		Fix counttime (livetime) load problem in Mektech code.

8/25/05		Add delay after condenser adjustment in JeolSetBeamCurrentMDA.	
	
		Start implementing ILSM based auto-focus code.
	
		Add additional error checking to JeolSetBeamCurrentMDA.

08/20/05	Create new application for testing Jeol 8200/8900 interface. See TestJeol.exe.
	
		Add BeamCurrentToleranceSet value for setting beam currents for jeol 8200 and 8900.
	
		Document Digitize sample description field to note that new line requires <ctrl> and
		<enter> together.

08/17/05	Fix beam current iteration for Jeol 8200 (twice or four times larger for 8200)

v. 6.41		Add global particle correction flag to PFW and normalized weight percent output.
	
		Add particle parameters and normalized percents to CalcZAF output.
	
		Modify RecalbGetCrystalPositions to delete .COR file automatically if the crystals
		do not match the SCALERS.DAT file.
	
		Modify Calczaf to save Userdata directory if changed.
	
		Modify FindFile to display more of filename.
	
8/12/05		Modify SetBeamCurrentMDA to make 8200 same as 8900 (8200 display of condenser values
		is inverted).

8/10/05		Fix some issues in the EDS spectra display. Make Stage Bit Map a double click to move.
	
7/27/05		Remove all references to stdpos filenames. Replace with StandardPOSFileDirectory keyword 
		in INI file.
	
		Modify GetElmSetStdLoad to only display "self" if acquired as a "self" volatile and only
		display samples acquired as "assigned" if not "self" acquired.

7/26/05		Several more days of work on Monitor and JeolSetBeamCurrentMDA.
	
		Add ThermalFieldEmissionPresentFlag for GunAlign app condenser coarse and fine ranges.

7/22/05		Work on Demo and JeolSetBeamCurrentMDA procedure to set beam current iteratively.

7/20/05		Work on Monitor code. Ass Z spin button to Move window.
		
		Add read speed commands to Calibrate (SVCR and GVCR commands).

7/19/05		Modify List Report output so it looks cleaner.
		
		Modify SendToExcel code to fix problem with .Visible. Change declarations to generic "Object".
		
		Modify ConvertSigmaKratios to handle DisableAcq flag.
	
		Modify "if sample(1).DisableAcq(ip%) then" to "if sample(1).DisableAcq(ip%) = 1 then" in 
		UpdateGetStandards and UpdateGetMANStandards.

7/18/05		Implement Brian's new DLL code.
		
7/17/05		Work on 8200 code.
	
		Change Move To On Peak Positions to a button.

7/15/05		Work on ReadMonitor functions
	
		Work on 8200 EOS interface

7/14/05		Fix Mektech code (database field problem).	
	
		More changes to Jeol 8200 code.

7/11/05		Many changes to Jeol 8200 code. Modify TestImage for 8900/8200 imaging.	
	
		Update PFW Components folder.
	
		Modify TestEDS to use Graph control. 

7/10/05		Work on Jeol monitor code, convert additional code to use ReadStruct.
	
		Increase number crystals to 42. (CRYSTALS.DAT)
	
		Modify MekTech GetSpectrum function to include Realtime parameter.

7/7/05		Add Park buttons and Move and Stage dialogs to Calibrate.	
	
		Modify Remote Automation code to include MoveStageMotors function for Jeol 8900, etc.
	
7/4/05		Update EDS display code. Work on Jeol monitor. Modify Edax code to try and read evperchan.	
		
		Update manual to v. 6.4
	
6/28/05		Modify EDS Spectra acquisition code to check acquisition flags to prevent calling
		EDS routines when flag is not set but sample is flagged. Modify Mektech code
		to check return parameters.

6/28/05		Add EDS count time controls to GetOPT form and database fields.
v. 6.4
	
		Fix default substrate in StrataGem code.
	
		Implement new Read status functions for 8200 and work on Monitor code for 8900/8200.	

		Modify GetPeak to display off-peak offsets and wavescan offsets.

6/27/05		Modify Mektech code to fix display problems and TestEDS code (for Edax as well).	
	
		Implement new 8200 status functions.

6/23/05		Remove all Jeol rlogin code and components from all applications.
	
		Remove exit sub from JeolStopCounter.

6/19/05		Fix StrataGem output for coating on unknown samples. (add "k")

6/17/05		Fix SX50 SX50GetFaradayState code.

		Add code to load specified elements based on standard composition.
	
		Fix problem listing current file in Load File Setup.
	
		Fix problem assigning backgrounds when same element, same xray in sample (duplicate xray)

6/16/05		Fix splash screen problem by adding image control for different screen resolutions.

6/14/05		Test 8900/8200 code at UCLA. Split Jeol code to JEOL3.BAS.

6/13/05		Work on 8200 EOS code
6/12/05		Work on 8200 EOS code
6/11/05		Work on 8200 EOS code
6/10/05		Work on 8200 EOS code
	
		Add GetFaradayState code to SX50 interface. (so if user clicks faraday button manually
		the software will update).
	
6/1/05		Fix STDPOS window to be "always on top". Fix Jeol spectrometer calibrate command (Jeol
		documentation wrong).
	
		Minor changes to GetFaradayState code.

5/31/05		Implement MONITOR structures for 8900 and 8200.
	
		Remove password from CalcZAF distribution.
	
		Modify program to not list currently open file in File Setup list.

5/30/05		Disable sample and multiple setups if no samples (FormNEW and FormAUTOMATE).

5/27/05		Update splash screen.

5/11/05		Continue work on 8200 EOS interface. Jesus H. Christ, this is a lot of work!

5/10/05		Check crystal non-match problem reported by Fournelle.
	
5/9/05		Modify Monitor to handle demo interface. Modify Evaluate to handle
		Bence-Albee corrections.

5/1/05		Work on 8200 interface.	
	
		Both Probewin and Startwin utilize the Skip P/B Check code now.

		Modify peak center routines to support "skip P/B flag". AdD Demo ROM for testing.
	
4/26/05-4/30/05 Working on Jeol 8900/8200 interface and driver with Carpenter
		and Gaynor.
	
4/25/05 	Fix minor bug in StartWin "cycle time". Test Jeol 8900/8200 new driver. Works
		with emulator!

4/17/05		Modify Command.exe to export complete text database fields for command.mdb.	
	
		Fix xray transmission problem in ConvertCalculateXrayTransmission for non K lines.
	
		Add exit sub to SISBeamDeflection to disable until load module problem is fixed.

4/12/05		Fix error problem in JeolRlogin interface in JeolRloginGetResponse.

4/6/05	 	Add/Remove std with double-click in FormADDSTD

4/5/05	 	Continue work on 8200 EOS interface.

4/4/05	 	Continue work on 8200 EOS interface.

4/3/05	 	Continue work on 8200 EOS interface.

4/2/05	 	Continue work on 8200 EOS interface.

4/1/05	 	Continue work on 8200 EOS interface.

3/30/05	 	Continue work on 8200 EOS interface.

3/29/05	 	Continue work on 8200 EOS interface.
	
3/27/05	 	Continue work on 8200 EOS interface.

3/26/05	 	Continue work on 8200 EOS interface.
	
		Add formula entry for specified elements (trace calculations)

3/20/05		Add automatic selection of substrate option when parameters are clicked.
	
		Add file names to CalZAF MAC file creations menus.
	
		Add Cancel button for Virtual Standard dialog.

3/5/05		Modify StrataGem output to include carbon coat for unknowns
	
		Modify StrataGem output to specify oxide or compound substrate.
	
		Add element and x-ray to specify x-ray database range

2/17/05		Add Export feature to CalcZAF

2/14/05 	Continue work on 8200 EOS interface.

2/13/05 	Continue work on 8200 EOS interface.

2/5/05		Continue work on 8200 EOS interface.

1/30/05		Work on Jeol 8200 interface. Document AM 6400/8600 serial interface better.	
	
		Add GetOnlyStagePositions INI parameter for Axioscope interface.

1/26/05		Work on 8200 EOS interface.
	
1/25/05		Fix problems with ReadOnlyStagepositions and ReadOnlySpecPositions 
		flags.
	
1/22/05		Fix PTC problems in Probewin (saving GetPTC in OptionsAll parameters 
		and first time calculations in ZAFSetZAF for zaf.t3 and zaf.t4).

1/17/05		Work on Jeol6300 and GunAlign app.

1/11/05		Work on Axioscope interface.

1/10/05		Modify AmJeol interface.

1/9/05		Work on Jeol and Jeol6300 interface.
	
		Fix problems with trying to load FormSTAGEMAP when no stage maps are defined.

1/8/05		Add code for handling MoveAllStageMotorsHardwarePresent flag for backlash.

1/4/05		Work on Jeol interface (get ReadCounter function working)

1/3/05		Work on Jeol interface (get EOS set commands all working for load column condition).

1/2/05		Work on Jeol interface.

1/1/05		Work on Jeol interface (8200 EOS)
	
		Fix beam current (convert amps to nA).

12/31/04	Create "Monitor.exe" application for frequently used parameters.
	
12/27/04	Add special code to fix JEOL EOS parameter weirdness. See
		JeolFixParameter.
	
		Add new serial interface for digitizing stage (Axioscope).
	
		Jeol interface apparently flips the polarity of the gun shift and tilt
		x value (but not the y value and only when "getting" the value.
	
12/23/04	Adjust CalcZAF output to only output "excess" oxygen if 
		oxygen channel is being output and oxygen by stoichiometry is being
		calculated. Fix problem with outputting disabled elements (add
		option to skip output of disabled elements.
	
		Tweak Jeol 8900 EOS interface for gun shift/tilt.
	
		Add call to get current crystal positions in MotorLoadCurrent

12/21/04	Add check for crystal match in SX50GetCrystalPosition
	
		Add Armstrong and PAP references to Report button.

		Add APF equation to documentation of Model Background dialog.

12/17/04	Add "cycletime variable to StartWin (Fournelle and Chavez)

		Fix Element list in Load File setup if no samples.

12/9/04		Fix problem with duplicate elements with same x-ray lines and standard k-factor calculations
		when disable flag was being used. Changes to ZAFstd and UpdateCalculateUpdatesStandards.
		Thanks to Ryna.

12/8/04		New computer.

		Fix Jeol EOS interface (using Gaynor's 8900 emulator)

12/4/04		Add Y increment to wavescan acquisition.	

		Tweak Mektech SaveOpen spectrum file prototypes.

11/29/04	Work on Jeol PHA and fix minor enable bug in GetCondLoad regarding column conditions.

11/26/04	Tweak JEOL EOS interface for 8900.

11/24/04	Tweak JEOL interface.

11/23/04	Fix zero traverse problem in DigitizeSaveTraverse (good one, Fournelle!)

11/22/04	Work on Jeol 8900.

11/21/04	Work on Jeol 8900
	
		Work on new dialog for calculating optimum off-peak count time from statistics.
	
		Fix problem with JJD2 (and other) custom output files when non-permitted characters are in 
		sample name.
	
11/12/04	Fix bug in volatile self correction when fixed elements and standard is being acquired. Fix
		"Report" button for volatile element correction.
	
		Make TestMektech.exe distribution (Swsetup6).

11/1/04		Further work on Mektech EDS interface.	
	
		Start Mektech EDS integration.
	
		Fix Jeol PHA calls (Jeol documentation is incorrect).
	
		Fix vacuum parameter display.
	
		Modify Evaluate to plot relative deviations
	
		Fix problem when number of replicate points exceeds MAXSAMPLEROW (make new "continued" sample)
	
10/29/04	Modify Model.bas to only save integrated, peak and centroid data if user clicks "Output"
v. 6.32		button in Model dialog.
	
		Could it be? Could it be? That I finally fixed the problem with combined condition samples
		so that Claudio can finally do what he's been trying to do for all these months? Years? Just
		remember that the acquisition order for combined samples is determined by the analytical 
		conditions (Toff, KeV, Curr, Size) themselves. That is, each condition, as discovered 
		in channel order, is the subsequent analytical condition that gets run.

		Work on Jeol interface.
	
		Fix problem when interference flag is set but no interferences are assigned (Report button).
	
		Fix problem with reading vacuum parameters. Fix problem with display of volatile plot
		when there is no data in sample.

10/15/04	Fix Realtime interface issues (again!).
	
		Fix Realtime mode problem from multiple instance fix.

10/13/04	More work on Jeol code.
	
		Check CalcZAF for problem Fournelle reported.
	
		Finish Report button code.

10/08/04	Work on Jeol interface, especially EOS interface.
	
		Add new report mode for Analyze window.
	
10/3/2004	Modify Probewin.exe so that "Do you want to interface to the microprobe hardware?" is 
		not asked if another copy is running.

		Update 00index.txt file.

9/26/04		Work on 8900/8200 interface code more- coding to read/write 8200 column parameters.
	
		Document particle dialog and update help and pdf files.
	
		Modify CalcZAF and Probewin to include calls to ElementGetData and ZAFSetZAF for anytime
		standard k-factors are re-calculated.
	
9/19/04		Fix Calczaf import problem with element by difference.	
v. 6.31

		Finish particle and thin film code in CalcZAF and Probewin. Probewin allows storage of PTC
		parameters on a sample by sample basis. See Analytical menu inCalcZAF and Calculation
		Options dialog (under Analyze!) in Probewin. Thanks to G. Meeker for suggesting this.
	
		Add PTC (JTA particle and thin film) code.
	
		Add output for ZAF selection and MAC file selection (for Ryna) when opening a new file.
	
9/5/04		Change AcquireDoAutomateNext to fix problem where confirm during multiple sample setups sends
	
		Warn user of missing file name in InitCheckFiles
		
		Adjust *.CEN output. 

8/23/04		Fix bloody accidentally gol' darn commented-out line in UpdateCalculateUpdateStandards.
	
		Add output of APF values and centroid from Model backgrounds dialog (Fournelle). Look for *.CEN file which
		is comma delimited.
	
		Add "Park" buttons to Move window (Eckert).
	
		Modify Ratemeter dialog to allow for manual scaling (Eckert).
	
		Add check for motor = 0 in UpdateCalculateUpdateStandard for updating matching element when
		duplicated element is found.

8/22/04		Add X-ray symbols in Analyze window (Eckert) for duplicated elements.
		
		Start to add particle calculation code.
	
		Update documentation per Kremser request.
	
8/21/04		Fix duplicate element bug in UpdateCalculateUpdateStandards and ZAFstd for when same element, same X-ray
		but different spectrometer or crystal. Thanks Ryna.

7/26/04		More work on GunAlign and Vacuum applets.	

7/25/04		More work on GunAlign and Vacuum applets.	
		
		Fix long time problem with MAN fit and absorption correction for when the current sample
		is different than the MAN fit sample. Changes to MANLoadAll, MANLoad and UpdateGetStandardUpdate.

7/24/04		Kremser reports that "Manual" peaking does not work from Automate! window. This is

7/23/04		More work on GunAlign and Vacuum applets.	
7/22/04		More work on GunAlign and Vacuum applets.	
7/21/04		More work on GunAlign and Vacuum applets.	
	
7/15-18/04 	Much work on implementing GunAlignment app for Jeol8900/8200, Jeol 6300, SX50 (for 
		testing) and demo interfaces.
	
		Fix error bar calculation of off-peaks if element is MAN corrected.
	
		Add hv off and heat 150 before SX50 "REST" task is run (is case it's not loaded in
		memory).
	
7/14/04		Create new applets for Jeol 8200/8900 interface (and other as well). Vacuum.exe (for vacuum
		monitoring), Calibrate.exe (for Stage and Spectrometer calibration procedures) and
		GunAlign.exe (for gun alignment and tuning procedures). Also add new interface
		(InterfaceType=9) for separate Jeol 6300/6400 interface.
	
6/29/04		Modify Acquire! window to add "Combined Conditions" button for specifying different
		analytical conditions for each element (requires v. 6.20 or later version of probe
		database file).
	
		Modify TestImage to test beam deflection by allowing user to click on image.
	
		Add call to InitSample to Load event of FormACQUIRE to avoid array dimension issues when
		running an automated sample and the Acquire! window was not "loaded" by the user.

6/21/04		Add SIS beam deflection code. Also demo beam deflection code to check calculations.
	
		Start work on single element analytical condition dialog code.
	
		Fix return from FormCOND in AutomateGetConditions to use icancelload flag to exit
		procedure if user clicks Cancel.
	
		Add printout of actual count times in Run | List Run Summary (UnknownCountFactors) if
		sample is an unknown and the count factors are not all equal to 1.

6/16/04		Modify InitFiles to update sample data files in current Userdata folder.
		
		Modify IOGetHelpContext to load ProgramPath if not yet loaded (when Form Load event 
		is called before Form Activate event in the case of FormMAIN).

6/15/04		Modify Help contexts extensively, update help file. 
		
		Continue to implement Gaynor 8X00 Jeol driver for direct TCP/IP
		interfacing.
	
		Add option for halogen equiv. in CalcZAF Options (P. Carpenter).
	
5/12/04		Modify Probewin to output specified weight percents when using CalcZAF
		output format (both standards and unknowns).
	
		Create batch files for CalcZAF update zip and self-extracting EXEs.
	
		Modify PFW to warn user if saving to multiple selected samples and volatile corrections 
		are turned on. Add edge energy to Run List Summary.
	
5/9/2004	Modify CalcZAF (and zaf arrays) to save and output f(chi) values). Modify Binary output
		to calculate average, stddev for multiple output files. Add space before "Line" text
		to facilitate Excel import.
	
		Add explanations to Output menu options in PFW. Update documentation for menu items.
	
		Fix Filament Standby to not use "Error" prefix when using e-mail notification.
	
		Fix First approximation X-ray constants (MAXRAY) in CalcZAF "extended menu" options.
	
		Add Stp and Bks matrix correction parameters to output.
	
6/8/2004	Modify CalcZAF (Binary) to calculate multiple line input file and calculate all 
		matrix and MAC options and save to separate output files. Thanks to Paul C.
	
		Start 8900/8200 direct socket interface coding to Gaynor's driver.

6/6/04		Modify Probewin.elm file to write PHA parameters to.
	
6/1/04		Modify Binary calculations in CalZAF to print average and standard deviation to log window. 

		Use better format for label fields in histogram.
		
		More modifications to CalcZAF for calculating binary k-ratios and error histograms. Including
		line numbers, loop on MAC files also, average and standard deviations for histograms.
	
5/27/2004	Fix problem with column conditions being overwritten by Default column conditions in New.Bas
	
		Add new menu to CalcZAF to calculate a single binary using all 10 ZAF matrix correction 
		options (cool!). Modify output files to use tab delimited output.
	
5/26/04		Change local variables in ZAFPAP routine to use double precision (no effect). Add
		printout of f(chi). Add warning to missing QSCALC code. Fix PROZA code abs correction for
		x-ray lines not analyzed.
	
5/25/04		Fix a typo in the PAP IBKS routine. Added overvoltage limit back into ReadLn routine and
v. 6.20		then moved it to Duncumb-Reed backscatter correction (primary intensities) where it is
		actually used. Find small typo in ZAFMIP Ruste-Zellar code. 10.4 should be 10.04. Only
		affected PAP calculations slightly. Bumped version number since small differences in
		calculations will result for FRAME and PAP calculations.
	
		Make new CalcZAF distribution.

5/19/04		Fix Nistbin.dat and Pouchou.dat files for beta line codes (other subset files were ok).
		Thanks, Paul Carpenter.

5/15/04		Modify Calczaf to output MAC tables (complete) to ASCII tab delimited file.
	
		Add exponential background calculation source code to documentation.
	
		List Kev and beam arrays in List Standard Counts.
	
5/8/2004	Fix error bar calculations for polynomial and exponential backgrounds (just use average
		error bar calculation for both). Don't calculate error bar data if outputting to file.
	
		Add code for calculating peak (P-B) errors bars (in Plot!) and also for most off-peak
		calculated background type (all types except exponential and polynomial) intensities 
		using propagation of errors (from Fournelle).
	
4/29/2004	Modify AnalyzeWeightCorrect, UpdateGetIntfStandards to use new IPOSDQ function that
		returns first occurrence of an element that is not disabled.
	
		Add -DA and -DQ labels to some other dialog boxes. Also do not include -DA elements
		in Count Time estimates. Show x-ray line in log window for analysis if duplicated
		elements are present. (Jim Eckert)
	
		Add this line to AnalyzeWeightCorrect:
		If sample(1).DisableQuantFlag%(intfchan%) = 0 Then  ' no disabled quant flag
		to skip "disabled quant (-DQ)" channels for assigned interference correction.
		
		Add error bar output to off-peak data types (change from corrected data types) and add
		(P+B) and (P-B) to list labels in Plot! window.
	
4/27/2004	Add output of file description to log window when opening old file (Claudio).
	
		Add comment to Xray Database form indicating information of refractive index correction for
		higher order lines.

4/18/2003	Modify UserWin to display longer filename and path.	
	
		This is because the first order lines already had the full refraction correction applied,
		so the code needs to have the correction for higher order lines to be decreased (higher 
		energies), to be self consistent
		
4/11/04		Added correction for higher order KLM lines correction for refractive index in 
		XrayConvertSpecAng when converting from Angstroms to Spectrometer position. That
		was easy since I was applying refractive index for all lines as first order lines.
		The hard part was calculating the refractive index correction when NOT converting
		from Angstroms to Spectrometer units (angstroms to angstroms) and correcting for 
		higher order refractions. The following code is correct (believe it or not):
	
		Add "asterisk" for empirical MACs. Recompile Help file.

3/26/04		Add summary of printout for analysis and data display in Analyze! window.
		
		Add menus to Stagemap form to graph position database coordinates (standards, unknowns, 
		wavescans or all sample).
	
3/10/04		Add routines in RECALB3.BAS to maintain PHA parameter file for use in Startwin to load 
		current PHA parameters from Probewin.
	
		Fix problem with "quick" standards when calculating excess oxygen (from previous bug fix)
		in ConvertTotalToExcessOxygen
	
		Changes to specified oxygen calculations if oxygen is both analyzed and specified in
		a standard sample. See AnalyzeCalculateWeight.
	
3/1/04		Change MsgBox calls to IOMsgBox in AcquireDoAutomate (Filament Standby) and 
		RealtimeGetFaraday (Filament Blown).

2/26/04		Minor fix of StrataGem thin film output format.

2/25/04		Fix problem with mineral end-members when a mineral end-member is selected but neither
		atomic percents nor formula basis is specified. (Thanks to Claudio)
	
2/20/04		Added the following code to the QueryUnLoad event of FormDIGITIZE so that only
		"hides" rather than unloads. This is to try and avoid the re-setting of the
		sample list in the Automate! window if it's set to the "All Samples" option
		and the FormDIGITIZE is referenced when a sample setup is selected.
	
		Add additional custom output option #8 for atomic number (MAN) plots. 
	
		Add "Manual" peaking option. Document.

2/15/04		Document "Replicate" feature in Automate! window.
	
		Add cross hair to DigitizeImage.

2/5/04		Fix relative line numbers to handle "continued" samples in Plot!

2/3/04		Tweak Normalize Samples in Plot! code (change PlotGetDataMax)	
	
		Finish Plot normalization for samples code changes. Re-structure PlotGetData.
	
		Fix PlotPeakCenter display issue for first element in list (thanks to Jim Eckert)

2/2/04		Add date/time display in FormGETNAME.
	
		Added code for "Normalize Y Sets" for output to ASCII file as well.
	
2/1/2004	Add "Normalize Samples (Y Sets)" to plot window. This allow Y data sets to be
		normalized on a sample by sample basis for displaying, say two wavescans from
		different samples. Can be combined with "Normalize YSets". Significant changes
		to PlotGetData (PLOT.BAS) to handle sample basis maximum data. (Fournelle asked 
		for and Fournelle received)
	
1/27/04		Modify Stratagem output format to include conductive coating on standard 
		compositions and specimen description for layered samples.

		ImageInterfaceDisplayYPolarity=0
		ImageInterfaceDisplayXPolarity=0

		for changing the display orientation independently of the beam deflection
		orientation. Necessary for AMB JEOL image display hardware. Changes to INIT.BAS,
		WIN30.BAS, GLOBAL.BAS, BMP3.BAS and SIS.BAS.

1/16/04		Add INI file parameters:
	
		Change text "Average MAN Iteration" to Average Quant Iteration" in log window.
	
		Fix SISClose function.
		
		Update references for MAN paper.
		
		Modify FormPEAK to allow user to double click on element row to move to that peak.
		
		Check output of Stratagem format and change defaults. Comment out skip element
		function code if all points (or average) is zero- let user decide.
	
		Modify Model background dialog for bold print in label fields (centroid, etc.)

12/21/03	Fix SISGetImage for C string handling in filename path.
	
12/13/03	Add centroid calculation for wavescan in FormMODEL. Uses Current graph zoom limits
		for xmin and xmax parabolic fit.

12/03/03	Old XEDGE.DAT file with Cl Ka edge typo got back into distribution somehow. Fixed 
		again.
	
		Recompile Remote and TestRemote and make new distribution.

12/02/03	Check for zero edge energy before overvoltage calculation and add warning (ZAFReadLn)
v. 6.16.
		Modify DataRun to load and save ExtendedFormat and Volatile flags starting in 
	
		Modify AcquireStartSample to same sample to database after default standards 
		are assigned.
	
		Modify AnalyzeGetExcel to just exit if no samples present.
	
		Fix AcquireDoAutomate to analyze last sample (and send to excel) if specified.
	
		Fix AcquireDoAutomateNext to output all data rows in sample.
	
		Add optional output to Excel for NIST custom output format.
	
11/28/03	Modify change in bias warning to only if bias changed and first time or bias
		changed and bias delay is greater than 2 seconds (default = 2).

11/22/03	Document custom output format better. Add custom format #7 (NIST).

		Modify other routines de-normalizing deadtime and fix

11/18/03	Fix Output5 for correct de-normalization of deadtime. See DaraCorrectDeadtime2.

11/17/03	Add custom format #7 (NIST) for raw data output.	
	
		Fix problem in SISGetImage for bytes per pixel.
	
		Comment out code for PlotLoadListAll to load EDS elements because of problems in 
		PlotSetComposite when elements with zero motor number that are not fixed spectrometer
		elements.
	
11/13/03	Fix problem in SampleLoadGrid (and MathArrayAverage2) when denormalizing by counttime
		to skip beam current.

11/11/03	Add call to load EDS elements in PlotLoadListsAll.

11/5/03		Change code for SIS interface to deal with case sensitivity.

10/29/03	Add code in AnalyzeCombine to set MAN flags. From Fournelle.	
	
10/27/03	Allow user to change from off-peak to MAN and MAN to off-peak (if off-peak data exists)
		in Elements/cations dialog even if sample already has data.
	
		Fix problem reading Lb, Ma and Mb multiple peak spectrometer calibration files
		(PROBEWIN-LB.CAL, PROBEWIN-MA.CAL, PROBEWIN-MB.CAL). Was not loading these files at all!
	
		Fix synchronous spectrometer problem with wavescan samples (was not working). For beam
		current acquisition during wavescans.
		
		Document Force Size and Force Column Conditions options in Analytical Condition dialog.
		(Thanks Claudio).

10/25/03	Add VolatileCountIntervals to DataRun so volatile element acquisition can be loaded
v. 6.18		properly from file setup (without having to load Special Options dialog).
	
		Found problem with duplicate elements (different lines) with interference corrections.
		Not sure how to fix. (Fournelle)
	
10/21/03	Fix problem with duplicate WDS and EDS elements if WDS elements are disabled for 
		quant. (Severin)
	
		Fix List Report if EDS spectra elements are present.
	
		Allow output of raw wavescan intensities and count times in Plot! (for Dale)
	
		Append sample name in StrataGem output.
	
		Check for Edax CFG file.
	
		Fix display of results type in Analyze! window.
	
		Disable Force Size if not using Analytical Conditions.
		
		Add output of cps and raw counts to excel option. Allow output of intensities to excel
		in Analyze! window. 
	
10/13/03	Modify pre-scan option to minimize Acquire window during peak position selection (Thanks Ryna)
v. 6.17
		Store flag to display unnormalized intensities (counts as opposed to cps) and modify 
		SampleLoadGrid to display unnormalized counts. 

9/21/03		Fix preceding problem properly using mode%=3.	
	
		Fix Formula problem with oxygen when EDS elements are present. Check stoichiometry
		assignments only when loading analyzed elements (mode=1 in UpdateGetEDSSpectraElments).
	
9/20/03		Add code in various places (not all) where RealtimeGetScalerNumber is called
		to skip if element is by EDS (motor number is also zero). Thanks Scotty.
	
		Modify CalcZAF output in PFW to allow more options.	
	
		Remove mention of "Standard" samples in self calibration option description.
	
		Add ExtendedFormat, UseForceSize, UseForceColumnConditionFlag and 
		VolatileSelfCalibrationAcquisitionFlag to DataRun.
	
		Add motor number and crystal names to UpdateCalculateUpdateStandard arrays
	
		Add motor number and crystal names to ZAFStd analysis arrays

9/18/03		Add update for menu checked items in Analytical menu
v. 6.16

9/14/03		Fix caption note in FormIMAGE form (make invisible).

9/13/03		Fix problem with CITZMU.DAT. Evidently the old version got into the enterprise folder.

9/10/03		Modify Joystick to handle new button > 4 events for controlling speed sensitivity.

		Add MotLabels to Mot fields.

9/9/03		Some minor tweaking for Spectra intensity EDS code (Severin).
v. 6.15

9/2/03		Spectrometer joystick code working in Joywin (Lesher).

8/28/03		Additional changes to documentation (Fournelle).
	
		Fix problem with integrated intensity step sizes and same side off-peaks (Fournelle).
	
		Remove FormEDSDisplay from PFW (not used).
	
		Fix undervoltage problems (disable quant flag) in ZAFStd and ZAFSetZAF.
	
8/27/03		Fix beam de-normalization problem in ConvertCalculateAnalyticalSensitivity2 when using
		combined condition sample (Fournelle).
	
		Update splash screen.
	
8/17/03		Add code to acquire a live image from SIS image system. No provision for moving beam
		location. That will require a custom built SIS module based on "addaSpot" which uses
		the mouse to move the beam.
	
8/15/03		Major update to reference manual based on copious (and I do mean copious) notes provided
		by John Fournelle. Several days of work for me- probably more for him.

7/31/03		Fix problem with moving spectrometers in Joywin using joystick.	
	
		Double tolerance for large peak offset warning if over 30 angstrom crystal 2d (Fournelle).
	
		Modify same side off-peak warning to skip if not linear, exponential or polynomial.
	
		Fix bug in OptionsSave for disable quant flag and oxygen (Fournelle).
	
		Fix the Save standard setups code to deal with quick standards.
	
		Fix problem when loading wavescan data from PFW classic when number of spectrometers
		is different in config files.

7/24/03		Fix Bias Off button code in Joywin (Eckert).
	
		Note that "istp" (stopping power flag) was redefined in the Enterprise version and
		therefore uses the incorrect stopping power selection when loading data from a "classic"
		PFW run. Specifically the default for stopping power was Love-Scott in PFW and that value
		loads as Philibert-Tixier in the Enterprise version. Thanks Scotty. Not fixed.
	
		Fix disable quant problem in ZAFStd where index to disable quant flag was not 
		calculated properly.
	
7/14/03		Fix problem where sample setup could not be loaded from Elements/Cations button in
		Acquire!
	
		Rebuild help and distribution files.
	
7/7/03		Fix sum elapsed hours based on custom fields bug.

		Modify existing codes for Jeol column control in general, add error trapping and clean up.

		JEOL8600SIZE.DAT	(not used, instead use PD command)
		JEOL6400SIZE.DAT	(nA, OC, OF) to set beam size
		JEOL8600CURR.DAT	(nA, CL) to set beam current
		JEOL6400CURR.DAT	(nA, CC, CF) to set beam current
	
		Modify AM.BAS and AM2.BAS to use calibration files:

7/3/03		Add code for a 5th interfering element (Fournelle). Changes for database format including
v. 6.14		a change to the alpha factor .AFA ASCII file format.
	
		Modify Evaluate to use average of counts for maximum intensity standard for 1:1 line
		per suggestion by J. Fournelle (who else).
		
		Add code for sector digitizing random cluster coordinates. Only square boundaries supported
		at the current time. (Ryna)
		
6/26/03		Fix problem with oxygen analyzed and by stoichiometry. Allow disable quant option to bypass
		choices in Options and GetElmSetElm.
	
		Add double quotes to custom output file column headings (except #1). Re-format pdf manual.	
	
6/23/03		Improve consistency of maxcounts parameters regarding standard and unknowns and also peaking time
		for postscan option. Change range of postscan to 1/20 of pre-scan. Fix display graph size issue.
		
		Add "post-scan" option for running a wavescan AFTER peak center for confirmation (Fournelle). Code
		uses a wavescan range 1/5 the pre-scan size for the post-scan.
	
		Add JJD-2 output format for output of samples based on sample name.
	
		Add point number for Confirm position dialog when Confirm All Positions option is checked.
	
		Add parameter MaxUnknownCounts to [Counting] section of Probewin.ini.
	
6/18/03		Modify Digitize Cluster feature to allow user to view plot before saving to position database
v. 6.13		(this is in preparation for modifications for NIST regarding sector digitizing).
	
		Add forms and code for replicate acquisition of points (Ryna). Many small changes to existing
		automation and database code
	
		Modify counting time for off-peaks when on-peak counts exceeds maxcounts. Background counting time 
		will be calculated based on the ratio of the specified off-peak counting time to the specified 
		on-peak counting time and the actual elapsed on-peak counting time. (Ryna and Fournelle)
	
		Make module TypeDescription2 to load short sample description. (Fournelle)

6/08/03		Disable excel options in Acquisition Options dialog if Excel output is not open from Output menu.	
		
5/7/03		Fix FormSELECT to pop up to one side. Fix version number check in DataReplaceAddSample for
		spectra flags. 
	
		Change peakscan size parameters range to be between 20 and 10000.
	
		Modify DigitizeImageLoad to disable analog channel option if string is empty.

5/06/03		Add "il()" = 10 for quant disable in ZafSmp.
	
		Add option in Polygon grid digitize dialog to plot coordinates and boundary during
		the digitizing process. Good idea Ryna!
	
		Add option to FormPLOT to normalize Y data sets to 1.0. Normally only for wavescan 
		plots.
	
		Add option to FormGRAPH to remove On and Off peak markers from wavescan plots

5/05/03		Modify Update2.bas and ZafStd to handle undervoltage situations by setting disabled
v. 6.11		quant elements to "il()" equal to 10 (previously unused value).

4/30/03		Modify joystick buttons to use 4, 5 and 6 for speed sensitivity.	
	
		Fix multiple setup bug where setup numbers were getting corrupted (add delete previous setup
		numbers to PositionAddSample).
	
		Fix counter bug if starting gridMin after cancel in Stage.exe

3/16/03		Add call to SetupUpdateMDB in SetupLoadAssignedStandard in case it is called before SetupLoad.
	
		Modify EdaxEDSSpectraGetNetIntensities to check for zero elapsed time.

2/15/03		Modify RealtimeUpdateRemoteDisplay to exit if symbol is numerical.

2/4/03		Using new "off-line" version of pwedam32.dll, able to uncomment error traps for all edam
		functions.
	
		Add Student's T calculation to CalcZAF.

2/3/03		Remove Edax system files from distribution. 
	
		Add button Joywin to toggle detector biases.
	
		Modify Evaluate to handle duplicate elements (and disable quant elements).
	
		Modify TypeDetectionLimits to print "---" for disabled quant elements.
	
2/2/03		Modify AnalyzeComboneSamples to just print warning to log window (and skip) if duplicate 
		elements exist.	
	
		Modify CodeEDS to not reference FormANALYZE directly for CalcImage.
	
		EDS spectral data analysis working! See changes in AnalyzeSingle and SampleGetData.
	
		Add "beep" to RealTimeBacklashSpecStage at end of backlash routine.
	
1/27/03		Modify Faraday.frm to utilize CheckfaradayStateFlag to skip faraday insert or remove if performing
		faraday measurements in "cycle" mode. Requested by Jim Eckert. Could be implemented globally some
		day.
	
1/25/03		Add new routine UpdateEDSSpectraElements in UPDATE4.BAS to add EDS spectral elements and intensities
		to regular analysis arrays. Called by AnalyzeSingle (for unknown samples) and UpdateGetStandards (for
		standards) to try and make EDS analysis "transparent" to all normal analysis and display routines.
	
1/22/03		Modify EdaxEDSSpectraStart to clear memory before starting acquisition. Add debug statements
		to EdaxEDSSpectraGetNetIntensities to try and resolve "divide by zero" error. Update TESTEDAX2.ZIP
		(MAKEDAX.BAT).

1/13/03		Major changes to joystick code. Streamline JoyForm.bas, change event code, RealTime.bas code, etc.	

		Modify Joywin code to use button 4 to cycle through speed sensitivity settings.
		
12/21/02	Modify AMMoveMoter and AMSetVelocity to detect operating mode (position versus velocity) conflicts
		and print a warning only.

12/15/02	Worked on Edax spectra interface more. Almost ready except analysis modifications. See new button
		in calculation Options.
	
		Remove mcapi32.dll from setup info to prevent problem with older boards that cannot use v. 3.x of
		the driver (thanks Scotty).
	
12/11/02	Fix wavescan plot bugs where non-spectrometer channel is plotted on x-axis and also where both Ka
		and Kb lines for a single element are on the same spectrometer and crystal.

		Fix bug where kilovolt arrays were not updated when using Conditions button in Analyze! window.
	
		Fix error bar bug in ConvertSigmaIntensityKratio2 when only calculating intensity error bars (divide
		by zero errors).
	
12/08/02	Fix 1SIG bug in log window output (Analyze! window output was correct). Modify TypeCalculateOneSigma 
		code to correctly calculate average beam currents.

		Load FormDIGITIZE when FormAUTOMATE is loaded to prevent reloading of sample list after sample setups
		are assigned.

11/24/02	Modify Add To Setup button code to save all selected setups.

11/20/02	Fix bug in PositionOpenNewMDB for missing "Descriptions" field.
	
11/17/02	Found the problem. The Cl Ka edge in the Xedge.dat table was wrong- apparently a typo. Edited table 
		but left ZAFFlu code to fix problem for those who only update.
	
		PS. After checking numerous compositions, this bug only appears to affect high Cl concentrations.

11/14/02	Add code in ZAFFlu to skip fluorescence when emitting line and absorber line are the same Z. This
		bug has existed since the 16 bit Windows version and most likely even with the DOS version. The result
		appears to be that an element like Cl will report a spurious fluorescence resulting in a k-ratio that
		is larger than one in the almost pure element.
	
11/13/02	Modify AFACTOR.BAS to not load negative alpha values when using alpha factor calculations. Seems to
		be caused by k-ratios greater than 1.0 (e.g., 99% Cl and 1% Si). Problem with fluorescence 
		correction (ZAFFLU routine reports Cl Ka by Cl)?
	
11/6/02		Fix unknown count factor and maxcounts 	problem when standard is created and count times dialog
		is run. Changes to CurrentUpdateSample (delete lines).

		Add beam blank option for Grid Mineral form.
	
		Fix file open problem for gridmin output file.
	
11/2/02		Fix velocity problem with quickscan by changing AMMoveMotor to only set full velocity for
		stage motors.

10/24/02	Fix fixed spectrometer output bug in Plot!

10/23/02	Fix specified element output bug in Plot!	

		Add double click and move feature in Position grids.
	
		Modify Grid Mineral (Assisted Phase Mapping) code to offer both scan and grid modes. Note
		that the scan mode is statistically more rigorous and provides more information for
		subsequent data analysis.

10/17/02	Modify interference correction to not apply if interference counts are negative (J. Eckert).
	
		Skip "wrong axis type" errors.
	
		Add code to check for database table (FILE) in MISC4.BAS.

10/2/02		Fix RECALB.BAS bugs in .ELM file and Sample Setup issues in AcquireChangeElements.

		Fix plot problem in PlotGetSelectedData.
		
9/26/02		Add motor off command to prevent "runaway" problems with PCI controller when motor
		is moved next time (AMStopAllMotors).

		Fix problem with different elements in different samples in Plot output.
	
		Fix problem with Startwin and Calibrate peak with fixed specs.
	
		Add code to not call Get/SetMCOperatingMode if not using JoystickType=1 because
		older ISA boards do not support 3.2 driver that has these functions. This is for
		velocity mode motion for joystick.
	
		Allow wavescan samples to be used as sample setups.
	
9/22/02		Add z axis to joystick motion (for three axis joysticks).

9/12/02		Fix return to on-peaks problem where 1st element is acquire disabled.

9/08/02		Improve velocity mode switching and response.

		Modify Output to display sample parameters when list is double clicked.
	
8/23/02		Modify JoyWin to support joystick control in velocity mode. Many changes to AM.BAS, 
		DEMO.BAS, JOYFORM.BAS and JOYWIN.FRM.

8/20/02		Add extra error check in AMGetMotorStatus code.
	
		Add display of sample number and name to analysis status.
	
		Add display of average beam in Run | List Standard Counts (J. Fournelle).
	
		Fix problem of automation killed by Type Run Summary (J. Fournelle).
	
		Fix crystal flip busy inputs channel for PCI100 (D. Lesher)

8/14/02		Modify TypeInfo to print current faraday/absorbed number of beam averages (or count time).
	
		Fix AMInitINterface for opening serial port for different "types".

		Work on EDS some more.
	
		Fix output channel for faraday cup when using PCI-100 motor controller.
	
		Fix magnification control for 6400 and 8600 (change MAG to MG).
	
8/1/02		Add 8600 column control for HT, CL and PD. Note that use of CL may require 
		adjust of fine CL by user. Add Type = 2 for kilovolts, current and size.

7/23/02		Work on EDS read spectrum from file code. More changes to multiple peak calibration.	
	
		Modify ProbeWin GetSpec and AnalyzeCalculateWeight to handle duplicate specified element
		(already analyzed).

7/22/02		Modify WaveCalibrate in StartWin to not trigger x-ray check in ComboXray event.
	
		Work on EDS dialog.
	
		Modify GetTimSave to only update wave and unknown parameters if wavescan or unknown 
		respectively. Change Acquire Button positions and caption for Peaking.

7/20/02		Add check for beam size greater than X or Y standard increment.

7/11/02		Add polynomial position to element table.	
	
		Modify FormMODEL to allow user to pick sample to load background parameters from.
	
		Set Joystick "period" to 55 millisec to prevent problems with faster CPUs.

7/10/02		Add "setu wait" to SX50SetColumnCondition code.

7/7/02		Start EDS "Spectral" acquisition code. New fields.
v. 6.1
		Fix problem with Virtual Standard intensities in UpdateGetStandard.
	
		Add note to Analytical conditions that conditions should represent column condition 
		string.
	
7/5/02		Fix "window" parameter in Get PHA distribution. Move Peaking button to be next to
v. 6.08		"Calibrate Peak Positions" checkbox.
	
		Fix problem in PlotGetSelectedData for wavescan data when data is not a channel data
		type (caused by 5/26 modifications).
	
5/28/02		Modify enables in FormSETTIM to only allow updates to fields that are appropriate for
		the sample type.
	
5/27/02		Modify DataFileSetupCheck to indicate standard as not loaded if all lines in sample are
		deleted. This means that if you want to force a standard intensity to get loaded when
		loading a "File Setup" then just delete all occurrences of that standard in the current
		run.
	
		Fix Formula, Difference flags check assignments in GetElmCheckAssignments.
	
		Add global "force beam size" flag.	
	
		Modify Plot! lists to store "chan" in ItemData field to create a non-ambiguous index for
		cases where duplicate elements are present. Thanks to John Fournelle.
	
		Fix problem in ZAF calculations and ZAFStd (and output) where duplicate elements are used
		but with different x-ray lines and one is disabled.
	
		Fix problem with backward compatibility for ZAF/PAP corrections with PFW-32 in DataRun.
	
		Modify Custom Format Output #2 and #3 to print zero for off-peak count times if element 
		is MAN.
	
		Add detection limits and percent errors to plot window.

5/26/02		Fix some enable issues in Plot! window.	
	
		Modify PHA Distribution to not move on-peak if checkbox is checked.
	
		Modify GetElmSetElmMotorUpdate code to preserve spectrometer offsets even if user changes
		the spectrometer (if the crystal stays the same).
	
		Fix bug in AutomateImportPositions where overwriting existing standard positions and call
		to update beam center position fails because existing positions sample was deleted.
		
		Modify StartWin to add print button to FormDISPLAY and activate SDKPaint event so that
		+/- 3 SD lines are printed.
	
		Modify calculations options to save formula options even if not selected.
	
		Modify AcquireDoAutomateNext to skip stage move if previous position was exactly the same
		(this saves times when confirming stage positions for position samples with multiple setups
		assigned, e.g.. thin film analysis).
	
		Modify Update Deadtime constants (Analytical menu) to load default deadtimes from scalers.
	
5/19/02		Modify GetZAF form to offer electron fraction option for any backscatter loss correction
v. 6.07		that uses mass fractions for summation.
	
		Fix integrated intensity load in NewUpdateSample.
	
		Fix izaf defaults for old probe runs (force to default).
	
		Add Magnification parameter to AM Jeol column interface.
	
		Add space to printout in TypeNewCounts if not extended mode and more than 8 elements.	

5/11/02		Add sample description field to DIGITIZE and POSEDIT forms.	

		Add button in FormANALYZE to save all elements for assigned standards to the setup database.
	
		Fix path for X*2.DAT files in CalcZAF.
	
		Change MsgBoxTim icon to "info". Add "minimize" control to Position form.
	
		Fix ZAF program when std k-factor for standard is missing for interference correction
		when element in standard is at zero concentration (remove if zaf.Conc!(i%) statements).

5/7/02		Fix SavePHASetPHASaveElement so that detector parameters are properly saved.
		
		Fix problem with date/time stamp when sending data to Excel (change single precision to
		double precision variables). Thanks John F.
	
5/05/02		Add global correction variable so individual correction options do not have to be set
		by hand (izaf and zafstring variables).
	
5/02/02		Add PAP code for ZAF routines. In fact restructure entire ZAF routines by splitting
v. 6.05		into many separate modules and using a ZAF structure for passing variables. Also added
		the full set of correction options in JTA v. 3.04 CITZAF.
	
		Fix problem where start time was not being recorded to user database.
	
		Fix count time issue for changing between unknowns and wavescans.

4/25/02		Fix UserWin List and data control indexing problems.
	
		Add crystal type to wavescan display in Plot! window.
	
		Change "Analyzed and Specified" to "Acquired and Specified" in "Acquire! Elements/Cations".
	
		Change unknown count factors to single precision (also current and last factors).

4/24/02		Fix bug in Plot! if using averages only and first point is deleted.
	
		Modify Disable Quant option so that if a standard intensity is missing from the run the user 
		can disable the element and still perform analyses. Changes to Update.bas module.
	
		Add option for aggregate intensities in the Analysis Options dialog in order to sum 
		intensities for duplicate (trace) elements.
	
		Fix D I/O pin outs for AM interface. Modify AM.BAS to handle both PC100 and PCI100 boards.
	
		Add display of element, x-ray and crystal to wavescan form.

4/20/02		Add option to disable acquisition for selected elements for standard, wavescans and unknowns.
v. 6.04	
		Add error logging whenever the IOMsgBox code is called. Output appended to PROBEWIN.ERR.
	
		Add some code to sx100 interface.
	
		Add check for ColumnConditionPresent to Jeol and Cameca interfaces (and also check for
		ColumnConditionType = 1 for jeol interface).
	
		Add output of x-ray transmission distance to Model X-ray range output.

4/18/02		Fix default crystal load for new standards.
	
		Start adding PAP correction- some changes to ZAFBSC routine.
	
4/16/02		Fix PositionAddSample error if no samples in position database. Fix problem if user cancels
		during JH format output.
	
		Add SX50 Post and Pre string editing in Conditions dialogs.
	
		Add code in PlotDoGraph to set wavescan limits to include off-peak positions if outside
		wavescan limits.

3/30/02		Improve wavescan time calculation in FormGETTIM
	
		Add code to record stop time to user database when filament standby is called. Then record start
		time again when user clicks ok.
	
		Massive changes to ZAF routines (rewrite code to use user defined type for ZAF variables and
		split code into separate modules. Add indexes to add PAP correction.

3/23/02		Slight changes to spectrometer motion and acquisition time display in GETTIM form.

		Add cool new feature that accurately calculates count and motion time for each spectrometer
		in Count Times dialog.
	
		Add kev, x-ray and density output to log window in CalcZAF for x-ray range calculations
	
		Add check for too many samples in position database (listbox limit).
	
3/17/02		Move some variables from analysis and sample types to Init code for dynamic allocation
		to improve free memory.
	
		Fix Excel "close" code. Modify Excel label output code.
	
		Add option for NIST to choose either export of wt% or raw k-ratios to Excel.
	
		Modify code to support duplicate elements in Probewin. The only restriction now is that
		each element must be a different x-ray, spectrometer and/or crystal. (NIST option)
	
		Add disables to SETELM form to turn off controls that are not saved in that version of
		the data file.

3/16/02		Add feature to send data to Excel if Automatic analysis and excel sheet is open.
v. 6.02	
		Fix ZAFZed routine to calculate atomic number correction even if concentration is zero.
	
3/13/02		Remove line: If Conc!(ip%) = 0# Then GoTo 8500 from ZAFStd routine. It was preventing the
		proper loading of the std K-factor for interference calculations! Small effect on interference
		correction when large matrix correction between unknown and interference standard.

		Change "Atomic Weight Percent" to "Atomic Percent" in SampleLoadGrid.
	
		Fix problem with fixed spectrometers when using multiple peak calibrations.
	
		Increase arrays (and forms) to handle 40 elements.
	
		Modify multiple peak calibration to handle beta lines.
	
3/12/02		Fix multiple peak calibration for configurations with fixed spectrometers.
	
		Add option to apply integrated intensity variable steps to wavescans.

3/9/02		Fix minor output problem in DebugMode in routine UpdateGetStandards.
	
		Add code to set x-ray number to 1,2 or 3 for multiple peak calibration file number after
		call to IPOS4 in several places.
	
		Disable Output button during Strata format calculation. Add Move On-peak automatically
		for PHA distribution.
	
		Add new output options for Strata output. Add comment to nominal beam question.
	
		Fix problem where CITZMU.DAT is not written to the application folder.
	
02/19/02	Create new utility to search for specific samples based on element, x-ray, spectrometer,
		standard number or sample name string.
	
		Write small app. "UpdateSetup.exe to update setup files to install Probe for Windows
		"Enterprise Edition" for different folder: "Program Files\Probe for Windows-E". Runs
		from MAKZIP.BAT.
	
		Make Range and Detection limit dialogs in CalcZAF modeless.
	
		Add interpolated intensity output to Model dialog. Fix polynomial marker size.
	
		Add button to Analyze window to add sample setups directly.
	
		Modify Stratagem output to disable Close button until calculations are finished.
	
		Modify one sigma calculation to use deadtime denormalized counts and calculate for off-peak
		intensities also. Add calculate sigma ratio and print out ("SIGR:").
	
		Modify MAN and calibration curve to use new function for average relative percent deviation
		calculations.
	
		Add print out of volatile element percent fit deviation.
	
02/16/02	Add disable element for quantification option in Elements/cation dialog. Sets counts to
		zero before ZAF iteration.
	
		Add electron and x-ray range modeling in CALCZAF.

02/14/02	Modify code to use 100 element x-ray line and MAC tables. Convert or rebuild old tables.

		Add electron and x-ray range modeling in CALCZAF.


02/10/02	Split source code. Create for Windows Enterprise Edition.
v. 6.00
		Add global deadtime update dialog.
